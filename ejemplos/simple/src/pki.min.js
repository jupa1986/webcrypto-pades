require=function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e}()({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _GeneralName=require("./GeneralName.js");var _GeneralName2=_interopRequireDefault(_GeneralName);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AccessDescription=function(){function AccessDescription(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,AccessDescription);this.accessMethod=(0,_pvutils.getParametersValue)(parameters,"accessMethod",AccessDescription.defaultValues("accessMethod"));this.accessLocation=(0,_pvutils.getParametersValue)(parameters,"accessLocation",AccessDescription.defaultValues("accessLocation"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(AccessDescription,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,AccessDescription.schema({names:{accessMethod:"accessMethod",accessLocation:{names:{blockName:"accessLocation"}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for AccessDescription");this.accessMethod=asn1.result.accessMethod.valueBlock.toString();this.accessLocation=new _GeneralName2.default({schema:asn1.result.accessLocation})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.ObjectIdentifier({value:this.accessMethod}),this.accessLocation.toSchema()]})}},{key:"toJSON",value:function toJSON(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"accessMethod":return"";case"accessLocation":return new _GeneralName2.default;default:throw new Error("Invalid member name for AccessDescription class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.accessMethod||""}),_GeneralName2.default.schema(names.accessLocation||{})]})}}]);return AccessDescription}();exports.default=AccessDescription},{"./GeneralName.js":37,asn1js:"asn1js",pvutils:"pvutils"}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Accuracy=function(){function Accuracy(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Accuracy);if("seconds"in parameters)this.seconds=(0,_pvutils.getParametersValue)(parameters,"seconds",Accuracy.defaultValues("seconds"));if("millis"in parameters)this.millis=(0,_pvutils.getParametersValue)(parameters,"millis",Accuracy.defaultValues("millis"));if("micros"in parameters)this.micros=(0,_pvutils.getParametersValue)(parameters,"micros",Accuracy.defaultValues("micros"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(Accuracy,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,Accuracy.schema({names:{seconds:"seconds",millis:"millis",micros:"micros"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for tsp.Accuracy");if("seconds"in asn1.result)this.seconds=asn1.result.seconds.valueBlock.valueDec;if("millis"in asn1.result){var intMillis=new asn1js.Integer({valueHex:asn1.result.millis.valueBlock.valueHex});this.millis=intMillis.valueBlock.valueDec}if("micros"in asn1.result){var intMicros=new asn1js.Integer({valueHex:asn1.result.micros.valueBlock.valueHex});this.micros=intMicros.valueBlock.valueDec}}},{key:"toSchema",value:function toSchema(){var outputArray=[];if("seconds"in this)outputArray.push(new asn1js.Integer({value:this.seconds}));if("millis"in this){var intMillis=new asn1js.Integer({value:this.millis});outputArray.push(new asn1js.Primitive({idBlock:{tagClass:3,tagNumber:0},valueHex:intMillis.valueBlock.valueHex}))}if("micros"in this){var intMicros=new asn1js.Integer({value:this.micros});outputArray.push(new asn1js.Primitive({idBlock:{tagClass:3,tagNumber:1},valueHex:intMicros.valueBlock.valueHex}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={};if("seconds"in this)_object.seconds=this.seconds;if("millis"in this)_object.millis=this.millis;if("micros"in this)_object.micros=this.micros;return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"seconds":case"millis":case"micros":return 0;default:throw new Error("Invalid member name for Accuracy class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"seconds":case"millis":case"micros":return memberValue===Accuracy.defaultValues(memberName);default:throw new Error("Invalid member name for Accuracy class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",optional:true,value:[new asn1js.Integer({optional:true,name:names.seconds||""}),new asn1js.Primitive({name:names.millis||"",optional:true,idBlock:{tagClass:3,tagNumber:0}}),new asn1js.Primitive({name:names.micros||"",optional:true,idBlock:{tagClass:3,tagNumber:1}})]})}}]);return Accuracy}();exports.default=Accuracy},{asn1js:"asn1js",pvutils:"pvutils"}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AlgorithmIdentifier=function(){function AlgorithmIdentifier(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,AlgorithmIdentifier);this.algorithmId=(0,_pvutils.getParametersValue)(parameters,"algorithmId",AlgorithmIdentifier.defaultValues("algorithmId"));if("algorithmParams"in parameters)this.algorithmParams=(0,_pvutils.getParametersValue)(parameters,"algorithmParams",AlgorithmIdentifier.defaultValues("algorithmParams"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(AlgorithmIdentifier,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,AlgorithmIdentifier.schema({names:{algorithmIdentifier:"algorithm",algorithmParams:"params"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for AlgorithmIdentifier");this.algorithmId=asn1.result.algorithm.valueBlock.toString();if("params"in asn1.result)this.algorithmParams=asn1.result.params}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(new asn1js.ObjectIdentifier({value:this.algorithmId}));if("algorithmParams"in this&&this.algorithmParams instanceof asn1js.Any===false)outputArray.push(this.algorithmParams);return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={algorithmId:this.algorithmId};if("algorithmParams"in this&&this.algorithmParams instanceof asn1js.Any===false)object.algorithmParams=this.algorithmParams.toJSON();return object}},{key:"isEqual",value:function isEqual(algorithmIdentifier){if(algorithmIdentifier instanceof AlgorithmIdentifier===false)return false;if(this.algorithmId!==algorithmIdentifier.algorithmId)return false;if("algorithmParams"in this){if("algorithmParams"in algorithmIdentifier)return JSON.stringify(this.algorithmParams)===JSON.stringify(algorithmIdentifier.algorithmParams);return false}if("algorithmParams"in algorithmIdentifier)return false;return true}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"algorithmId":return"";case"algorithmParams":return new asn1js.Any;default:throw new Error("Invalid member name for AlgorithmIdentifier class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"algorithmId":return memberValue==="";case"algorithmParams":return memberValue instanceof asn1js.Any;default:throw new Error("Invalid member name for AlgorithmIdentifier class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",optional:names.optional||false,value:[new asn1js.ObjectIdentifier({name:names.algorithmIdentifier||""}),new asn1js.Any({name:names.algorithmParams||"",optional:true})]})}}]);return AlgorithmIdentifier}();exports.default=AlgorithmIdentifier},{asn1js:"asn1js",pvutils:"pvutils"}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _GeneralName=require("./GeneralName.js");var _GeneralName2=_interopRequireDefault(_GeneralName);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AltName=function(){function AltName(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,AltName);this.altNames=(0,_pvutils.getParametersValue)(parameters,"altNames",AltName.defaultValues("altNames"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(AltName,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,AltName.schema({names:{altNames:"altNames"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for AltName");if("altNames"in asn1.result)this.altNames=Array.from(asn1.result.altNames,function(element){return new _GeneralName2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:Array.from(this.altNames,function(element){return element.toSchema()})})}},{key:"toJSON",value:function toJSON(){return{altNames:Array.from(this.altNames,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"altNames":return[];default:throw new Error("Invalid member name for AltName class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Repeated({name:names.altNames||"",value:_GeneralName2.default.schema()})]})}}]);return AltName}();exports.default=AltName},{"./GeneralName.js":37,asn1js:"asn1js",pvutils:"pvutils"}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Attribute=function(){function Attribute(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Attribute);this.type=(0,_pvutils.getParametersValue)(parameters,"type",Attribute.defaultValues("type"));this.values=(0,_pvutils.getParametersValue)(parameters,"values",Attribute.defaultValues("values"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(Attribute,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,Attribute.schema({names:{type:"type",values:"values"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for ATTRIBUTE");this.type=asn1.result.type.valueBlock.toString();this.values=asn1.result.values}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.ObjectIdentifier({value:this.type}),new asn1js.Set({value:this.values})]})}},{key:"toJSON",value:function toJSON(){return{type:this.type,values:Array.from(this.values,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"type":return"";case"values":return[];default:throw new Error("Invalid member name for Attribute class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"type":return memberValue==="";case"values":return memberValue.length===0;default:throw new Error("Invalid member name for Attribute class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.type||""}),new asn1js.Set({name:names.setName||"",value:[new asn1js.Repeated({name:names.values||"",value:new asn1js.Any})]})]})}}]);return Attribute}();exports.default=Attribute},{asn1js:"asn1js",pvutils:"pvutils"}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AttributeCertificateInfoV1=exports.IssuerSerial=exports.AttCertValidityPeriod=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _GeneralNames=require("./GeneralNames.js");var _GeneralNames2=_interopRequireDefault(_GeneralNames);var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _Attribute=require("./Attribute.js");var _Attribute2=_interopRequireDefault(_Attribute);var _Extensions=require("./Extensions.js");var _Extensions2=_interopRequireDefault(_Extensions);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AttCertValidityPeriod=exports.AttCertValidityPeriod=function(){function AttCertValidityPeriod(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,AttCertValidityPeriod);this.notBeforeTime=(0,_pvutils.getParametersValue)(parameters,"notBeforeTime",AttCertValidityPeriod.defaultValues("notBeforeTime"));this.notAfterTime=(0,_pvutils.getParametersValue)(parameters,"notAfterTime",AttCertValidityPeriod.defaultValues("notAfterTime"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(AttCertValidityPeriod,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,AttCertValidityPeriod.schema({names:{notBeforeTime:"notBeforeTime",notAfterTime:"notAfterTime"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for AttCertValidityPeriod");this.notBeforeTime=asn1.result.notBeforeTime.toDate();this.notAfterTime=asn1.result.notAfterTime.toDate()}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.GeneralizedTime({valueDate:this.notBeforeTime}),new asn1js.GeneralizedTime({valueDate:this.notAfterTime})]})}},{key:"toJSON",value:function toJSON(){return{notBeforeTime:this.notBeforeTime,notAfterTime:this.notAfterTime}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"notBeforeTime":case"notAfterTime":return new Date(0,0,0);default:throw new Error("Invalid member name for AttCertValidityPeriod class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.GeneralizedTime({name:names.notBeforeTime||""}),new asn1js.GeneralizedTime({name:names.notAfterTime||""})]})}}]);return AttCertValidityPeriod}();var IssuerSerial=exports.IssuerSerial=function(){function IssuerSerial(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,IssuerSerial);this.issuer=(0,_pvutils.getParametersValue)(parameters,"issuer",IssuerSerial.defaultValues("issuer"));this.serialNumber=(0,_pvutils.getParametersValue)(parameters,"serialNumber",IssuerSerial.defaultValues("serialNumber"));if("issuerUID"in parameters)this.issuerUID=(0,_pvutils.getParametersValue)(parameters,"issuerUID",IssuerSerial.defaultValues("issuerUID"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(IssuerSerial,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,IssuerSerial.schema({names:{issuer:{names:{blockName:"issuer"}},serialNumber:"serialNumber",issuerUID:"issuerUID"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for IssuerSerial");this.issuer=new _GeneralNames2.default({schema:asn1.result.issuer});this.serialNumber=asn1.result.serialNumber;if("issuerUID"in asn1.result)this.issuerUID=asn1.result.issuerUID}},{key:"toSchema",value:function toSchema(){var result=new asn1js.Sequence({value:[this.issuer.toSchema(),this.serialNumber]});if("issuerUID"in this)result.valueBlock.value.push(this.issuerUID);return result}},{key:"toJSON",value:function toJSON(){var result={issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()};if("issuerUID"in this)result.issuerUID=this.issuerUID.toJSON();return result}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"issuer":return new _GeneralNames2.default;case"serialNumber":return new asn1js.Integer;case"issuerUID":return new asn1js.BitString;default:throw new Error("Invalid member name for IssuerSerial class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_GeneralNames2.default.schema(names.issuer||{}),new asn1js.Integer({name:names.serialNumber||""}),new asn1js.BitString({optional:true,name:names.issuerUID||""})]})}}]);return IssuerSerial}();var AttributeCertificateInfoV1=exports.AttributeCertificateInfoV1=function(){function AttributeCertificateInfoV1(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,AttributeCertificateInfoV1);this.version=(0,_pvutils.getParametersValue)(parameters,"version",AttributeCertificateInfoV1.defaultValues("version"));if("baseCertificateID"in parameters)this.baseCertificateID=(0,_pvutils.getParametersValue)(parameters,"baseCertificateID",AttributeCertificateInfoV1.defaultValues("baseCertificateID"));if("subjectName"in parameters)this.subjectName=(0,_pvutils.getParametersValue)(parameters,"subjectName",AttributeCertificateInfoV1.defaultValues("subjectName"));this.issuer=(0,_pvutils.getParametersValue)(parameters,"issuer",AttributeCertificateInfoV1.defaultValues("issuer"));this.signature=(0,_pvutils.getParametersValue)(parameters,"signature",AttributeCertificateInfoV1.defaultValues("signature"));this.serialNumber=(0,_pvutils.getParametersValue)(parameters,"serialNumber",AttributeCertificateInfoV1.defaultValues("serialNumber"));this.attrCertValidityPeriod=(0,_pvutils.getParametersValue)(parameters,"attrCertValidityPeriod",AttributeCertificateInfoV1.defaultValues("attrCertValidityPeriod"));this.attributes=(0,_pvutils.getParametersValue)(parameters,"attributes",AttributeCertificateInfoV1.defaultValues("attributes"));if("issuerUniqueID"in parameters)this.issuerUniqueID=(0,_pvutils.getParametersValue)(parameters,"issuerUniqueID",AttributeCertificateInfoV1.defaultValues("issuerUniqueID"));if("extensions"in parameters)this.extensions=(0,_pvutils.getParametersValue)(parameters,"extensions",AttributeCertificateInfoV1.defaultValues("extensions"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(AttributeCertificateInfoV1,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,AttributeCertificateInfoV1.schema({names:{version:"version",baseCertificateID:"baseCertificateID",subjectName:"subjectName",issuer:"issuer",signature:{names:{blockName:"signature"}},serialNumber:"serialNumber",attrCertValidityPeriod:{names:{blockName:"attrCertValidityPeriod"}},attributes:"attributes",issuerUniqueID:"issuerUniqueID",extensions:{names:{blockName:"extensions"}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for AttributeCertificateInfoV1");this.version=asn1.result.version.valueBlock.valueDec;if("baseCertificateID"in asn1.result){asn1.result.baseCertificateID.idBlock.tagClass=1;asn1.result.baseCertificateID.idBlock.tagNumber=16;this.baseCertificateID=new IssuerSerial({schema:asn1.result.baseCertificateID})}if("subjectName"in asn1.result){asn1.result.subjectName.idBlock.tagClass=1;asn1.result.subjectName.idBlock.tagNumber=16;this.subjectName=new _GeneralNames2.default({schema:asn1.result.subjectName})}this.issuer=asn1.result.issuer;this.signature=new _AlgorithmIdentifier2.default({schema:asn1.result.signature});this.serialNumber=asn1.result.serialNumber;this.attrCertValidityPeriod=new AttCertValidityPeriod({schema:asn1.result.attrCertValidityPeriod});this.attributes=Array.from(asn1.result.attributes.valueBlock.value,function(element){return new _Attribute2.default({schema:element})});if("issuerUniqueID"in asn1.result)this.issuerUniqueID=asn1.result.issuerUniqueID;if("extensions"in asn1.result)this.extensions=new _Extensions2.default({schema:asn1.result.extensions})}},{key:"toSchema",value:function toSchema(){var result=new asn1js.Sequence({value:[new asn1js.Integer({value:this.version})]});if("baseCertificateID"in this){result.valueBlock.value.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value}))}if("subjectName"in this){result.valueBlock.value.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:this.subjectName.toSchema().valueBlock.value}))}result.valueBlock.value.push(this.issuer.toSchema());result.valueBlock.value.push(this.signature.toSchema());result.valueBlock.value.push(this.serialNumber);result.valueBlock.value.push(this.attrCertValidityPeriod.toSchema());result.valueBlock.value.push(new asn1js.Sequence({value:Array.from(this.attributes,function(element){return element.toSchema()})}));if("issuerUniqueID"in this)result.valueBlock.value.push(this.issuerUniqueID);if("extensions"in this)result.valueBlock.value.push(this.extensions.toSchema());return result}},{key:"toJSON",value:function toJSON(){var result={version:this.version};if("baseCertificateID"in this)result.baseCertificateID=this.baseCertificateID.toJSON();if("subjectName"in this)result.subjectName=this.subjectName.toJSON();result.issuer=this.issuer.toJSON();result.signature=this.signature.toJSON();result.serialNumber=this.serialNumber.toJSON();result.attrCertValidityPeriod=this.attrCertValidityPeriod.toJSON();result.attributes=Array.from(this.attributes,function(element){return element.toJSON()});if("issuerUniqueID"in this)result.issuerUniqueID=this.issuerUniqueID.toJSON();if("extensions"in this)result.extensions=this.extensions.toJSON();return result}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 0;case"baseCertificateID":return new IssuerSerial;case"subjectName":return new _GeneralNames2.default;case"issuer":return{};case"signature":return new _AlgorithmIdentifier2.default;case"serialNumber":return new asn1js.Integer;case"attrCertValidityPeriod":return new AttCertValidityPeriod;case"attributes":return[];case"issuerUniqueID":return new asn1js.BitString;case"extensions":return new _Extensions2.default;default:throw new Error("Invalid member name for AttributeCertificateInfoV1 class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.version||""}),new asn1js.Choice({value:[new asn1js.Constructed({name:names.baseCertificateID||"",idBlock:{tagClass:3,tagNumber:0},value:IssuerSerial.schema().valueBlock.value}),new asn1js.Constructed({name:names.subjectName||"",idBlock:{tagClass:3,tagNumber:1},value:_GeneralNames2.default.schema().valueBlock.value})]}),_GeneralNames2.default.schema({names:{blockName:names.issuer||""}}),_AlgorithmIdentifier2.default.schema(names.signature||{}),new asn1js.Integer({name:names.serialNumber||""}),AttCertValidityPeriod.schema(names.attrCertValidityPeriod||{}),new asn1js.Sequence({name:names.attributes||"",value:[new asn1js.Repeated({value:_Attribute2.default.schema()})]}),new asn1js.BitString({optional:true,name:names.issuerUniqueID||""}),_Extensions2.default.schema(names.extensions||{},true)]})}}]);return AttributeCertificateInfoV1}();var AttributeCertificateV1=function(){function AttributeCertificateV1(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,AttributeCertificateV1);this.acinfo=(0,_pvutils.getParametersValue)(parameters,"acinfo",AttributeCertificateV1.defaultValues("acinfo"));this.signatureAlgorithm=(0,_pvutils.getParametersValue)(parameters,"signatureAlgorithm",AttributeCertificateV1.defaultValues("signatureAlgorithm"));this.signatureValue=(0,_pvutils.getParametersValue)(parameters,"signatureValue",AttributeCertificateV1.defaultValues("signatureValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(AttributeCertificateV1,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,AttributeCertificateV1.schema({names:{acinfo:{names:{blockName:"acinfo"}},signatureAlgorithm:{names:{blockName:"signatureAlgorithm"}},signatureValue:"signatureValue"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for AttributeCertificateV1");this.acinfo=new AttributeCertificateInfoV1({schema:asn1.result.acinfo});this.signatureAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.signatureAlgorithm});this.signatureValue=asn1.result.signatureValue}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}},{key:"toJSON",value:function toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"acinfo":return new AttributeCertificateInfoV1;case"signatureAlgorithm":return new _AlgorithmIdentifier2.default;case"signatureValue":return new asn1js.BitString;default:throw new Error("Invalid member name for AttributeCertificateV1 class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[AttributeCertificateInfoV1.schema(names.acinfo||{}),_AlgorithmIdentifier2.default.schema(names.signatureAlgorithm||{}),new asn1js.BitString({name:names.signatureValue||""})]})}}]);return AttributeCertificateV1}();exports.default=AttributeCertificateV1},{"./AlgorithmIdentifier.js":3,"./Attribute.js":5,"./Extensions.js":36,"./GeneralNames.js":38,asn1js:"asn1js",pvutils:"pvutils"}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AttributeCertificateInfoV2=exports.Holder=exports.V2Form=exports.ObjectDigestInfo=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _GeneralNames=require("./GeneralNames.js");var _GeneralNames2=_interopRequireDefault(_GeneralNames);var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _Attribute=require("./Attribute.js");var _Attribute2=_interopRequireDefault(_Attribute);var _Extensions=require("./Extensions.js");var _Extensions2=_interopRequireDefault(_Extensions);var _AttributeCertificateV=require("./AttributeCertificateV1.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ObjectDigestInfo=exports.ObjectDigestInfo=function(){function ObjectDigestInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,ObjectDigestInfo);this.digestedObjectType=(0,_pvutils.getParametersValue)(parameters,"digestedObjectType",ObjectDigestInfo.defaultValues("digestedObjectType"));if("otherObjectTypeID"in parameters)this.otherObjectTypeID=(0,_pvutils.getParametersValue)(parameters,"otherObjectTypeID",ObjectDigestInfo.defaultValues("otherObjectTypeID"));this.digestAlgorithm=(0,_pvutils.getParametersValue)(parameters,"digestAlgorithm",ObjectDigestInfo.defaultValues("digestAlgorithm"));this.objectDigest=(0,_pvutils.getParametersValue)(parameters,"objectDigest",ObjectDigestInfo.defaultValues("objectDigest"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(ObjectDigestInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,ObjectDigestInfo.schema({names:{digestedObjectType:"digestedObjectType",otherObjectTypeID:"otherObjectTypeID",digestAlgorithm:{names:{blockName:"digestAlgorithm"}},objectDigest:"objectDigest"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for ObjectDigestInfo");this.digestedObjectType=asn1.result.digestedObjectType;if("otherObjectTypeID"in asn1.result)this.otherObjectTypeID=asn1.result.otherObjectTypeID;this.digestAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.digestAlgorithm});this.objectDigest=asn1.result.objectDigest}},{key:"toSchema",value:function toSchema(){var result=new asn1js.Sequence({value:[this.digestedObjectType]});if("otherObjectTypeID"in this)result.value.push(this.otherObjectTypeID);result.value.push(this.digestAlgorithm.toSchema());result.value.push(this.objectDigest);return result}},{key:"toJSON",value:function toJSON(){var result={digestedObjectType:this.digestedObjectType.toJSON()};if("otherObjectTypeID"in this)result.otherObjectTypeID=this.otherObjectTypeID.toJSON();result.digestAlgorithm=this.digestAlgorithm.toJSON();result.objectDigest=this.objectDigest.toJSON();return result}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"digestedObjectType":return new asn1js.Enumerated;case"otherObjectTypeID":return new asn1js.ObjectIdentifier;case"digestAlgorithm":return new _AlgorithmIdentifier2.default;case"objectDigest":return new asn1js.BitString;default:throw new Error("Invalid member name for ObjectDigestInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Enumerated({name:names.digestedObjectType||""}),new asn1js.ObjectIdentifier({optional:true,name:names.otherObjectTypeID||""}),_AlgorithmIdentifier2.default.schema(names.digestAlgorithm||{}),new asn1js.BitString({name:names.objectDigest||""})]})}}]);return ObjectDigestInfo}();var V2Form=exports.V2Form=function(){function V2Form(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,V2Form);if("issuerName"in parameters)this.issuerName=(0,_pvutils.getParametersValue)(parameters,"issuerName",V2Form.defaultValues("issuerName"));if("baseCertificateID"in parameters)this.baseCertificateID=(0,_pvutils.getParametersValue)(parameters,"baseCertificateID",V2Form.defaultValues("baseCertificateID"));if("objectDigestInfo"in parameters)this.objectDigestInfo=(0,_pvutils.getParametersValue)(parameters,"objectDigestInfo",V2Form.defaultValues("objectDigestInfo"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(V2Form,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,V2Form.schema({names:{issuerName:"issuerName",baseCertificateID:"baseCertificateID",objectDigestInfo:"objectDigestInfo"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for V2Form");if("issuerName"in asn1.result)this.issuerName=new _GeneralNames2.default({schema:asn1.result.issuerName});if("baseCertificateID"in asn1.result){asn1.result.baseCertificateID.idBlock.tagClass=1;asn1.result.baseCertificateID.idBlock.tagNumber=16;this.baseCertificateID=new _AttributeCertificateV.IssuerSerial({schema:asn1.result.baseCertificateID})}if("objectDigestInfo"in asn1.result){asn1.result.objectDigestInfo.idBlock.tagClass=1;asn1.result.objectDigestInfo.idBlock.tagNumber=16;this.objectDigestInfo=new ObjectDigestInfo({schema:asn1.result.objectDigestInfo})}}},{key:"toSchema",value:function toSchema(){var result=new asn1js.Sequence;if("issuerName"in this)result.valueBlock.value.push(this.issuerName.toSchema());if("baseCertificateID"in this){result.valueBlock.value.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value}))}if("objectDigestInfo"in this){result.valueBlock.value.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:this.objectDigestInfo.toSchema().valueBlock.value}))}return result}},{key:"toJSON",value:function toJSON(){var result={};if("issuerName"in this)result.issuerName=this.issuerName.toJSON();if("baseCertificateID"in this)result.baseCertificateID=this.baseCertificateID.toJSON();if("objectDigestInfo"in this)result.objectDigestInfo=this.objectDigestInfo.toJSON();return result}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"issuerName":return new _GeneralNames2.default;case"baseCertificateID":return new _AttributeCertificateV.IssuerSerial;case"objectDigestInfo":return new ObjectDigestInfo;default:throw new Error("Invalid member name for V2Form class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_GeneralNames2.default.schema({names:{blockName:names.issuerName}},true),new asn1js.Constructed({optional:true,name:names.baseCertificateID||"",idBlock:{tagClass:3,tagNumber:0},value:_AttributeCertificateV.IssuerSerial.schema().valueBlock.value}),new asn1js.Constructed({optional:true,name:names.objectDigestInfo||"",idBlock:{tagClass:3,tagNumber:1},value:ObjectDigestInfo.schema().valueBlock.value})]})}}]);return V2Form}();var Holder=exports.Holder=function(){function Holder(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Holder);if("baseCertificateID"in parameters)this.baseCertificateID=(0,_pvutils.getParametersValue)(parameters,"baseCertificateID",Holder.defaultValues("baseCertificateID"));if("entityName"in parameters)this.entityName=(0,_pvutils.getParametersValue)(parameters,"entityName",Holder.defaultValues("entityName"));if("objectDigestInfo"in parameters)this.objectDigestInfo=(0,_pvutils.getParametersValue)(parameters,"objectDigestInfo",Holder.defaultValues("objectDigestInfo"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(Holder,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,Holder.schema({names:{baseCertificateID:"baseCertificateID",entityName:"entityName",objectDigestInfo:"objectDigestInfo"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for Holder");if("baseCertificateID"in asn1.result){asn1.result.baseCertificateID.idBlock.tagClass=1;asn1.result.baseCertificateID.idBlock.tagNumber=16;this.baseCertificateID=new _AttributeCertificateV.IssuerSerial({schema:asn1.result.baseCertificateID})}if("entityName"in asn1.result){asn1.result.entityName.idBlock.tagClass=1;asn1.result.entityName.idBlock.tagNumber=16;this.entityName=new _GeneralNames2.default({schema:asn1.result.entityName})}if("objectDigestInfo"in asn1.result){asn1.result.objectDigestInfo.idBlock.tagClass=1;asn1.result.objectDigestInfo.idBlock.tagNumber=16;this.objectDigestInfo=new ObjectDigestInfo({schema:asn1.result.objectDigestInfo})}}},{key:"toSchema",value:function toSchema(){var result=new asn1js.Sequence;if("baseCertificateID"in this){result.valueBlock.value.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value}))}if("entityName"in this){result.valueBlock.value.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:this.entityName.toSchema().valueBlock.value}))}if("objectDigestInfo"in this){result.valueBlock.value.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:2},value:this.objectDigestInfo.toSchema().valueBlock.value}))}return result}},{key:"toJSON",value:function toJSON(){var result={};if("baseCertificateID"in this)result.baseCertificateID=this.baseCertificateID.toJSON();if("entityName"in this)result.entityName=this.entityName.toJSON();if("objectDigestInfo"in this)result.objectDigestInfo=this.objectDigestInfo.toJSON();return result}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"baseCertificateID":return new _AttributeCertificateV.IssuerSerial;case"entityName":return new _GeneralNames2.default;case"objectDigestInfo":return new ObjectDigestInfo;default:throw new Error("Invalid member name for Holder class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Constructed({optional:true,name:names.baseCertificateID||"",idBlock:{tagClass:3,tagNumber:0},value:_AttributeCertificateV.IssuerSerial.schema().valueBlock.value}),new asn1js.Constructed({optional:true,name:names.entityName||"",idBlock:{tagClass:3,tagNumber:1},value:_GeneralNames2.default.schema().valueBlock.value}),new asn1js.Constructed({optional:true,name:names.objectDigestInfo||"",idBlock:{tagClass:3,tagNumber:2},value:ObjectDigestInfo.schema().valueBlock.value})]})}}]);return Holder}();var AttributeCertificateInfoV2=exports.AttributeCertificateInfoV2=function(){function AttributeCertificateInfoV2(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,AttributeCertificateInfoV2);this.version=(0,_pvutils.getParametersValue)(parameters,"version",AttributeCertificateInfoV2.defaultValues("version"));this.holder=(0,_pvutils.getParametersValue)(parameters,"holder",AttributeCertificateInfoV2.defaultValues("holder"));this.issuer=(0,_pvutils.getParametersValue)(parameters,"issuer",AttributeCertificateInfoV2.defaultValues("issuer"));this.signature=(0,_pvutils.getParametersValue)(parameters,"signature",AttributeCertificateInfoV2.defaultValues("signature"));this.serialNumber=(0,_pvutils.getParametersValue)(parameters,"serialNumber",AttributeCertificateInfoV2.defaultValues("serialNumber"));this.attrCertValidityPeriod=(0,_pvutils.getParametersValue)(parameters,"attrCertValidityPeriod",AttributeCertificateInfoV2.defaultValues("attrCertValidityPeriod"));this.attributes=(0,_pvutils.getParametersValue)(parameters,"attributes",AttributeCertificateInfoV2.defaultValues("attributes"));if("issuerUniqueID"in parameters)this.issuerUniqueID=(0,_pvutils.getParametersValue)(parameters,"issuerUniqueID",AttributeCertificateInfoV2.defaultValues("issuerUniqueID"));if("extensions"in parameters)this.extensions=(0,_pvutils.getParametersValue)(parameters,"extensions",AttributeCertificateInfoV2.defaultValues("extensions"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(AttributeCertificateInfoV2,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,AttributeCertificateInfoV2.schema({names:{version:"version",holder:{names:{blockName:"holder"}},issuer:"issuer",signature:{names:{blockName:"signature"}},serialNumber:"serialNumber",attrCertValidityPeriod:{names:{blockName:"attrCertValidityPeriod"}},attributes:"attributes",issuerUniqueID:"issuerUniqueID",extensions:{names:{blockName:"extensions"}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for AttributeCertificateInfoV2");this.version=asn1.result.version.valueBlock.valueDec;this.holder=new Holder({schema:asn1.result.holder});switch(asn1.result.issuer.idBlock.tagClass){case 3:asn1.result.issuer.idBlock.tagClass=1;asn1.result.issuer.idBlock.tagNumber=16;this.issuer=new V2Form({schema:asn1.result.issuer});break;case 1:default:throw new Error("Incorect value for 'issuer' in AttributeCertificateInfoV2")}this.signature=new _AlgorithmIdentifier2.default({schema:asn1.result.signature});this.serialNumber=asn1.result.serialNumber;this.attrCertValidityPeriod=new _AttributeCertificateV.AttCertValidityPeriod({schema:asn1.result.attrCertValidityPeriod});this.attributes=Array.from(asn1.result.attributes.valueBlock.value,function(element){return new _Attribute2.default({schema:element})});if("issuerUniqueID"in asn1.result)this.issuerUniqueID=asn1.result.issuerUniqueID;if("extensions"in asn1.result)this.extensions=new _Extensions2.default({schema:asn1.result.extensions})}},{key:"toSchema",value:function toSchema(){var result=new asn1js.Sequence({value:[new asn1js.Integer({value:this.version}),this.holder.toSchema(),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:this.issuer.toSchema().valueBlock.value}),this.signature.toSchema(),this.serialNumber,this.attrCertValidityPeriod.toSchema(),new asn1js.Sequence({value:Array.from(this.attributes,function(element){return element.toSchema()})})]});if("issuerUniqueID"in this)result.valueBlock.value.push(this.issuerUniqueID);if("extensions"in this)result.valueBlock.value.push(this.extensions.toSchema());return result}},{key:"toJSON",value:function toJSON(){var result={version:this.version,holder:this.holder.toJSON(),issuer:this.issuer.toJSON(),signature:this.signature.toJSON(),serialNumber:this.serialNumber.toJSON(),attrCertValidityPeriod:this.attrCertValidityPeriod.toJSON(),attributes:Array.from(this.attributes,function(element){return element.toJSON()})};if("issuerUniqueID"in this)result.issuerUniqueID=this.issuerUniqueID.toJSON();if("extensions"in this)result.extensions=this.extensions.toJSON();return result}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 1;case"holder":return new Holder;case"issuer":return{};case"signature":return new _AlgorithmIdentifier2.default;case"serialNumber":return new asn1js.Integer;case"attrCertValidityPeriod":return new _AttributeCertificateV.AttCertValidityPeriod;case"attributes":return[];case"issuerUniqueID":return new asn1js.BitString;case"extensions":return new _Extensions2.default;default:throw new Error("Invalid member name for AttributeCertificateInfoV2 class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.version||""}),Holder.schema(names.holder||{}),new asn1js.Choice({value:[_GeneralNames2.default.schema({names:{blockName:names.issuer||""}}),new asn1js.Constructed({name:names.issuer||"",idBlock:{tagClass:3,tagNumber:0},value:V2Form.schema().valueBlock.value})]}),_AlgorithmIdentifier2.default.schema(names.signature||{}),new asn1js.Integer({name:names.serialNumber||""}),_AttributeCertificateV.AttCertValidityPeriod.schema(names.attrCertValidityPeriod||{}),new asn1js.Sequence({name:names.attributes||"",value:[new asn1js.Repeated({value:_Attribute2.default.schema()})]}),new asn1js.BitString({optional:true,name:names.issuerUniqueID||""}),_Extensions2.default.schema(names.extensions||{},true)]})}}]);return AttributeCertificateInfoV2}();var AttributeCertificateV2=function(){function AttributeCertificateV2(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,AttributeCertificateV2);this.acinfo=(0,_pvutils.getParametersValue)(parameters,"acinfo",AttributeCertificateV2.defaultValues("acinfo"));this.signatureAlgorithm=(0,_pvutils.getParametersValue)(parameters,"signatureAlgorithm",AttributeCertificateV2.defaultValues("signatureAlgorithm"));this.signatureValue=(0,_pvutils.getParametersValue)(parameters,"signatureValue",AttributeCertificateV2.defaultValues("signatureValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(AttributeCertificateV2,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,AttributeCertificateV2.schema({names:{acinfo:{names:{blockName:"acinfo"}},signatureAlgorithm:{names:{blockName:"signatureAlgorithm"}},signatureValue:"signatureValue"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for AttributeCertificateV2");this.acinfo=new AttributeCertificateInfoV2({schema:asn1.result.acinfo});this.signatureAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.signatureAlgorithm});this.signatureValue=asn1.result.signatureValue}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}},{key:"toJSON",value:function toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"acinfo":return new AttributeCertificateInfoV2;case"signatureAlgorithm":return new _AlgorithmIdentifier2.default;case"signatureValue":return new asn1js.BitString;default:throw new Error("Invalid member name for AttributeCertificateV2 class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[AttributeCertificateInfoV2.schema(names.acinfo||{}),_AlgorithmIdentifier2.default.schema(names.signatureAlgorithm||{}),new asn1js.BitString({name:names.signatureValue||""})]})}}]);return AttributeCertificateV2}();exports.default=AttributeCertificateV2},{"./AlgorithmIdentifier.js":3,"./Attribute.js":5,"./AttributeCertificateV1.js":6,"./Extensions.js":36,"./GeneralNames.js":38,asn1js:"asn1js",pvutils:"pvutils"}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AttributeTypeAndValue=function(){function AttributeTypeAndValue(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,AttributeTypeAndValue);this.type=(0,_pvutils.getParametersValue)(parameters,"type",AttributeTypeAndValue.defaultValues("type"));this.value=(0,_pvutils.getParametersValue)(parameters,"value",AttributeTypeAndValue.defaultValues("value"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(AttributeTypeAndValue,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,AttributeTypeAndValue.schema({names:{type:"type",value:"typeValue"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for ATTR_TYPE_AND_VALUE");this.type=asn1.result.type.valueBlock.toString();this.value=asn1.result.typeValue}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.ObjectIdentifier({value:this.type}),this.value]})}},{key:"toJSON",value:function toJSON(){var _object={type:this.type};if(Object.keys(this.value).length!==0)_object.value=this.value.toJSON();else _object.value=this.value;return _object}},{key:"isEqual",value:function isEqual(compareTo){if(compareTo instanceof AttributeTypeAndValue){if(this.type!==compareTo.type)return false;if(this.value instanceof asn1js.Utf8String&&compareTo.value instanceof asn1js.Utf8String||this.value instanceof asn1js.BmpString&&compareTo.value instanceof asn1js.BmpString||this.value instanceof asn1js.UniversalString&&compareTo.value instanceof asn1js.UniversalString||this.value instanceof asn1js.NumericString&&compareTo.value instanceof asn1js.NumericString||this.value instanceof asn1js.PrintableString&&compareTo.value instanceof asn1js.PrintableString||this.value instanceof asn1js.TeletexString&&compareTo.value instanceof asn1js.TeletexString||this.value instanceof asn1js.VideotexString&&compareTo.value instanceof asn1js.VideotexString||this.value instanceof asn1js.IA5String&&compareTo.value instanceof asn1js.IA5String||this.value instanceof asn1js.GraphicString&&compareTo.value instanceof asn1js.GraphicString||this.value instanceof asn1js.VisibleString&&compareTo.value instanceof asn1js.VisibleString||this.value instanceof asn1js.GeneralString&&compareTo.value instanceof asn1js.GeneralString||this.value instanceof asn1js.CharacterString&&compareTo.value instanceof asn1js.CharacterString){var value1=(0,_common.stringPrep)(this.value.valueBlock.value);var value2=(0,_common.stringPrep)(compareTo.value.valueBlock.value);if(value1.localeCompare(value2)!==0)return false}else{if((0,_pvutils.isEqualBuffer)(this.value.valueBeforeDecode,compareTo.value.valueBeforeDecode)===false)return false}return true}if(compareTo instanceof ArrayBuffer)return(0,_pvutils.isEqualBuffer)(this.value.valueBeforeDecode,compareTo);return false}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"type":return"";case"value":return{};default:throw new Error("Invalid member name for AttributeTypeAndValue class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.type||""}),new asn1js.Any({name:names.value||""})]})}}]);return AttributeTypeAndValue}();exports.default=AttributeTypeAndValue},{"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _ContentInfo=require("./ContentInfo.js");var _ContentInfo2=_interopRequireDefault(_ContentInfo);var _SafeContents=require("./SafeContents.js");var _SafeContents2=_interopRequireDefault(_SafeContents);var _EnvelopedData=require("./EnvelopedData.js");var _EnvelopedData2=_interopRequireDefault(_EnvelopedData);var _EncryptedData=require("./EncryptedData.js");var _EncryptedData2=_interopRequireDefault(_EncryptedData);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AuthenticatedSafe=function(){function AuthenticatedSafe(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,AuthenticatedSafe);this.safeContents=(0,_pvutils.getParametersValue)(parameters,"safeContents",AuthenticatedSafe.defaultValues("safeContents"));if("parsedValue"in parameters)this.parsedValue=(0,_pvutils.getParametersValue)(parameters,"parsedValue",AuthenticatedSafe.defaultValues("parsedValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(AuthenticatedSafe,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,AuthenticatedSafe.schema({names:{contentInfos:"contentInfos"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for AuthenticatedSafe");this.safeContents=Array.from(asn1.result.contentInfos,function(element){return new _ContentInfo2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:Array.from(this.safeContents,function(element){return element.toSchema()})})}},{key:"toJSON",value:function toJSON(){return{safeContents:Array.from(this.safeContents,function(element){return element.toJSON()})}}},{key:"parseInternalValues",value:function parseInternalValues(parameters){var _this=this;if(parameters instanceof Object===false)return Promise.reject('The "parameters" must has "Object" type');if("safeContents"in parameters===false)return Promise.reject('Absent mandatory parameter "safeContents"');if(parameters.safeContents instanceof Array===false)return Promise.reject('The "parameters.safeContents" must has "Array" type');if(parameters.safeContents.length!==this.safeContents.length)return Promise.reject('Length of "parameters.safeContents" must be equal to "this.safeContents.length"');var sequence=Promise.resolve();this.parsedValue={safeContents:[]};var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.safeContents.entries()[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _ref=_step.value;var _ref2=_slicedToArray(_ref,2);var index=_ref2[0];var content=_ref2[1];switch(content.contentType){case"1.2.840.113549.1.7.1":{if(content.content instanceof asn1js.OctetString===false)return Promise.reject('Wrong type of "this.safeContents[j].content"');var authSafeContent=new ArrayBuffer(0);if(content.content.valueBlock.isConstructed){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=content.content.valueBlock.value[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var contentValue=_step2.value;authSafeContent=(0,_pvutils.utilConcatBuf)(authSafeContent,contentValue.valueBlock.valueHex)}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}}else authSafeContent=content.content.valueBlock.valueHex;var asn1=asn1js.fromBER(authSafeContent);if(asn1.offset===-1)return Promise.reject('Error during parsing of ASN.1 data inside "content.content"');this.parsedValue.safeContents.push({privacyMode:0,value:new _SafeContents2.default({schema:asn1.result})})}break;case"1.2.840.113549.1.7.3":{var _ret=function(){var cmsEnveloped=new _EnvelopedData2.default({schema:content.content});if("recipientCertificate"in parameters.safeContents[index]===false)return{v:Promise.reject('Absent mandatory parameter "recipientCertificate" in "parameters.safeContents[j]"')};var recipientCertificate=parameters.safeContents[index].recipientCertificate;if("recipientKey"in parameters.safeContents[index]===false)return{v:Promise.reject('Absent mandatory parameter "recipientKey" in "parameters.safeContents[j]"')};var recipientKey=parameters.safeContents[index].recipientKey;sequence=sequence.then(function(){return cmsEnveloped.decrypt(0,{recipientCertificate:recipientCertificate,recipientPrivateKey:recipientKey})});sequence=sequence.then(function(result){var asn1=asn1js.fromBER(result);if(asn1.offset===-1)return Promise.reject("Error during parsing of decrypted data");_this.parsedValue.safeContents.push({privacyMode:2,value:new _SafeContents2.default({schema:asn1.result})});return Promise.resolve()})}();if((typeof _ret==="undefined"?"undefined":_typeof(_ret))==="object")return _ret.v}break;case"1.2.840.113549.1.7.6":{var _ret2=function(){var cmsEncrypted=new _EncryptedData2.default({schema:content.content});if("password"in parameters.safeContents[index]===false)return{v:Promise.reject('Absent mandatory parameter "password" in "parameters.safeContents[j]"')};var password=parameters.safeContents[index].password;sequence=sequence.then(function(){return cmsEncrypted.decrypt({password:password})},function(error){return Promise.reject(error)});sequence=sequence.then(function(result){var asn1=asn1js.fromBER(result);if(asn1.offset===-1)return Promise.reject("Error during parsing of decrypted data");_this.parsedValue.safeContents.push({privacyMode:1,value:new _SafeContents2.default({schema:asn1.result})});return Promise.resolve()},function(error){return Promise.reject(error)})}();if((typeof _ret2==="undefined"?"undefined":_typeof(_ret2))==="object")return _ret2.v}break;default:throw new Error('Unknown "contentType" for AuthenticatedSafe: " '+content.contentType)}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return sequence}},{key:"makeInternalValues",value:function makeInternalValues(parameters){var _this2=this;if("parsedValue"in this===false)return Promise.reject('Please run "parseValues" first or add "parsedValue" manually');if(this.parsedValue instanceof Object===false)return Promise.reject('The "this.parsedValue" must has "Object" type');if(this.parsedValue.safeContents instanceof Array===false)return Promise.reject('The "this.parsedValue.safeContents" must has "Array" type');if(parameters instanceof Object===false)return Promise.reject('The "parameters" must has "Object" type');if("safeContents"in parameters===false)return Promise.reject('Absent mandatory parameter "safeContents"');if(parameters.safeContents instanceof Array===false)return Promise.reject('The "parameters.safeContents" must has "Array" type');if(parameters.safeContents.length!==this.parsedValue.safeContents.length)return Promise.reject('Length of "parameters.safeContents" must be equal to "this.parsedValue.safeContents"');var sequence=Promise.resolve();this.safeContents=[];var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=this.parsedValue.safeContents.entries()[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var _ref3=_step3.value;var _ref4=_slicedToArray(_ref3,2);var index=_ref4[0];var content=_ref4[1];if("privacyMode"in content===false)return Promise.reject('The "privacyMode" is a mandatory parameter for "content"');if("value"in content===false)return Promise.reject('The "value" is a mandatory parameter for "content"');if(content.value instanceof _SafeContents2.default===false)return Promise.reject('The "content.value" must has "SafeContents" type');switch(content.privacyMode){case 0:{(function(){var contentBuffer=content.value.toSchema().toBER(false);sequence=sequence.then(function(){_this2.safeContents.push(new _ContentInfo2.default({contentType:"1.2.840.113549.1.7.1",content:new asn1js.OctetString({valueHex:contentBuffer})}))})})()}break;case 1:{(function(){var cmsEncrypted=new _EncryptedData2.default;var currentParameters=parameters.safeContents[index];currentParameters.contentToEncrypt=content.value.toSchema().toBER(false);sequence=sequence.then(function(){return cmsEncrypted.encrypt(currentParameters)},function(error){return Promise.reject(error)});sequence=sequence.then(function(){_this2.safeContents.push(new _ContentInfo2.default({contentType:"1.2.840.113549.1.7.6",content:cmsEncrypted.toSchema()}))},function(error){return Promise.reject(error)})})()}break;case 2:{var _ret5=function(){var cmsEnveloped=new _EnvelopedData2.default;var contentToEncrypt=content.value.toSchema().toBER(false);if("encryptingCertificate"in parameters.safeContents[index]===false)return{v:Promise.reject('Absent mandatory parameter "encryptingCertificate" in "parameters.safeContents[i]"')};if("encryptionAlgorithm"in parameters.safeContents[index]===false)return{v:Promise.reject('Absent mandatory parameter "encryptionAlgorithm" in "parameters.safeContents[i]"')};switch(true){case parameters.safeContents[index].encryptionAlgorithm.name.toLowerCase()==="aes-cbc":case parameters.safeContents[index].encryptionAlgorithm.name.toLowerCase()==="aes-gcm":break;default:return{v:Promise.reject('Incorrect parameter "encryptionAlgorithm" in "parameters.safeContents[i]": '+parameters.safeContents[index].encryptionAlgorithm)}}switch(true){case parameters.safeContents[index].encryptionAlgorithm.length===128:case parameters.safeContents[index].encryptionAlgorithm.length===192:case parameters.safeContents[index].encryptionAlgorithm.length===256:break;default:return{v:Promise.reject('Incorrect parameter "encryptionAlgorithm.length" in "parameters.safeContents[i]": '+parameters.safeContents[index].encryptionAlgorithm.length)}}var encryptionAlgorithm=parameters.safeContents[index].encryptionAlgorithm;cmsEnveloped.addRecipientByCertificate(parameters.safeContents[index].encryptingCertificate);sequence=sequence.then(function(){return cmsEnveloped.encrypt(encryptionAlgorithm,contentToEncrypt)});sequence=sequence.then(function(){_this2.safeContents.push(new _ContentInfo2.default({contentType:"1.2.840.113549.1.7.3",content:cmsEnveloped.toSchema()}))})}();if((typeof _ret5==="undefined"?"undefined":_typeof(_ret5))==="object")return _ret5.v}break;default:return Promise.reject('Incorrect value for "content.privacyMode": '+content.privacyMode)}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}return sequence.then(function(){return _this2},function(error){return Promise.reject("Error during parsing: "+error)})}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"safeContents":return[];case"parsedValue":return{};default:throw new Error("Invalid member name for AuthenticatedSafe class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"safeContents":return memberValue.length===0;case"parsedValue":return memberValue instanceof Object&&Object.keys(memberValue).length===0;default:throw new Error("Invalid member name for AuthenticatedSafe class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Repeated({name:names.contentInfos||"",value:_ContentInfo2.default.schema()})]})}}]);return AuthenticatedSafe}();exports.default=AuthenticatedSafe},{"./ContentInfo.js":23,"./EncryptedData.js":32,"./EnvelopedData.js":33,"./SafeContents.js":92,asn1js:"asn1js",pvutils:"pvutils"}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _GeneralName=require("./GeneralName.js");var _GeneralName2=_interopRequireDefault(_GeneralName);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AuthorityKeyIdentifier=function(){function AuthorityKeyIdentifier(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,AuthorityKeyIdentifier);if("keyIdentifier"in parameters)this.keyIdentifier=(0,_pvutils.getParametersValue)(parameters,"keyIdentifier",AuthorityKeyIdentifier.defaultValues("keyIdentifier"));if("authorityCertIssuer"in parameters)this.authorityCertIssuer=(0,_pvutils.getParametersValue)(parameters,"authorityCertIssuer",AuthorityKeyIdentifier.defaultValues("authorityCertIssuer"));if("authorityCertSerialNumber"in parameters)this.authorityCertSerialNumber=(0,_pvutils.getParametersValue)(parameters,"authorityCertSerialNumber",AuthorityKeyIdentifier.defaultValues("authorityCertSerialNumber"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(AuthorityKeyIdentifier,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,AuthorityKeyIdentifier.schema({names:{keyIdentifier:"keyIdentifier",authorityCertIssuer:"authorityCertIssuer",authorityCertSerialNumber:"authorityCertSerialNumber"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for AuthorityKeyIdentifier");if("keyIdentifier"in asn1.result)this.keyIdentifier=new asn1js.OctetString({valueHex:asn1.result.keyIdentifier.valueBlock.valueHex});if("authorityCertIssuer"in asn1.result)this.authorityCertIssuer=Array.from(asn1.result.authorityCertIssuer,function(element){return new _GeneralName2.default({schema:element})});if("authorityCertSerialNumber"in asn1.result)this.authorityCertSerialNumber=new asn1js.Integer({valueHex:asn1.result.authorityCertSerialNumber.valueBlock.valueHex})}},{key:"toSchema",value:function toSchema(){var outputArray=[];if("keyIdentifier"in this){var value=this.keyIdentifier;value.idBlock.tagClass=3;value.idBlock.tagNumber=0;outputArray.push(value)}if("authorityCertIssuer"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.authorityCertIssuer,function(element){return element.toSchema()})}))}if("authorityCertSerialNumber"in this){var _value=this.authorityCertSerialNumber;_value.idBlock.tagClass=3;_value.idBlock.tagNumber=2;outputArray.push(_value)}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={};if("keyIdentifier"in this)object.keyIdentifier=this.keyIdentifier.toJSON();if("authorityCertIssuer"in this)object.authorityCertIssuer=Array.from(this.authorityCertIssuer,function(element){return element.toJSON()});if("authorityCertSerialNumber"in this)object.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON();return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"keyIdentifier":return new asn1js.OctetString;case"authorityCertIssuer":return[];case"authorityCertSerialNumber":return new asn1js.Integer;default:throw new Error("Invalid member name for AuthorityKeyIdentifier class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Primitive({name:names.keyIdentifier||"",optional:true,idBlock:{tagClass:3,tagNumber:0}}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.Repeated({name:names.authorityCertIssuer||"",value:_GeneralName2.default.schema()})]}),new asn1js.Primitive({name:names.authorityCertSerialNumber||"",optional:true,idBlock:{tagClass:3,tagNumber:2}})]})}}]);return AuthorityKeyIdentifier}();exports.default=AuthorityKeyIdentifier},{"./GeneralName.js":37,asn1js:"asn1js",pvutils:"pvutils"}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var BasicConstraints=function(){function BasicConstraints(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,BasicConstraints);this.cA=(0,_pvutils.getParametersValue)(parameters,"cA",false);if("pathLenConstraint"in parameters)this.pathLenConstraint=(0,_pvutils.getParametersValue)(parameters,"pathLenConstraint",0);if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(BasicConstraints,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,BasicConstraints.schema({names:{cA:"cA",pathLenConstraint:"pathLenConstraint"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for BasicConstraints");if("cA"in asn1.result)this.cA=asn1.result.cA.valueBlock.value;if("pathLenConstraint"in asn1.result){if(asn1.result.pathLenConstraint.valueBlock.isHexOnly)this.pathLenConstraint=asn1.result.pathLenConstraint;else this.pathLenConstraint=asn1.result.pathLenConstraint.valueBlock.valueDec}}},{key:"toSchema",value:function toSchema(){var outputArray=[];if(this.cA!==BasicConstraints.defaultValues("cA"))outputArray.push(new asn1js.Boolean({value:this.cA}));if("pathLenConstraint"in this){if(this.pathLenConstraint instanceof asn1js.Integer)outputArray.push(this.pathLenConstraint);else outputArray.push(new asn1js.Integer({value:this.pathLenConstraint}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={};if(this.cA!==BasicConstraints.defaultValues("cA"))object.cA=this.cA;if("pathLenConstraint"in this){if(this.pathLenConstraint instanceof asn1js.Integer)object.pathLenConstraint=this.pathLenConstraint.toJSON();else object.pathLenConstraint=this.pathLenConstraint}return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"cA":return false;default:throw new Error("Invalid member name for BasicConstraints class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Boolean({optional:true,name:names.cA||""}),new asn1js.Integer({optional:true,name:names.pathLenConstraint||""})]})}}]);return BasicConstraints}();exports.default=BasicConstraints},{asn1js:"asn1js",pvutils:"pvutils"}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");var _ResponseData=require("./ResponseData.js");var _ResponseData2=_interopRequireDefault(_ResponseData);var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _Certificate=require("./Certificate.js");var _Certificate2=_interopRequireDefault(_Certificate);var _CertID=require("./CertID.js");var _CertID2=_interopRequireDefault(_CertID);var _RelativeDistinguishedNames=require("./RelativeDistinguishedNames.js");var _RelativeDistinguishedNames2=_interopRequireDefault(_RelativeDistinguishedNames);var _CertificateChainValidationEngine=require("./CertificateChainValidationEngine.js");var _CertificateChainValidationEngine2=_interopRequireDefault(_CertificateChainValidationEngine);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var BasicOCSPResponse=function(){function BasicOCSPResponse(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,BasicOCSPResponse);this.tbsResponseData=(0,_pvutils.getParametersValue)(parameters,"tbsResponseData",BasicOCSPResponse.defaultValues("tbsResponseData"));this.signatureAlgorithm=(0,_pvutils.getParametersValue)(parameters,"signatureAlgorithm",BasicOCSPResponse.defaultValues("signatureAlgorithm"));this.signature=(0,_pvutils.getParametersValue)(parameters,"signature",BasicOCSPResponse.defaultValues("signature"));if("certs"in parameters)this.certs=(0,_pvutils.getParametersValue)(parameters,"certs",BasicOCSPResponse.defaultValues("certs"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(BasicOCSPResponse,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,BasicOCSPResponse.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for OCSP_BASIC_RESPONSE");this.tbsResponseData=new _ResponseData2.default({schema:asn1.result["BasicOCSPResponse.tbsResponseData"]});this.signatureAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result["BasicOCSPResponse.signatureAlgorithm"]});this.signature=asn1.result["BasicOCSPResponse.signature"];if("BasicOCSPResponse.certs"in asn1.result)this.certs=Array.from(asn1.result["BasicOCSPResponse.certs"],function(element){return new _Certificate2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(this.tbsResponseData.toSchema());outputArray.push(this.signatureAlgorithm.toSchema());outputArray.push(this.signature);if("certs"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Sequence({value:Array.from(this.certs,function(element){return element.toSchema()})})]}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={tbsResponseData:this.tbsResponseData.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};if("certs"in this)_object.certs=Array.from(this.certs,function(element){return element.toJSON()});return _object}},{key:"getCertificateStatus",value:function getCertificateStatus(certificate,issuerCertificate){var _this2=this;var sequence=Promise.resolve();var result={isForCertificate:false,status:2};var hashesObject={};var certIDs=[];var certIDPromises=[];var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.tbsResponseData.responses[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var response=_step.value;var hashAlgorithm=(0,_common.getAlgorithmByOID)(response.certID.hashAlgorithm.algorithmId);if("name"in hashAlgorithm===false)return Promise.reject("Wrong CertID hashing algorithm: "+response.certID.hashAlgorithm.algorithmId);if(hashAlgorithm.name in hashesObject===false){hashesObject[hashAlgorithm.name]=1;var certID=new _CertID2.default;certIDs.push(certID);certIDPromises.push(certID.createForCertificate(certificate,{hashAlgorithm:hashAlgorithm.name,issuerCertificate:issuerCertificate}))}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}sequence=sequence.then(function(){return Promise.all(certIDPromises)});sequence=sequence.then(function(){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=_this2.tbsResponseData.responses[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var _response=_step2.value;var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=certIDs[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var id=_step3.value;if(_response.certID.isEqual(id)){result.isForCertificate=true;try{switch(_response.certStatus.idBlock.isConstructed){case true:if(_response.certStatus.idBlock.tagNumber===1)result.status=1;break;case false:switch(_response.certStatus.idBlock.tagNumber){case 0:result.status=0;break;case 2:result.status=2;break;default:}break;default:}}catch(ex){}return result}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}return result});return sequence}},{key:"sign",value:function sign(privateKey){var _this3=this;var hashAlgorithm=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"SHA-1";if(typeof privateKey==="undefined")return Promise.reject("Need to provide a private key for signing");var sequence=Promise.resolve();var parameters=void 0;var engine=(0,_common.getEngine)();sequence=sequence.then(function(){return engine.subtle.getSignatureParameters(privateKey,hashAlgorithm)});sequence=sequence.then(function(result){parameters=result.parameters;_this3.signatureAlgorithm=result.signatureAlgorithm});sequence=sequence.then(function(){_this3.tbsResponseData.tbs=_this3.tbsResponseData.toSchema(true).toBER(false)});sequence=sequence.then(function(){return engine.subtle.signWithPrivateKey(_this3.tbsResponseData.tbs,privateKey,parameters)});sequence=sequence.then(function(result){_this3.signature=new asn1js.BitString({valueHex:result})});return sequence}},{key:"verify",value:function verify(){var _this4=this;var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var signerCert=null;var certIndex=-1;var sequence=Promise.resolve();var trustedCerts=[];var _this=this;var engine=(0,_common.getEngine)();if("certs"in this===false)return Promise.reject("No certificates attached to the BasicOCSPResponce");if("trustedCerts"in parameters)trustedCerts=parameters.trustedCerts;function checkCA(cert){if(cert.issuer.isEqual(signerCert.issuer)===true&&cert.serialNumber.isEqual(signerCert.serialNumber)===true)return null;var isCA=false;var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=cert.extensions[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var extension=_step4.value;if(extension.extnID==="2.5.29.19"){if("cA"in extension.parsedValue){if(extension.parsedValue.cA===true)isCA=true}}}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally{try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally{if(_didIteratorError4){throw _iteratorError4}}}if(isCA)return cert;return null}var crypto=(0,_common.getCrypto)();if(typeof crypto==="undefined")return Promise.reject("Unable to create WebCrypto object");switch(true){case this.tbsResponseData.responderID instanceof _RelativeDistinguishedNames2.default:sequence=sequence.then(function(){var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=_this.certs.entries()[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var _ref=_step5.value;var _ref2=_slicedToArray(_ref,2);var index=_ref2[0];var certificate=_ref2[1];if(certificate.subject.isEqual(_this.tbsResponseData.responderID)){certIndex=index;break}}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally{try{if(!_iteratorNormalCompletion5&&_iterator5.return){_iterator5.return()}}finally{if(_didIteratorError5){throw _iteratorError5}}}});break;case this.tbsResponseData.responderID instanceof asn1js.OctetString:sequence=sequence.then(function(){return Promise.all(Array.from(_this.certs,function(element){return crypto.digest({name:"sha-1"},new Uint8Array(element.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex))})).then(function(results){var _iteratorNormalCompletion6=true;var _didIteratorError6=false;var _iteratorError6=undefined;try{for(var _iterator6=_this.certs.entries()[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=true){var _ref3=_step6.value;var _ref4=_slicedToArray(_ref3,1);var index=_ref4[0];if((0,_pvutils.isEqualBuffer)(results[index],_this.tbsResponseData.responderID.valueBlock.valueHex)){certIndex=index;break}}}catch(err){_didIteratorError6=true;_iteratorError6=err}finally{try{if(!_iteratorNormalCompletion6&&_iterator6.return){_iterator6.return()}}finally{if(_didIteratorError6){throw _iteratorError6}}}})});break;default:return Promise.reject("Wrong value for responderID")}sequence=sequence.then(function(){if(certIndex===-1)return Promise.reject("Correct certificate was not found in OCSP response");signerCert=_this4.certs[certIndex];return Promise.all(Array.from(_this.certs,function(element){return checkCA(element)})).then(function(promiseResults){var additionalCerts=[];additionalCerts.push(signerCert);var _iteratorNormalCompletion7=true;var _didIteratorError7=false;var _iteratorError7=undefined;try{for(var _iterator7=promiseResults[Symbol.iterator](),_step7;!(_iteratorNormalCompletion7=(_step7=_iterator7.next()).done);_iteratorNormalCompletion7=true){var promiseResult=_step7.value;if(promiseResult!==null)additionalCerts.push(promiseResult)}}catch(err){_didIteratorError7=true;_iteratorError7=err}finally{try{if(!_iteratorNormalCompletion7&&_iterator7.return){_iterator7.return()}}finally{if(_didIteratorError7){throw _iteratorError7}}}var certChain=new _CertificateChainValidationEngine2.default({certs:additionalCerts,trustedCerts:trustedCerts});return certChain.verify().then(function(verificationResult){if(verificationResult.result===true)return Promise.resolve();return Promise.reject("Validation of signer's certificate failed")},function(error){return Promise.reject("Validation of signer's certificate failed with error: "+(error instanceof Object?error.resultMessage:error))})},function(promiseError){return Promise.reject("Error during checking certificates for CA flag: "+promiseError)})});sequence=sequence.then(function(){return engine.subtle.verifyWithPublicKey(_this4.tbsResponseData.tbs,_this4.signature,_this4.certs[certIndex].subjectPublicKeyInfo,_this4.signatureAlgorithm)});return sequence}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"tbsResponseData":return new _ResponseData2.default;case"signatureAlgorithm":return new _AlgorithmIdentifier2.default;case"signature":return new asn1js.BitString;case"certs":return[];default:throw new Error("Invalid member name for BasicOCSPResponse class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"type":{var comparisonResult=_ResponseData2.default.compareWithDefault("tbs",memberValue.tbs)&&_ResponseData2.default.compareWithDefault("responderID",memberValue.responderID)&&_ResponseData2.default.compareWithDefault("producedAt",memberValue.producedAt)&&_ResponseData2.default.compareWithDefault("responses",memberValue.responses);if("responseExtensions"in memberValue)comparisonResult=comparisonResult&&_ResponseData2.default.compareWithDefault("responseExtensions",memberValue.responseExtensions);return comparisonResult}case"signatureAlgorithm":return memberValue.algorithmId===""&&"algorithmParams"in memberValue===false;case"signature":return memberValue.isEqual(BasicOCSPResponse.defaultValues(memberName));case"certs":return memberValue.length===0;default:throw new Error("Invalid member name for BasicOCSPResponse class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"BasicOCSPResponse",value:[_ResponseData2.default.schema(names.tbsResponseData||{names:{blockName:"BasicOCSPResponse.tbsResponseData"}}),_AlgorithmIdentifier2.default.schema(names.signatureAlgorithm||{names:{blockName:"BasicOCSPResponse.signatureAlgorithm"}}),new asn1js.BitString({name:names.signature||"BasicOCSPResponse.signature"}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Sequence({value:[new asn1js.Repeated({name:"BasicOCSPResponse.certs",value:_Certificate2.default.schema(names.certs||{})})]})]})]})}}]);return BasicOCSPResponse}();exports.default=BasicOCSPResponse},{"./AlgorithmIdentifier.js":3,"./CertID.js":16,"./Certificate.js":17,"./CertificateChainValidationEngine.js":18,"./RelativeDistinguishedNames.js":85,"./ResponseData.js":88,"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _CertificateRevocationList=require("./CertificateRevocationList.js");var _CertificateRevocationList2=_interopRequireDefault(_CertificateRevocationList);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CRLBag=function(){function CRLBag(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,CRLBag);this.crlId=(0,_pvutils.getParametersValue)(parameters,"crlId",CRLBag.defaultValues("crlId"));this.crlValue=(0,_pvutils.getParametersValue)(parameters,"crlValue",CRLBag.defaultValues("crlValue"));if("parsedValue"in parameters)this.parsedValue=(0,_pvutils.getParametersValue)(parameters,"parsedValue",CRLBag.defaultValues("parsedValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(CRLBag,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,CRLBag.schema({names:{id:"crlId",value:"crlValue"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CRLBag");this.crlId=asn1.result.crlId.valueBlock.toString();this.crlValue=asn1.result.crlValue;switch(this.crlId){case"1.2.840.113549.1.9.23.1":{var asn1Inner=asn1js.fromBER(this.certValue.valueBlock.valueHex);this.parsedValue=new _CertificateRevocationList2.default({schema:asn1Inner.result})}break;default:throw new Error('Incorrect "crlId" value in CRLBag: '+this.crlId)}}},{key:"toSchema",value:function toSchema(){if("parsedValue"in this){this.certId="1.2.840.113549.1.9.23.1";this.certValue=new asn1js.OctetString({valueHex:this.parsedValue.toSchema().toBER(false)})}return new asn1js.Sequence({value:[new asn1js.ObjectIdentifier({value:this.crlId}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.crlValue.toSchema()]})]})}},{key:"toJSON",value:function toJSON(){return{crlId:this.crlId,crlValue:this.crlValue.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"crlId":return"";case"crlValue":return new asn1js.Any;case"parsedValue":return{};default:throw new Error("Invalid member name for CRLBag class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"crlId":return memberValue==="";case"crlValue":return memberValue instanceof asn1js.Any;case"parsedValue":return memberValue instanceof Object&&Object.keys(memberValue).length===0;default:throw new Error("Invalid member name for CRLBag class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.id||"id"}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Any({name:names.value||"value"})]})]})}}]);return CRLBag}();exports.default=CRLBag},{"./CertificateRevocationList.js":20,asn1js:"asn1js",pvutils:"pvutils"}],14:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _DistributionPoint=require("./DistributionPoint.js");var _DistributionPoint2=_interopRequireDefault(_DistributionPoint);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CRLDistributionPoints=function(){function CRLDistributionPoints(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,CRLDistributionPoints);this.distributionPoints=(0,_pvutils.getParametersValue)(parameters,"distributionPoints",CRLDistributionPoints.defaultValues("distributionPoints"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(CRLDistributionPoints,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,CRLDistributionPoints.schema({names:{distributionPoints:"distributionPoints"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CRLDistributionPoints");this.distributionPoints=Array.from(asn1.result.distributionPoints,function(element){return new _DistributionPoint2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:Array.from(this.distributionPoints,function(element){return element.toSchema()})})}},{key:"toJSON",value:function toJSON(){return{distributionPoints:Array.from(this.distributionPoints,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"distributionPoints":return[];default:throw new Error("Invalid member name for CRLDistributionPoints class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Repeated({name:names.distributionPoints||"",value:_DistributionPoint2.default.schema()})]})}}]);return CRLDistributionPoints}();exports.default=CRLDistributionPoints},{"./DistributionPoint.js":26,asn1js:"asn1js",pvutils:"pvutils"}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _Certificate=require("./Certificate.js");var _Certificate2=_interopRequireDefault(_Certificate);var _AttributeCertificateV=require("./AttributeCertificateV2.js");var _AttributeCertificateV2=_interopRequireDefault(_AttributeCertificateV);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CertBag=function(){function CertBag(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,CertBag);this.certId=(0,_pvutils.getParametersValue)(parameters,"certId",CertBag.defaultValues("certId"));this.certValue=(0,_pvutils.getParametersValue)(parameters,"certValue",CertBag.defaultValues("certValue"));if("parsedValue"in parameters)this.parsedValue=(0,_pvutils.getParametersValue)(parameters,"parsedValue",CertBag.defaultValues("parsedValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(CertBag,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,CertBag.schema({names:{id:"certId",value:"certValue"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CertBag");this.certId=asn1.result.certId.valueBlock.toString();this.certValue=asn1.result.certValue;switch(this.certId){case"1.2.840.113549.1.9.22.1":{var asn1Inner=asn1js.fromBER(this.certValue.valueBlock.valueHex);try{this.parsedValue=new _Certificate2.default({schema:asn1Inner.result})}catch(ex){this.parsedValue=new _AttributeCertificateV2.default({schema:asn1Inner.result})}}break;case"1.2.840.113549.1.9.22.3":{var _asn1Inner=asn1js.fromBER(this.certValue.valueBlock.valueHex);this.parsedValue=new _AttributeCertificateV2.default({schema:_asn1Inner.result})}break;case"1.2.840.113549.1.9.22.2":default:throw new Error('Incorrect "certId" value in CertBag: '+this.certId)}}},{key:"toSchema",value:function toSchema(){if("parsedValue"in this){if("acinfo"in this.parsedValue)this.certId="1.2.840.113549.1.9.22.3";else this.certId="1.2.840.113549.1.9.22.1";this.certValue=new asn1js.OctetString({valueHex:this.parsedValue.toSchema().toBER(false)})}return new asn1js.Sequence({value:[new asn1js.ObjectIdentifier({value:this.certId}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:["toSchema"in this.certValue?this.certValue.toSchema():this.certValue]})]})}},{key:"toJSON",value:function toJSON(){return{certId:this.certId,certValue:this.certValue.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"certId":return"";case"certValue":return new asn1js.Any;case"parsedValue":return{};default:throw new Error("Invalid member name for CertBag class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"certId":return memberValue==="";case"certValue":return memberValue instanceof asn1js.Any;case"parsedValue":return memberValue instanceof Object&&Object.keys(memberValue).length===0;default:throw new Error("Invalid member name for CertBag class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.id||"id"}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Any({name:names.value||"value"})]})]})}}]);return CertBag}();exports.default=CertBag},{"./AttributeCertificateV2.js":7,"./Certificate.js":17,asn1js:"asn1js",pvutils:"pvutils"}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CertID=function(){function CertID(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,CertID);this.hashAlgorithm=(0,_pvutils.getParametersValue)(parameters,"hashAlgorithm",CertID.defaultValues("hashAlgorithm"));this.issuerNameHash=(0,_pvutils.getParametersValue)(parameters,"issuerNameHash",CertID.defaultValues("issuerNameHash"));this.issuerKeyHash=(0,_pvutils.getParametersValue)(parameters,"issuerKeyHash",CertID.defaultValues("issuerKeyHash"));this.serialNumber=(0,_pvutils.getParametersValue)(parameters,"serialNumber",CertID.defaultValues("serialNumber"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(CertID,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,CertID.schema({names:{hashAlgorithm:"hashAlgorithm",issuerNameHash:"issuerNameHash",issuerKeyHash:"issuerKeyHash",serialNumber:"serialNumber"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CertID");this.hashAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.hashAlgorithm});this.issuerNameHash=asn1.result.issuerNameHash;this.issuerKeyHash=asn1.result.issuerKeyHash;this.serialNumber=asn1.result.serialNumber}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[this.hashAlgorithm.toSchema(),this.issuerNameHash,this.issuerKeyHash,this.serialNumber]})}},{key:"toJSON",value:function toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),issuerNameHash:this.issuerNameHash.toJSON(),issuerKeyHash:this.issuerKeyHash.toJSON(),serialNumber:this.serialNumber.toJSON()}}},{key:"isEqual",value:function isEqual(certificateID){if(!this.hashAlgorithm.algorithmId===certificateID.hashAlgorithm.algorithmId)return false;if((0,_pvutils.isEqualBuffer)(this.issuerNameHash.valueBlock.valueHex,certificateID.issuerNameHash.valueBlock.valueHex)===false)return false;if((0,_pvutils.isEqualBuffer)(this.issuerKeyHash.valueBlock.valueHex,certificateID.issuerKeyHash.valueBlock.valueHex)===false)return false;if(!this.serialNumber.isEqual(certificateID.serialNumber))return false;return true}},{key:"createForCertificate",value:function createForCertificate(certificate,parameters){var _this=this;var sequence=Promise.resolve();var issuerCertificate=void 0;var crypto=(0,_common.getCrypto)();if(typeof crypto==="undefined")return Promise.reject("Unable to create WebCrypto object");if("hashAlgorithm"in parameters===false)return Promise.reject('Parameter "hashAlgorithm" is mandatory for "OCSP_REQUEST.createForCertificate"');var hashOID=(0,_common.getOIDByAlgorithm)({name:parameters.hashAlgorithm});if(hashOID==="")return Promise.reject('Incorrect "hashAlgorithm": '+this.hashAlgorithm);this.hashAlgorithm=new _AlgorithmIdentifier2.default({algorithmId:hashOID,algorithmParams:new asn1js.Null});if("issuerCertificate"in parameters)issuerCertificate=parameters.issuerCertificate;else return Promise.reject('Parameter "issuerCertificate" is mandatory for "OCSP_REQUEST.createForCertificate"');this.serialNumber=certificate.serialNumber;sequence=sequence.then(function(){return crypto.digest({name:parameters.hashAlgorithm},issuerCertificate.subject.toSchema().toBER(false))},function(error){return Promise.reject(error)});sequence=sequence.then(function(result){_this.issuerNameHash=new asn1js.OctetString({valueHex:result});var issuerKeyBuffer=issuerCertificate.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex;return crypto.digest({name:parameters.hashAlgorithm},issuerKeyBuffer)},function(error){return Promise.reject(error)}).then(function(result){_this.issuerKeyHash=new asn1js.OctetString({valueHex:result})},function(error){return Promise.reject(error)});return sequence}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"hashAlgorithm":return new _AlgorithmIdentifier2.default;case"issuerNameHash":case"issuerKeyHash":return new asn1js.OctetString;case"serialNumber":return new asn1js.Integer;default:throw new Error("Invalid member name for CertID class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"hashAlgorithm":return memberValue.algorithmId===""&&"algorithmParams"in memberValue===false;case"issuerNameHash":case"issuerKeyHash":case"serialNumber":return memberValue.isEqual(CertID.defaultValues(memberName));default:throw new Error("Invalid member name for CertID class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_AlgorithmIdentifier2.default.schema(names.hashAlgorithmObject||{names:{blockName:names.hashAlgorithm||""}}),new asn1js.OctetString({name:names.issuerNameHash||""}),new asn1js.OctetString({name:names.issuerKeyHash||""}),new asn1js.Integer({name:names.serialNumber||""})]})}}]);return CertID}();exports.default=CertID},{"./AlgorithmIdentifier.js":3,"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],17:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _RelativeDistinguishedNames=require("./RelativeDistinguishedNames.js");var _RelativeDistinguishedNames2=_interopRequireDefault(_RelativeDistinguishedNames);var _Time=require("./Time.js");var _Time2=_interopRequireDefault(_Time);var _PublicKeyInfo=require("./PublicKeyInfo.js");var _PublicKeyInfo2=_interopRequireDefault(_PublicKeyInfo);var _Extension=require("./Extension.js");var _Extension2=_interopRequireDefault(_Extension);var _Extensions=require("./Extensions.js");var _Extensions2=_interopRequireDefault(_Extensions);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function tbsCertificate(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"tbsCertificate",value:[new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Integer({name:names.tbsCertificateVersion||"tbsCertificate.version"})]}),new asn1js.Integer({name:names.tbsCertificateSerialNumber||"tbsCertificate.serialNumber"}),_AlgorithmIdentifier2.default.schema(names.signature||{names:{blockName:"tbsCertificate.signature"}}),_RelativeDistinguishedNames2.default.schema(names.issuer||{names:{blockName:"tbsCertificate.issuer"}}),new asn1js.Sequence({name:names.tbsCertificateValidity||"tbsCertificate.validity",value:[_Time2.default.schema(names.notBefore||{names:{utcTimeName:"tbsCertificate.notBefore",generalTimeName:"tbsCertificate.notBefore"}}),_Time2.default.schema(names.notAfter||{names:{utcTimeName:"tbsCertificate.notAfter",generalTimeName:"tbsCertificate.notAfter"}})]}),_RelativeDistinguishedNames2.default.schema(names.subject||{names:{blockName:"tbsCertificate.subject"}}),_PublicKeyInfo2.default.schema(names.subjectPublicKeyInfo||{names:{blockName:"tbsCertificate.subjectPublicKeyInfo"}}),new asn1js.Primitive({name:names.tbsCertificateIssuerUniqueID||"tbsCertificate.issuerUniqueID",optional:true,idBlock:{tagClass:3,tagNumber:1}}),new asn1js.Primitive({name:names.tbsCertificateSubjectUniqueID||"tbsCertificate.subjectUniqueID",optional:true,idBlock:{tagClass:3,tagNumber:2}}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:3},value:[_Extensions2.default.schema(names.extensions||{names:{blockName:"tbsCertificate.extensions"}})]})]})}var Certificate=function(){function Certificate(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Certificate);this.tbs=(0,_pvutils.getParametersValue)(parameters,"tbs",Certificate.defaultValues("tbs"));this.version=(0,_pvutils.getParametersValue)(parameters,"version",Certificate.defaultValues("version"));this.serialNumber=(0,_pvutils.getParametersValue)(parameters,"serialNumber",Certificate.defaultValues("serialNumber"));this.signature=(0,_pvutils.getParametersValue)(parameters,"signature",Certificate.defaultValues("signature"));this.issuer=(0,_pvutils.getParametersValue)(parameters,"issuer",Certificate.defaultValues("issuer"));this.notBefore=(0,_pvutils.getParametersValue)(parameters,"notBefore",Certificate.defaultValues("notBefore"));this.notAfter=(0,_pvutils.getParametersValue)(parameters,"notAfter",Certificate.defaultValues("notAfter"));this.subject=(0,_pvutils.getParametersValue)(parameters,"subject",Certificate.defaultValues("subject"));this.subjectPublicKeyInfo=(0,_pvutils.getParametersValue)(parameters,"subjectPublicKeyInfo",Certificate.defaultValues("subjectPublicKeyInfo"));if("issuerUniqueID"in parameters)this.issuerUniqueID=(0,_pvutils.getParametersValue)(parameters,"issuerUniqueID",Certificate.defaultValues("issuerUniqueID"));if("subjectUniqueID"in parameters)this.subjectUniqueID=(0,_pvutils.getParametersValue)(parameters,"subjectUniqueID",Certificate.defaultValues("subjectUniqueID"));if("extensions"in parameters)this.extensions=(0,_pvutils.getParametersValue)(parameters,"extensions",Certificate.defaultValues("extensions"));this.signatureAlgorithm=(0,_pvutils.getParametersValue)(parameters,"signatureAlgorithm",Certificate.defaultValues("signatureAlgorithm"));this.signatureValue=(0,_pvutils.getParametersValue)(parameters,"signatureValue",Certificate.defaultValues("signatureValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(Certificate,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,Certificate.schema({names:{tbsCertificate:{names:{extensions:{names:{extensions:"tbsCertificate.extensions"}}}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CERT");this.tbs=asn1.result.tbsCertificate.valueBeforeDecode;if("tbsCertificate.version"in asn1.result)this.version=asn1.result["tbsCertificate.version"].valueBlock.valueDec;this.serialNumber=asn1.result["tbsCertificate.serialNumber"];this.signature=new _AlgorithmIdentifier2.default({schema:asn1.result["tbsCertificate.signature"]});this.issuer=new _RelativeDistinguishedNames2.default({schema:asn1.result["tbsCertificate.issuer"]});this.notBefore=new _Time2.default({schema:asn1.result["tbsCertificate.notBefore"]});this.notAfter=new _Time2.default({schema:asn1.result["tbsCertificate.notAfter"]});this.subject=new _RelativeDistinguishedNames2.default({schema:asn1.result["tbsCertificate.subject"]});this.subjectPublicKeyInfo=new _PublicKeyInfo2.default({schema:asn1.result["tbsCertificate.subjectPublicKeyInfo"]});if("tbsCertificate.issuerUniqueID"in asn1.result)this.issuerUniqueID=asn1.result["tbsCertificate.issuerUniqueID"].valueBlock.valueHex;if("tbsCertificate.subjectUniqueID"in asn1.result)this.issuerUniqueID=asn1.result["tbsCertificate.subjectUniqueID"].valueBlock.valueHex;if("tbsCertificate.extensions"in asn1.result)this.extensions=Array.from(asn1.result["tbsCertificate.extensions"],function(element){return new _Extension2.default({schema:element})});this.signatureAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.signatureAlgorithm});this.signatureValue=asn1.result.signatureValue}},{key:"encodeTBS",value:function encodeTBS(){var outputArray=[];if("version"in this&&this.version!==Certificate.defaultValues("version")){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Integer({value:this.version})]}))}outputArray.push(this.serialNumber);outputArray.push(this.signature.toSchema());outputArray.push(this.issuer.toSchema());outputArray.push(new asn1js.Sequence({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]}));outputArray.push(this.subject.toSchema());outputArray.push(this.subjectPublicKeyInfo.toSchema());if("issuerUniqueID"in this){outputArray.push(new asn1js.Primitive({optional:true,idBlock:{tagClass:3,tagNumber:1},valueHex:this.issuerUniqueID}))}if("subjectUniqueID"in this){outputArray.push(new asn1js.Primitive({optional:true,idBlock:{tagClass:3,tagNumber:2},valueHex:this.subjectUniqueID}))}if("subjectUniqueID"in this){outputArray.push(new asn1js.Primitive({optional:true,idBlock:{tagClass:3,tagNumber:3},value:[this.extensions.toSchema()]}))}if("extensions"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:3},value:[new asn1js.Sequence({value:Array.from(this.extensions,function(element){return element.toSchema()})})]}))}return new asn1js.Sequence({value:outputArray})}},{key:"toSchema",value:function toSchema(){var encodeFlag=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var tbsSchema={};if(encodeFlag===false){if(this.tbs.length===0)return Certificate.schema().value[0];tbsSchema=asn1js.fromBER(this.tbs).result}else tbsSchema=this.encodeTBS();return new asn1js.Sequence({value:[tbsSchema,this.signatureAlgorithm.toSchema(),this.signatureValue]})}},{key:"toJSON",value:function toJSON(){var object={tbs:(0,_pvutils.bufferToHexCodes)(this.tbs,0,this.tbs.byteLength),serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};if("version"in this&&this.version!==Certificate.defaultValues("version"))object.version=this.version;if("issuerUniqueID"in this)object.issuerUniqueID=(0,_pvutils.bufferToHexCodes)(this.issuerUniqueID,0,this.issuerUniqueID.byteLength);if("subjectUniqueID"in this)object.subjectUniqueID=(0,_pvutils.bufferToHexCodes)(this.subjectUniqueID,0,this.subjectUniqueID.byteLength);if("extensions"in this)object.extensions=Array.from(this.extensions,function(element){return element.toJSON()});return object}},{key:"getPublicKey",value:function getPublicKey(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return(0,_common.getEngine)().subtle.getPublicKey(this.subjectPublicKeyInfo,this.signatureAlgorithm,parameters)}},{key:"getKeyHash",value:function getKeyHash(){var crypto=(0,_common.getCrypto)();if(typeof crypto==="undefined")return Promise.reject("Unable to create WebCrypto object");return crypto.digest({name:"sha-1"},new Uint8Array(this.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex))}},{key:"sign",value:function sign(privateKey){var _this=this;var hashAlgorithm=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"SHA-1";if(typeof privateKey==="undefined")return Promise.reject("Need to provide a private key for signing");var sequence=Promise.resolve();var parameters=void 0;var engine=(0,_common.getEngine)();sequence=sequence.then(function(){return engine.subtle.getSignatureParameters(privateKey,hashAlgorithm)});sequence=sequence.then(function(result){parameters=result.parameters;_this.signature=result.signatureAlgorithm;_this.signatureAlgorithm=result.signatureAlgorithm});sequence=sequence.then(function(){_this.tbs=_this.encodeTBS().toBER(false)});sequence=sequence.then(function(){return engine.subtle.signWithPrivateKey(_this.tbs,privateKey,parameters)});sequence=sequence.then(function(result){_this.signatureValue=new asn1js.BitString({valueHex:result})});return sequence}},{key:"verify",value:function verify(){var issuerCertificate=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var subjectPublicKeyInfo={};if(issuerCertificate!==null)subjectPublicKeyInfo=issuerCertificate.subjectPublicKeyInfo;else{if(this.issuer.isEqual(this.subject))subjectPublicKeyInfo=this.subjectPublicKeyInfo}if(subjectPublicKeyInfo instanceof _PublicKeyInfo2.default===false)return Promise.reject("Please provide issuer certificate as a parameter");return(0,_common.getEngine)().subtle.verifyWithPublicKey(this.tbs,this.signatureValue,subjectPublicKeyInfo,this.signatureAlgorithm)}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"tbs":return new ArrayBuffer(0);case"version":return 0;case"serialNumber":return new asn1js.Integer;case"signature":return new _AlgorithmIdentifier2.default;case"issuer":return new _RelativeDistinguishedNames2.default;case"notBefore":return new _Time2.default;case"notAfter":return new _Time2.default;case"subject":return new _RelativeDistinguishedNames2.default;case"subjectPublicKeyInfo":return new _PublicKeyInfo2.default;case"issuerUniqueID":return new ArrayBuffer(0);case"subjectUniqueID":return new ArrayBuffer(0);case"extensions":return[];case"signatureAlgorithm":return new _AlgorithmIdentifier2.default;case"signatureValue":return new asn1js.BitString;default:throw new Error("Invalid member name for Certificate class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[tbsCertificate(names.tbsCertificate),_AlgorithmIdentifier2.default.schema(names.signatureAlgorithm||{names:{blockName:"signatureAlgorithm"}}),new asn1js.BitString({name:names.signatureValue||"signatureValue"})]})}}]);return Certificate}();exports.default=Certificate},{"./AlgorithmIdentifier.js":3,"./Extension.js":35,"./Extensions.js":36,"./PublicKeyInfo.js":75,"./RelativeDistinguishedNames.js":85,"./Time.js":102,"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _pvutils=require("pvutils");var regeneratorRuntime=require("regenerator-runtime");var _common=require("./common.js");function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CertificateChainValidationEngine=function(){function CertificateChainValidationEngine(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,CertificateChainValidationEngine);this.trustedCerts=(0,_pvutils.getParametersValue)(parameters,"trustedCerts",this.defaultValues("trustedCerts"));this.certs=(0,_pvutils.getParametersValue)(parameters,"certs",this.defaultValues("certs"));this.crls=(0,_pvutils.getParametersValue)(parameters,"crls",this.defaultValues("crls"));this.ocsps=(0,_pvutils.getParametersValue)(parameters,"ocsps",this.defaultValues("ocsps"));this.checkDate=(0,_pvutils.getParametersValue)(parameters,"checkDate",this.defaultValues("checkDate"));this.findOrigin=(0,_pvutils.getParametersValue)(parameters,"findOrigin",this.defaultValues("findOrigin"));this.findIssuer=(0,_pvutils.getParametersValue)(parameters,"findIssuer",this.defaultValues("findIssuer"))}_createClass(CertificateChainValidationEngine,[{key:"defaultFindIssuer",value:function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(certificate,validationEngine){var result,keyIdentifier,authorityCertIssuer,authorityCertSerialNumber,verificationResult,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,extension,checkCertificate,_iteratorNormalCompletion3,_didIteratorError3,_iteratorError3,_iterator3,_step3,trustedCert,_iteratorNormalCompletion4,_didIteratorError4,_iteratorError4,_iterator4,_step4,intermediateCert,i,_verificationResult;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:checkCertificate=function checkCertificate(possibleIssuer){if(keyIdentifier!==null){if("extensions"in possibleIssuer){var extensionFound=false;var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=possibleIssuer.extensions[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var _extension=_step2.value;if(_extension.extnID==="2.5.29.14"){extensionFound=true;if((0,_pvutils.isEqualBuffer)(_extension.parsedValue.valueBlock.valueHex,keyIdentifier.valueBlock.valueHex))result.push(possibleIssuer);break}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}if(extensionFound)return}}var authorityCertSerialNumberEqual=false;if(authorityCertSerialNumber!==null)authorityCertSerialNumberEqual=possibleIssuer.serialNumber.isEqual(authorityCertSerialNumber);if(authorityCertIssuer!==null){if(possibleIssuer.subject.isEqual(authorityCertIssuer)){if(authorityCertSerialNumberEqual)result.push(possibleIssuer)}}else{if(certificate.issuer.isEqual(possibleIssuer.subject))result.push(possibleIssuer)}};result=[];keyIdentifier=null;authorityCertIssuer=null;authorityCertSerialNumber=null;if(!certificate.subject.isEqual(certificate.issuer)){_context.next=16;break}_context.prev=6;_context.next=9;return certificate.verify();case 9:verificationResult=_context.sent;if(!(verificationResult===true)){_context.next=12;break}return _context.abrupt("return",[certificate]);case 12:_context.next=16;break;case 14:_context.prev=14;_context.t0=_context["catch"](6);case 16:if(!("extensions"in certificate)){_context.next=44;break}_iteratorNormalCompletion=true;_didIteratorError=false;_iteratorError=undefined;_context.prev=20;_iterator=certificate.extensions[Symbol.iterator]();case 22:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context.next=30;break}extension=_step.value;if(!(extension.extnID==="2.5.29.35")){_context.next=27;break}if("keyIdentifier"in extension.parsedValue)keyIdentifier=extension.parsedValue.keyIdentifier;else{if("authorityCertIssuer"in extension.parsedValue)authorityCertIssuer=extension.parsedValue.authorityCertIssuer;if("authorityCertSerialNumber"in extension.parsedValue)authorityCertSerialNumber=extension.parsedValue.authorityCertSerialNumber}return _context.abrupt("break",30);case 27:_iteratorNormalCompletion=true;_context.next=22;break;case 30:_context.next=36;break;case 32:_context.prev=32;_context.t1=_context["catch"](20);_didIteratorError=true;_iteratorError=_context.t1;case 36:_context.prev=36;_context.prev=37;if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}case 39:_context.prev=39;if(!_didIteratorError){_context.next=42;break}throw _iteratorError;case 42:return _context.finish(39);case 43:return _context.finish(36);case 44:_iteratorNormalCompletion3=true;_didIteratorError3=false;_iteratorError3=undefined;_context.prev=47;for(_iterator3=validationEngine.trustedCerts[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){trustedCert=_step3.value;checkCertificate(trustedCert)}_context.next=55;break;case 51:_context.prev=51;_context.t2=_context["catch"](47);_didIteratorError3=true;_iteratorError3=_context.t2;case 55:_context.prev=55;_context.prev=56;if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}case 58:_context.prev=58;if(!_didIteratorError3){_context.next=61;break}throw _iteratorError3;case 61:return _context.finish(58);case 62:return _context.finish(55);case 63:_iteratorNormalCompletion4=true;_didIteratorError4=false;_iteratorError4=undefined;_context.prev=66;for(_iterator4=validationEngine.certs[Symbol.iterator]();!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){intermediateCert=_step4.value;checkCertificate(intermediateCert)}_context.next=74;break;case 70:_context.prev=70;_context.t3=_context["catch"](66);_didIteratorError4=true;_iteratorError4=_context.t3;case 74:_context.prev=74;_context.prev=75;if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}case 77:_context.prev=77;if(!_didIteratorError4){_context.next=80;break}throw _iteratorError4;case 80:return _context.finish(77);case 81:return _context.finish(74);case 82:i=0;case 83:if(!(i<result.length)){_context.next=97;break}_context.prev=84;_context.next=87;return certificate.verify(result[i]);case 87:_verificationResult=_context.sent;if(_verificationResult===false)result.splice(i,1);_context.next=94;break;case 91:_context.prev=91;_context.t4=_context["catch"](84);result.splice(i,1);case 94:i++;_context.next=83;break;case 97:return _context.abrupt("return",result);case 98:case"end":return _context.stop()}}},_callee,this,[[6,14],[20,32,36,44],[37,,39,43],[47,51,55,63],[56,,58,62],[66,70,74,82],[75,,77,81],[84,91]])}));function defaultFindIssuer(_x2,_x3){return _ref.apply(this,arguments)}return defaultFindIssuer}()},{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"trustedCerts":return[];case"certs":return[];case"crls":return[];case"ocsps":return[];case"checkDate":return new Date;case"findOrigin":return CertificateChainValidationEngine.defaultFindOrigin;case"findIssuer":return this.defaultFindIssuer;default:throw new Error("Invalid member name for CertificateChainValidationEngine class: "+memberName)}}},{key:"sort",value:function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee7(){var buildPath=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(certificate){var result,checkUnique,findIssuerResult,i,buildPathResult,j,copy;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:checkUnique=function checkUnique(array){var unique=true;for(var i=0;i<array.length;i++){for(var j=0;j<array.length;j++){if(j===i)continue;if(array[i]===array[j]){unique=false;break}}if(!unique)break}return unique};result=[];_context2.next=4;return _this.findIssuer(certificate,_this);case 4:findIssuerResult=_context2.sent;if(!(findIssuerResult.length===0)){_context2.next=7;break}throw new Error("No valid certificate paths found");case 7:i=0;case 8:if(!(i<findIssuerResult.length)){_context2.next=19;break}if(!(0,_pvutils.isEqualBuffer)(findIssuerResult[i].tbs,certificate.tbs)){_context2.next=12;break}result.push([findIssuerResult[i]]);return _context2.abrupt("continue",16);case 12:_context2.next=14;return buildPath(findIssuerResult[i]);case 14:buildPathResult=_context2.sent;for(j=0;j<buildPathResult.length;j++){copy=buildPathResult[j].slice();copy.splice(0,0,findIssuerResult[i]);if(checkUnique(copy))result.push(copy);else result.push(buildPathResult[j])}case 16:i++;_context2.next=8;break;case 19:return _context2.abrupt("return",result);case 20:case"end":return _context2.stop()}}},_callee2,this)}));return function buildPath(_x4){return _ref3.apply(this,arguments)}}();var findCRL=function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(certificate){var issuerCertificates,crls,crlsAndCertificates,i,j,_result;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:issuerCertificates=[];crls=[];crlsAndCertificates=[];issuerCertificates.push.apply(issuerCertificates,_toConsumableArray(localCerts.filter(function(element){return certificate.issuer.isEqual(element.subject)})));if(!(issuerCertificates.length===0)){_context3.next=6;break}return _context3.abrupt("return",{status:1,statusMessage:"No certificate's issuers"});case 6:crls.push.apply(crls,_toConsumableArray(_this.crls.filter(function(element){return element.issuer.isEqual(certificate.issuer)})));if(!(crls.length===0)){_context3.next=9;break}return _context3.abrupt("return",{status:1,statusMessage:"No CRLs for specific certificate issuer"});case 9:i=0;case 10:if(!(i<crls.length)){_context3.next=32;break}if(!(crls[i].nextUpdate.value<_this.checkDate)){_context3.next=13;break}return _context3.abrupt("continue",29);case 13:j=0;case 14:if(!(j<issuerCertificates.length)){_context3.next=29;break}_context3.prev=15;_context3.next=18;return crls[i].verify({issuerCertificate:issuerCertificates[j]});case 18:_result=_context3.sent;if(!_result){_context3.next=22;break}crlsAndCertificates.push({crl:crls[i],certificate:issuerCertificates[j]});return _context3.abrupt("break",29);case 22:_context3.next=26;break;case 24:_context3.prev=24;_context3.t0=_context3["catch"](15);case 26:j++;_context3.next=14;break;case 29:i++;_context3.next=10;break;case 32:if(!crlsAndCertificates.length){_context3.next=34;break}return _context3.abrupt("return",{status:0,statusMessage:"",result:crlsAndCertificates});case 34:return _context3.abrupt("return",{status:1,statusMessage:"No valid CRLs found"});case 35:case"end":return _context3.stop()}}},_callee3,this,[[15,24]])}));return function findCRL(_x5){return _ref4.apply(this,arguments)}}();var findOCSP=function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(certificate,issuerCertificate){var hashAlgorithm,i,_result2;return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:hashAlgorithm=(0,_common.getAlgorithmByOID)(certificate.signatureAlgorithm.algorithmId);if(!("name"in hashAlgorithm===false)){_context4.next=3;break}return _context4.abrupt("return",1);case 3:if(!("hash"in hashAlgorithm===false)){_context4.next=5;break}return _context4.abrupt("return",1);case 5:i=0;case 6:if(!(i<_this.ocsps.length)){_context4.next=17;break}_context4.next=9;return _this.ocsps[i].getCertificateStatus(certificate,issuerCertificate);case 9:_result2=_context4.sent;if(!_result2.isForCertificate){_context4.next=14;break}if(!(_result2.status===0)){_context4.next=13;break}return _context4.abrupt("return",0);case 13:return _context4.abrupt("return",1);case 14:i++;_context4.next=6;break;case 17:return _context4.abrupt("return",2);case 18:case"end":return _context4.stop()}}},_callee4,this)}));return function findOCSP(_x6,_x7){return _ref5.apply(this,arguments)}}();var checkForCA=function(){var _ref6=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(certificate){var needToCheckCRL=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var isCA,mustBeCA,keyUsagePresent,cRLSign,j,view;return regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:isCA=false;mustBeCA=false;keyUsagePresent=false;cRLSign=false;if(!("extensions"in certificate)){_context5.next=20;break}j=0;case 6:if(!(j<certificate.extensions.length)){_context5.next=14;break}if(!(certificate.extensions[j].critical===true&&"parsedValue"in certificate.extensions[j]===false)){_context5.next=9;break}return _context5.abrupt("return",{result:false,resultCode:6,resultMessage:"Unable to parse critical certificate extension: "+certificate.extensions[j].extnID});case 9:if(certificate.extensions[j].extnID==="2.5.29.15"){keyUsagePresent=true;view=new Uint8Array(certificate.extensions[j].parsedValue.valueBlock.valueHex);if((view[0]&4)===4)mustBeCA=true;if((view[0]&2)===2)cRLSign=true}if(certificate.extensions[j].extnID==="2.5.29.19"){if("cA"in certificate.extensions[j].parsedValue){if(certificate.extensions[j].parsedValue.cA===true)isCA=true}}case 11:j++;_context5.next=6;break;case 14:if(!(mustBeCA===true&&isCA===false)){_context5.next=16;break}return _context5.abrupt("return",{result:false,resultCode:3,resultMessage:'Unable to build certificate chain - using "keyCertSign" flag set without BasicConstaints'});case 16:if(!(keyUsagePresent===true&&isCA===true&&mustBeCA===false)){_context5.next=18;break}return _context5.abrupt("return",{result:false,resultCode:4,resultMessage:'Unable to build certificate chain - "keyCertSign" flag was not set'});case 18:if(!(isCA===true&&keyUsagePresent===true&&needToCheckCRL&&cRLSign===false)){_context5.next=20;break}return _context5.abrupt("return",{result:false,resultCode:5,resultMessage:'Unable to build certificate chain - intermediate certificate must have "cRLSign" key usage flag'});case 20:if(!(isCA===false)){_context5.next=22;break}return _context5.abrupt("return",{result:false,resultCode:7,resultMessage:"Unable to build certificate chain - more than one possible end-user certificate"});case 22:return _context5.abrupt("return",{result:true,resultCode:0,resultMessage:""});case 23:case"end":return _context5.stop()}}},_callee5,this)}));return function checkForCA(_x9){return _ref6.apply(this,arguments)}}();var basicCheck=function(){var _ref7=_asyncToGenerator(regeneratorRuntime.mark(function _callee6(path,checkDate){var i,_i,_i2,ocspResult,crlResult,j,isCertificateRevoked,isCertificateCA,_i3,_result3;return regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:i=0;case 1:if(!(i<path.length)){_context6.next=7;break}if(!(path[i].notBefore.value>checkDate||path[i].notAfter.value<checkDate)){_context6.next=4;break}return _context6.abrupt("return",{result:false,resultCode:8,resultMessage:"The certificate is either not yet valid or expired"});case 4:i++;_context6.next=1;break;case 7:if(!(path.length<2)){_context6.next=9;break}return _context6.abrupt("return",{result:false,resultCode:9,resultMessage:"Too short certificate path"});case 9:_i=path.length-2;case 10:if(!(_i>=0)){_context6.next=17;break}if(!(path[_i].issuer.isEqual(path[_i].subject)===false)){_context6.next=14;break}if(!(path[_i].issuer.isEqual(path[_i+1].subject)===false)){_context6.next=14;break}return _context6.abrupt("return",{result:false,resultCode:10,resultMessage:"Incorrect name chaining"});case 14:_i--;_context6.next=10;break;case 17:if(!(_this.crls.length!==0||_this.ocsps.length!==0)){_context6.next=58;break}_i2=0;case 19:if(!(_i2<path.length-2)){_context6.next=58;break}ocspResult=void 0;crlResult=void 0;if(!(_this.ocsps.length!==0)){_context6.next=32;break}_context6.next=25;return findOCSP(path[_i2],path[_i2+1]);case 25:ocspResult=_context6.sent;_context6.t0=ocspResult;_context6.next=_context6.t0===0?29:_context6.t0===1?30:_context6.t0===2?31:32;break;case 29:return _context6.abrupt("continue",55);case 30:return _context6.abrupt("return",{result:false,resultCode:12,resultMessage:"One of certificates was revoked via OCSP response"});case 31:return _context6.abrupt("break",32);case 32:if(!(_this.crls.length!==0)){_context6.next=53;break}_context6.next=35;return findCRL(path[_i2]);case 35:crlResult=_context6.sent;if(!crlResult.status){_context6.next=38;break}throw{result:false,resultCode:11,resultMessage:"No revocation values found for one of certificates: "+crlResult.statusMessage};case 38:j=0;case 39:if(!(j<crlResult.result.length)){_context6.next=51;break}isCertificateRevoked=crlResult.result[j].crl.isCertificateRevoked(path[_i2]);if(!isCertificateRevoked){_context6.next=43;break}return _context6.abrupt("return",{result:false,resultCode:12,resultMessage:"One of certificates had been revoked"});case 43:_context6.next=45;return checkForCA(crlResult.result[j].certificate,true);case 45:isCertificateCA=_context6.sent;if(!(isCertificateCA.result===false)){_context6.next=48;break}return _context6.abrupt("return",{result:false,resultCode:13,resultMessage:"CRL issuer certificate is not a CA certificate or does not have crlSign flag"});case 48:j++;_context6.next=39;break;case 51:_context6.next=55;break;case 53:if(!(ocspResult===2)){_context6.next=55;break}return _context6.abrupt("return",{result:false,resultCode:11,resultMessage:"No revocation values found for one of certificates"});case 55:_i2++;_context6.next=19;break;case 58:_i3=1;case 59:if(!(_i3<path.length)){_context6.next=68;break}_context6.next=62;return checkForCA(path[_i3]);case 62:_result3=_context6.sent;if(!(_result3.result===false)){_context6.next=65;break}return _context6.abrupt("return",{result:false,resultCode:14,resultMessage:"One of intermediate certificates is not a CA certificate"});case 65:_i3++;_context6.next=59;break;case 68:return _context6.abrupt("return",{result:true});case 69:case"end":return _context6.stop()}}},_callee6,this)}));return function basicCheck(_x10,_x11){return _ref7.apply(this,arguments)}}();var localCerts,_this,i,j,result,certificatePath,_i4,found,_j,_certificate,k,shortestLength,shortestIndex,_i5,_i6;return regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:localCerts=[];_this=this;localCerts.push.apply(localCerts,_toConsumableArray(_this.trustedCerts));localCerts.push.apply(localCerts,_toConsumableArray(_this.certs));i=0;case 5:if(!(i<localCerts.length)){_context7.next=20;break}j=0;case 7:if(!(j<localCerts.length)){_context7.next=17;break}if(!(i===j)){_context7.next=10;break}return _context7.abrupt("continue",14);case 10:if(!(0,_pvutils.isEqualBuffer)(localCerts[i].tbs,localCerts[j].tbs)){_context7.next=14;break}localCerts.splice(j,1);i=0;return _context7.abrupt("break",17);case 14:j++;_context7.next=7;break;case 17:i++;_context7.next=5;break;case 20:result=void 0;certificatePath=[localCerts[localCerts.length-1]];_context7.next=24;return buildPath(localCerts[localCerts.length-1]);case 24:result=_context7.sent;if(!(result.length===0)){_context7.next=27;break}return _context7.abrupt("return",{result:false,resultCode:60,resultMessage:"Unable to find certificate path"});case 27:_i4=0;case 28:if(!(_i4<result.length)){_context7.next=50;break}found=false;_j=0;case 31:if(!(_j<result[_i4].length)){_context7.next=46;break}_certificate=result[_i4][_j];k=0;case 34:if(!(k<_this.trustedCerts.length)){_context7.next=41;break}if(!(0,_pvutils.isEqualBuffer)(_certificate.tbs,_this.trustedCerts[k].tbs)){_context7.next=38;break}found=true;return _context7.abrupt("break",41);case 38:k++;_context7.next=34;break;case 41:if(!found){_context7.next=43;break}return _context7.abrupt("break",46);case 43:_j++;_context7.next=31;break;case 46:if(!found){result.splice(_i4,1);_i4=0}case 47:_i4++;_context7.next=28;break;case 50:if(!(result.length===0)){_context7.next=52;break}throw{result:false,resultCode:97,resultMessage:"No valid certificate paths found"};case 52:shortestLength=result[0].length;shortestIndex=0;for(_i5=0;_i5<result.length;_i5++){if(result[_i5].length<shortestLength){shortestLength=result[_i5].length;shortestIndex=_i5}}for(_i6=0;_i6<result[shortestIndex].length;_i6++){certificatePath.push(result[shortestIndex][_i6])}_context7.next=58;return basicCheck(certificatePath,_this.checkDate);case 58:result=_context7.sent;if(!(result.result===false)){_context7.next=61;break}throw result;case 61:return _context7.abrupt("return",certificatePath);case 62:case"end":return _context7.stop()}}},_callee7,this)}));function sort(){return _ref2.apply(this,arguments)}return sort}()},{key:"verify",value:function(){var _ref8=_asyncToGenerator(regeneratorRuntime.mark(function _callee8(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var compareDNSName,compareRFC822Name,compareUniformResourceIdentifier,compareIPAddress,compareDirectoryName,initialPolicySet,initialExplicitPolicy,initialPolicyMappingInhibit,initialInhibitPolicy,initialPermittedSubtreesSet,initialExcludedSubtreesSet,initialRequiredNameForms,explicitPolicyIndicator,policyMappingInhibitIndicator,inhibitAnyPolicyIndicator,pendingConstraints,explicitPolicyPending,policyMappingInhibitPending,inhibitAnyPolicyPending,permittedSubtrees,excludedSubtrees,requiredNameForms,pathDepth,allPolicies,policiesAndCerts,anyPolicyArray,ii,policyMappings,certPolicies,explicitPolicyStart,i,j,s,k,policyIndex,_s,certArray,_policyIndex,searchAnyPolicy,_i10,_k,issuerDomainPolicyIndex,subjectDomainPolicyIndex,n,_j2,m,_i11,_j3,authConstrPolicies,_i12,found,_j4,anyPolicyFound,_k2,userConstrPolicies,_i13,_j5,policyResult,_i14,subjectAltNames,certPermittedSubtrees,certExcludedSubtrees,_j6,formFound,_j7,_k3,constrGroups,_j8,p,groupPermitted,valueExists,group,_j9,_k4,_k5,_k6,_k7,_k8,excluded,_j10,_k9,_k10,_k11,_k12,_k13;return regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:compareDirectoryName=function compareDirectoryName(name,constraint){if(name.typesAndValues.length===0||constraint.typesAndValues.length===0)return true;if(name.typesAndValues.length<constraint.typesAndValues.length)return false;var result=true;var nameStart=0;for(var i=0;i<constraint.typesAndValues.length;i++){var localResult=false;for(var j=nameStart;j<name.typesAndValues.length;j++){localResult=name.typesAndValues[j].isEqual(constraint.typesAndValues[i]);if(name.typesAndValues[j].type===constraint.typesAndValues[i].type)result=result&&localResult;if(localResult===true){if(nameStart===0||nameStart===j){nameStart=j+1;break}else return false}}if(localResult===false)return false}return nameStart===0?false:result};compareIPAddress=function compareIPAddress(name,constraint){var nameView=new Uint8Array(name.valueBlock.valueHex);var constraintView=new Uint8Array(constraint.valueBlock.valueHex);if(nameView.length===4&&constraintView.length===8){for(var i=0;i<4;i++){if((nameView[i]^constraintView[i])&constraintView[i+4])return false}return true}if(nameView.length===16&&constraintView.length===32){for(var _i9=0;_i9<16;_i9++){if((nameView[_i9]^constraintView[_i9])&constraintView[_i9+16])return false}return true}return false};compareUniformResourceIdentifier=function compareUniformResourceIdentifier(name,constraint){var namePrepared=(0,_common.stringPrep)(name);var constraintPrepared=(0,_common.stringPrep)(constraint);var ns=namePrepared.split("/");var cs=constraintPrepared.split("/");if(cs.length>1)return false;if(ns.length>1){for(var i=0;i<ns.length;i++){if(ns[i].length>0&&ns[i].charAt(ns[i].length-1)!==":"){var nsPort=ns[i].split(":");namePrepared=nsPort[0];break}}}var result=compareDNSName(namePrepared,constraintPrepared);if(result){var nameSplitted=namePrepared.split(".");var constraintSplitted=constraintPrepared.split(".");if(constraintSplitted[0].length===0)return true;return nameSplitted.length===constraintSplitted.length}return false};compareRFC822Name=function compareRFC822Name(name,constraint){var namePrepared=(0,_common.stringPrep)(name);var constraintPrepared=(0,_common.stringPrep)(constraint);var nameSplitted=namePrepared.split("@");var constraintSplitted=constraintPrepared.split("@");if(nameSplitted.length===0||constraintSplitted.length===0||nameSplitted.length<constraintSplitted.length)return false;if(constraintSplitted.length===1){var _result4=compareDNSName(nameSplitted[1],constraintSplitted[0]);if(_result4){var ns=nameSplitted[1].split(".");var cs=constraintSplitted[0].split(".");if(cs[0].length===0)return true;return ns.length===cs.length}return false}return namePrepared.localeCompare(constraintPrepared)===0};compareDNSName=function compareDNSName(name,constraint){var namePrepared=(0,_common.stringPrep)(name);var constraintPrepared=(0,_common.stringPrep)(constraint);var nameSplitted=namePrepared.split(".");var constraintSplitted=constraintPrepared.split(".");var nameLen=nameSplitted.length;var constrLen=constraintSplitted.length;if(nameLen===0||constrLen===0||nameLen<constrLen)return false;for(var i=0;i<nameLen;i++){if(nameSplitted[i].length===0)return false}for(var _i7=0;_i7<constrLen;_i7++){if(constraintSplitted[_i7].length===0){if(_i7===0){if(constrLen===1)return false;continue}return false}}for(var _i8=0;_i8<constrLen;_i8++){if(constraintSplitted[constrLen-1-_i8].length===0)continue;if(nameSplitted[nameLen-1-_i8].localeCompare(constraintSplitted[constrLen-1-_i8])!==0)return false}return true};_context8.prev=5;if(!(this.certs.length===0)){_context8.next=8;break}throw"Empty certificate array";case 8:initialPolicySet=[];initialPolicySet.push("2.5.29.32.0");initialExplicitPolicy=false;initialPolicyMappingInhibit=false;initialInhibitPolicy=false;initialPermittedSubtreesSet=[];initialExcludedSubtreesSet=[];initialRequiredNameForms=[];if("initialPolicySet"in parameters)initialPolicySet=parameters.initialPolicySet;if("initialExplicitPolicy"in parameters)initialExplicitPolicy=parameters.initialExplicitPolicy;if("initialPolicyMappingInhibit"in parameters)initialPolicyMappingInhibit=parameters.initialPolicyMappingInhibit;if("initialInhibitPolicy"in parameters)initialInhibitPolicy=parameters.initialInhibitPolicy;if("initialPermittedSubtreesSet"in parameters)initialPermittedSubtreesSet=parameters.initialPermittedSubtreesSet;if("initialExcludedSubtreesSet"in parameters)initialExcludedSubtreesSet=parameters.initialExcludedSubtreesSet;if("initialRequiredNameForms"in parameters)initialRequiredNameForms=parameters.initialRequiredNameForms;explicitPolicyIndicator=initialExplicitPolicy;policyMappingInhibitIndicator=initialPolicyMappingInhibit;inhibitAnyPolicyIndicator=initialInhibitPolicy;pendingConstraints=new Array(3);pendingConstraints[0]=false;pendingConstraints[1]=false;pendingConstraints[2]=false;explicitPolicyPending=0;policyMappingInhibitPending=0;inhibitAnyPolicyPending=0;permittedSubtrees=initialPermittedSubtreesSet;excludedSubtrees=initialExcludedSubtreesSet;requiredNameForms=initialRequiredNameForms;pathDepth=1;_context8.next=39;return this.sort();case 39:this.certs=_context8.sent;allPolicies=[];allPolicies.push("2.5.29.32.0");policiesAndCerts=[];anyPolicyArray=new Array(this.certs.length-1);for(ii=0;ii<this.certs.length-1;ii++){anyPolicyArray[ii]=true}policiesAndCerts.push(anyPolicyArray);policyMappings=new Array(this.certs.length-1);certPolicies=new Array(this.certs.length-1);explicitPolicyStart=explicitPolicyIndicator?this.certs.length-1:-1;i=this.certs.length-2;case 50:if(!(i>=0)){_context8.next=105;break}if(!("extensions"in this.certs[i])){_context8.next=102;break}j=0;case 53:if(!(j<this.certs[i].extensions.length)){_context8.next=88;break}if(!(this.certs[i].extensions[j].extnID==="2.5.29.32")){_context8.next=79;break}certPolicies[i]=this.certs[i].extensions[j].parsedValue;s=0;case 57:if(!(s<allPolicies.length)){_context8.next=64;break}if(!(allPolicies[s]==="2.5.29.32.0")){_context8.next=61;break}delete policiesAndCerts[s][i];return _context8.abrupt("break",64);case 61:s++;_context8.next=57;break;case 64:k=0;case 65:if(!(k<this.certs[i].extensions[j].parsedValue.certificatePolicies.length)){_context8.next=79;break}policyIndex=-1;_s=0;case 68:if(!(_s<allPolicies.length)){_context8.next=75;break}if(!(this.certs[i].extensions[j].parsedValue.certificatePolicies[k].policyIdentifier===allPolicies[_s])){_context8.next=72;break}policyIndex=_s;return _context8.abrupt("break",75);case 72:_s++;_context8.next=68;break;case 75:if(policyIndex===-1){allPolicies.push(this.certs[i].extensions[j].parsedValue.certificatePolicies[k].policyIdentifier);certArray=new Array(this.certs.length-1);certArray[i]=true;policiesAndCerts.push(certArray)}else policiesAndCerts[policyIndex][i]=true;case 76:k++;_context8.next=65;break;case 79:if(!(this.certs[i].extensions[j].extnID==="2.5.29.33")){_context8.next=83;break}if(!policyMappingInhibitIndicator){_context8.next=82;break}return _context8.abrupt("return",{result:false,resultCode:98,resultMessage:"Policy mapping prohibited"});case 82:policyMappings[i]=this.certs[i].extensions[j].parsedValue;case 83:if(this.certs[i].extensions[j].extnID==="2.5.29.36"){if(explicitPolicyIndicator===false){if(this.certs[i].extensions[j].parsedValue.requireExplicitPolicy===0){explicitPolicyIndicator=true;explicitPolicyStart=i}else{if(pendingConstraints[0]===false){pendingConstraints[0]=true;explicitPolicyPending=this.certs[i].extensions[j].parsedValue.requireExplicitPolicy}else explicitPolicyPending=explicitPolicyPending>this.certs[i].extensions[j].parsedValue.requireExplicitPolicy?this.certs[i].extensions[j].parsedValue.requireExplicitPolicy:explicitPolicyPending}if(this.certs[i].extensions[j].parsedValue.inhibitPolicyMapping===0)policyMappingInhibitIndicator=true;else{if(pendingConstraints[1]===false){pendingConstraints[1]=true;policyMappingInhibitPending=this.certs[i].extensions[j].parsedValue.inhibitPolicyMapping+1}else policyMappingInhibitPending=policyMappingInhibitPending>this.certs[i].extensions[j].parsedValue.inhibitPolicyMapping+1?this.certs[i].extensions[j].parsedValue.inhibitPolicyMapping+1:policyMappingInhibitPending}}}if(this.certs[i].extensions[j].extnID==="2.5.29.54"){if(inhibitAnyPolicyIndicator===false){if(this.certs[i].extensions[j].parsedValue.valueBlock.valueDec===0)inhibitAnyPolicyIndicator=true;else{if(pendingConstraints[2]===false){pendingConstraints[2]=true;inhibitAnyPolicyPending=this.certs[i].extensions[j].parsedValue.valueBlock.valueDec}else inhibitAnyPolicyPending=inhibitAnyPolicyPending>this.certs[i].extensions[j].parsedValue.valueBlock.valueDec?this.certs[i].extensions[j].parsedValue.valueBlock.valueDec:inhibitAnyPolicyPending}}}case 85:j++;_context8.next=53;break;case 88:if(!(inhibitAnyPolicyIndicator===true)){_context8.next=99;break}_policyIndex=-1;searchAnyPolicy=0;case 91:if(!(searchAnyPolicy<allPolicies.length)){_context8.next=98;break}if(!(allPolicies[searchAnyPolicy]==="2.5.29.32.0")){_context8.next=95;break}_policyIndex=searchAnyPolicy;return _context8.abrupt("break",98);case 95:searchAnyPolicy++;_context8.next=91;break;case 98:if(_policyIndex!==-1)delete policiesAndCerts[0][i];case 99:if(explicitPolicyIndicator===false){if(pendingConstraints[0]===true){explicitPolicyPending--;if(explicitPolicyPending===0){explicitPolicyIndicator=true;explicitPolicyStart=i;pendingConstraints[0]=false}}}if(policyMappingInhibitIndicator===false){if(pendingConstraints[1]===true){policyMappingInhibitPending--;if(policyMappingInhibitPending===0){policyMappingInhibitIndicator=true;pendingConstraints[1]=false}}}if(inhibitAnyPolicyIndicator===false){if(pendingConstraints[2]===true){inhibitAnyPolicyPending--;if(inhibitAnyPolicyPending===0){inhibitAnyPolicyIndicator=true;pendingConstraints[2]=false}}}case 102:i--,pathDepth++;_context8.next=50;break;case 105:_i10=0;case 106:if(!(_i10<this.certs.length-1)){_context8.next=123;break}if(!(_i10<this.certs.length-2&&typeof policyMappings[_i10+1]!=="undefined")){_context8.next=120;break}_k=0;case 109:if(!(_k<policyMappings[_i10+1].mappings.length)){_context8.next=120;break}if(!(policyMappings[_i10+1].mappings[_k].issuerDomainPolicy==="2.5.29.32.0"||policyMappings[_i10+1].mappings[_k].subjectDomainPolicy==="2.5.29.32.0")){_context8.next=112;break}return _context8.abrupt("return",{result:false,resultCode:99,resultMessage:'The "anyPolicy" should not be a part of policy mapping scheme'});case 112:issuerDomainPolicyIndex=-1;subjectDomainPolicyIndex=-1;for(n=0;n<allPolicies.length;n++){if(allPolicies[n]===policyMappings[_i10+1].mappings[_k].issuerDomainPolicy)issuerDomainPolicyIndex=n;if(allPolicies[n]===policyMappings[_i10+1].mappings[_k].subjectDomainPolicy)subjectDomainPolicyIndex=n}if(typeof policiesAndCerts[issuerDomainPolicyIndex][_i10]!=="undefined")delete policiesAndCerts[issuerDomainPolicyIndex][_i10];for(_j2=0;_j2<certPolicies[_i10].certificatePolicies.length;_j2++){if(policyMappings[_i10+1].mappings[_k].subjectDomainPolicy===certPolicies[_i10].certificatePolicies[_j2].policyIdentifier){if(issuerDomainPolicyIndex!==-1&&subjectDomainPolicyIndex!==-1){for(m=0;m<=_i10;m++){if(typeof policiesAndCerts[subjectDomainPolicyIndex][m]!=="undefined"){policiesAndCerts[issuerDomainPolicyIndex][m]=true;delete policiesAndCerts[subjectDomainPolicyIndex][m]}}}}}case 117:_k++;_context8.next=109;break;case 120:_i10++;_context8.next=106;break;case 123:for(_i11=0;_i11<allPolicies.length;_i11++){if(allPolicies[_i11]==="2.5.29.32.0"){for(_j3=0;_j3<explicitPolicyStart;_j3++){delete policiesAndCerts[_i11][_j3]}}}authConstrPolicies=[];_i12=0;case 126:if(!(_i12<policiesAndCerts.length)){_context8.next=154;break}found=true;_j4=0;case 129:if(!(_j4<this.certs.length-1)){_context8.next=150;break}anyPolicyFound=false;if(!(_j4<explicitPolicyStart&&allPolicies[_i12]==="2.5.29.32.0"&&allPolicies.length>1)){_context8.next=134;break}found=false;return _context8.abrupt("break",150);case 134:if(!(typeof policiesAndCerts[_i12][_j4]==="undefined")){_context8.next=147;break}if(!(_j4>=explicitPolicyStart)){_context8.next=144;break}_k2=0;case 137:if(!(_k2<allPolicies.length)){_context8.next=144;break}if(!(allPolicies[_k2]==="2.5.29.32.0")){_context8.next=141;break}if(policiesAndCerts[_k2][_j4]===true)anyPolicyFound=true;return _context8.abrupt("break",144);case 141:_k2++;_context8.next=137;break;case 144:if(anyPolicyFound){_context8.next=147;break}found=false;return _context8.abrupt("break",150);case 147:_j4++;_context8.next=129;break;case 150:if(found===true)authConstrPolicies.push(allPolicies[_i12]);case 151:_i12++;_context8.next=126;break;case 154:userConstrPolicies=[];if(!(initialPolicySet.length===1&&initialPolicySet[0]==="2.5.29.32.0"&&explicitPolicyIndicator===false)){_context8.next=159;break}userConstrPolicies=initialPolicySet;_context8.next=176;break;case 159:if(!(authConstrPolicies.length===1&&authConstrPolicies[0]==="2.5.29.32.0")){_context8.next=163;break}userConstrPolicies=initialPolicySet;_context8.next=176;break;case 163:_i13=0;case 164:if(!(_i13<authConstrPolicies.length)){_context8.next=176;break}_j5=0;case 166:if(!(_j5<initialPolicySet.length)){_context8.next=173;break}if(!(initialPolicySet[_j5]===authConstrPolicies[_i13]||initialPolicySet[_j5]==="2.5.29.32.0")){_context8.next=170;break}userConstrPolicies.push(authConstrPolicies[_i13]);return _context8.abrupt("break",173);case 170:_j5++;_context8.next=166;break;case 173:_i13++;_context8.next=164;break;case 176:policyResult={result:userConstrPolicies.length>0,resultCode:0,resultMessage:userConstrPolicies.length>0?"":'Zero "userConstrPolicies" array, no intersections with "authConstrPolicies"',authConstrPolicies:authConstrPolicies,userConstrPolicies:userConstrPolicies,explicitPolicyIndicator:explicitPolicyIndicator,policyMappings:policyMappings,certificatePath:this.certs};if(!(userConstrPolicies.length===0)){_context8.next=179;break}return _context8.abrupt("return",policyResult);case 179:if(!(policyResult.result===false)){_context8.next=181;break}return _context8.abrupt("return",policyResult);case 181:pathDepth=1;_i14=this.certs.length-2;case 183:if(!(_i14>=0)){_context8.next=305;break}subjectAltNames=[];certPermittedSubtrees=[];certExcludedSubtrees=[];if("extensions"in this.certs[_i14]){for(_j6=0;_j6<this.certs[_i14].extensions.length;_j6++){if(this.certs[_i14].extensions[_j6].extnID==="2.5.29.30"){if("permittedSubtrees"in this.certs[_i14].extensions[_j6].parsedValue)certPermittedSubtrees=certPermittedSubtrees.concat(this.certs[_i14].extensions[_j6].parsedValue.permittedSubtrees);if("excludedSubtrees"in this.certs[_i14].extensions[_j6].parsedValue)certExcludedSubtrees=certExcludedSubtrees.concat(this.certs[_i14].extensions[_j6].parsedValue.excludedSubtrees)}if(this.certs[_i14].extensions[_j6].extnID==="2.5.29.17")subjectAltNames=subjectAltNames.concat(this.certs[_i14].extensions[_j6].parsedValue.altNames)}}formFound=requiredNameForms.length<=0;_j7=0;case 190:if(!(_j7<requiredNameForms.length)){_context8.next=211;break}_context8.t0=requiredNameForms[_j7].base.type;_context8.next=_context8.t0===4?194:208;break;case 194:if(!(requiredNameForms[_j7].base.value.typesAndValues.length!==this.certs[_i14].subject.typesAndValues.length)){_context8.next=196;break}return _context8.abrupt("continue",208);case 196:formFound=true;_k3=0;case 198:if(!(_k3<this.certs[_i14].subject.typesAndValues.length)){_context8.next=205;break}if(!(this.certs[_i14].subject.typesAndValues[_k3].type!==requiredNameForms[_j7].base.value.typesAndValues[_k3].type)){_context8.next=202;break}formFound=false;return _context8.abrupt("break",205);case 202:_k3++;_context8.next=198;break;case 205:if(!(formFound===true)){_context8.next=207;break}return _context8.abrupt("break",208);case 207:return _context8.abrupt("break",208);case 208:_j7++;_context8.next=190;break;case 211:if(!(formFound===false)){_context8.next=216;break}policyResult.result=false;policyResult.resultCode=21;policyResult.resultMessage="No neccessary name form found";throw policyResult;case 216:constrGroups=[];constrGroups[0]=[];constrGroups[1]=[];constrGroups[2]=[];constrGroups[3]=[];constrGroups[4]=[];_j8=0;case 223:if(!(_j8<permittedSubtrees.length)){_context8.next=240;break}_context8.t1=permittedSubtrees[_j8].base.type;_context8.next=_context8.t1===1?227:_context8.t1===2?229:_context8.t1===4?231:_context8.t1===6?233:_context8.t1===7?235:237;break;case 227:constrGroups[0].push(permittedSubtrees[_j8]);return _context8.abrupt("break",237);case 229:constrGroups[1].push(permittedSubtrees[_j8]);return _context8.abrupt("break",237);case 231:constrGroups[2].push(permittedSubtrees[_j8]);return _context8.abrupt("break",237);case 233:constrGroups[3].push(permittedSubtrees[_j8]);return _context8.abrupt("break",237);case 235:constrGroups[4].push(permittedSubtrees[_j8]);return _context8.abrupt("break",237);case 237:_j8++;_context8.next=223;break;case 240:p=0;case 241:if(!(p<5)){_context8.next=274;break}groupPermitted=false;valueExists=false;group=constrGroups[p];_j9=0;case 246:if(!(_j9<group.length)){_context8.next=266;break}_context8.t2=p;_context8.next=_context8.t2===0?250:_context8.t2===1?252:_context8.t2===2?254:_context8.t2===3?257:_context8.t2===4?259:261;break;case 250:if(subjectAltNames.length>0){for(_k4=0;_k4<subjectAltNames.length;_k4++){if(subjectAltNames[_k4].type===1){valueExists=true;groupPermitted=groupPermitted||compareRFC822Name(subjectAltNames[_k4].value,group[_j9].base.value)}}}else{for(_k5=0;_k5<this.certs[_i14].subject.typesAndValues.length;_k5++){if(this.certs[_i14].subject.typesAndValues[_k5].type==="1.2.840.113549.1.9.1"||this.certs[_i14].subject.typesAndValues[_k5].type==="0.9.2342.19200300.100.1.3"){valueExists=true;groupPermitted=groupPermitted||compareRFC822Name(this.certs[_i14].subject.typesAndValues[_k5].value.valueBlock.value,group[_j9].base.value)}}}return _context8.abrupt("break",261);case 252:if(subjectAltNames.length>0){for(_k6=0;_k6<subjectAltNames.length;_k6++){if(subjectAltNames[_k6].type===2){valueExists=true;groupPermitted=groupPermitted||compareDNSName(subjectAltNames[_k6].value,group[_j9].base.value)}}}return _context8.abrupt("break",261);case 254:valueExists=true;groupPermitted=compareDirectoryName(this.certs[_i14].subject,group[_j9].base.value);return _context8.abrupt("break",261);case 257:if(subjectAltNames.length>0){for(_k7=0;_k7<subjectAltNames.length;_k7++){if(subjectAltNames[_k7].type===6){valueExists=true;groupPermitted=groupPermitted||compareUniformResourceIdentifier(subjectAltNames[_k7].value,group[_j9].base.value)}}}return _context8.abrupt("break",261);case 259:if(subjectAltNames.length>0){for(_k8=0;_k8<subjectAltNames.length;_k8++){if(subjectAltNames[_k8].type===7){valueExists=true;groupPermitted=groupPermitted||compareIPAddress(subjectAltNames[_k8].value,group[_j9].base.value)}}}return _context8.abrupt("break",261);case 261:if(!groupPermitted){_context8.next=263;break}return _context8.abrupt("break",266);case 263:_j9++;_context8.next=246;break;case 266:if(!(groupPermitted===false&&group.length>0&&valueExists)){_context8.next=271;break}policyResult.result=false;policyResult.resultCode=41;policyResult.resultMessage='Failed to meet "permitted sub-trees" name constraint';throw policyResult;case 271:p++;_context8.next=241;break;case 274:excluded=false;_j10=0;case 276:if(!(_j10<excludedSubtrees.length)){_context8.next=295;break}_context8.t3=excludedSubtrees[_j10].base.type;_context8.next=_context8.t3===1?280:_context8.t3===2?282:_context8.t3===4?284:_context8.t3===6?286:_context8.t3===7?288:290;break;case 280:if(subjectAltNames.length>=0){for(_k9=0;_k9<subjectAltNames.length;_k9++){if(subjectAltNames[_k9].type===1)excluded=excluded||compareRFC822Name(subjectAltNames[_k9].value,excludedSubtrees[_j10].base.value)}}else{for(_k10=0;_k10<this.certs[_i14].subject.typesAndValues.length;_k10++){if(this.certs[_i14].subject.typesAndValues[_k10].type==="1.2.840.113549.1.9.1"||this.certs[_i14].subject.typesAndValues[_k10].type==="0.9.2342.19200300.100.1.3")excluded=excluded||compareRFC822Name(this.certs[_i14].subject.typesAndValues[_k10].value.valueBlock.value,excludedSubtrees[_j10].base.value)}}return _context8.abrupt("break",290);case 282:if(subjectAltNames.length>0){for(_k11=0;_k11<subjectAltNames.length;_k11++){if(subjectAltNames[_k11].type===2)excluded=excluded||compareDNSName(subjectAltNames[_k11].value,excludedSubtrees[_j10].base.value)}}return _context8.abrupt("break",290);case 284:excluded=excluded||compareDirectoryName(this.certs[_i14].subject,excludedSubtrees[_j10].base.value);return _context8.abrupt("break",290);case 286:if(subjectAltNames.length>0){for(_k12=0;_k12<subjectAltNames.length;_k12++){if(subjectAltNames[_k12].type===6)excluded=excluded||compareUniformResourceIdentifier(subjectAltNames[_k12].value,excludedSubtrees[_j10].base.value)}}return _context8.abrupt("break",290);case 288:if(subjectAltNames.length>0){for(_k13=0;_k13<subjectAltNames.length;_k13++){if(subjectAltNames[_k13].type===7)excluded=excluded||compareIPAddress(subjectAltNames[_k13].value,excludedSubtrees[_j10].base.value)}}return _context8.abrupt("break",290);case 290:if(!excluded){_context8.next=292;break}return _context8.abrupt("break",295);case 292:_j10++;_context8.next=276;break;case 295:if(!(excluded===true)){_context8.next=300;break}policyResult.result=false;policyResult.resultCode=42;policyResult.resultMessage='Failed to meet "excluded sub-trees" name constraint';throw policyResult;case 300:permittedSubtrees=permittedSubtrees.concat(certPermittedSubtrees);excludedSubtrees=excludedSubtrees.concat(certExcludedSubtrees);case 302:_i14--,pathDepth++;_context8.next=183;break;case 305:return _context8.abrupt("return",policyResult);case 308:_context8.prev=308;_context8.t4=_context8["catch"](5);if(!(_context8.t4 instanceof Object)){_context8.next=315;break}if(!("resultMessage"in _context8.t4)){_context8.next=313;break}return _context8.abrupt("return",_context8.t4);case 313:if(!("message"in _context8.t4)){_context8.next=315;break}return _context8.abrupt("return",{result:false,resultCode:-1,resultMessage:_context8.t4.message});case 315:return _context8.abrupt("return",{result:false,resultCode:-1,resultMessage:_context8.t4});case 316:case"end":return _context8.stop()}}},_callee8,this,[[5,308]])}));function verify(){return _ref8.apply(this,arguments)}return verify}()}],[{key:"defaultFindOrigin",value:function defaultFindOrigin(certificate,validationEngine){if(certificate.tbs.byteLength===0)certificate.tbs=certificate.encodeTBS();var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=validationEngine.certs[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var localCert=_step5.value;if(localCert.tbs.byteLength===0)localCert.tbs=localCert.encodeTBS();if((0,_pvutils.isEqualBuffer)(certificate.tbs,localCert.tbs))return"Intermediate Certificates"}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally{try{if(!_iteratorNormalCompletion5&&_iterator5.return){_iterator5.return()}}finally{if(_didIteratorError5){throw _iteratorError5}}}var _iteratorNormalCompletion6=true;var _didIteratorError6=false;var _iteratorError6=undefined;try{for(var _iterator6=validationEngine.trustedCerts[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=true){var trustedCert=_step6.value;if(trustedCert.tbs.byteLength===0)trustedCert.tbs=trustedCert.encodeTBS();if((0,_pvutils.isEqualBuffer)(certificate.tbs,trustedCert.tbs))return"Trusted Certificates"}}catch(err){_didIteratorError6=true;_iteratorError6=err}finally{try{if(!_iteratorNormalCompletion6&&_iterator6.return){_iterator6.return()}}finally{if(_didIteratorError6){throw _iteratorError6}}}return"Unknown"}}]);return CertificateChainValidationEngine}();exports.default=CertificateChainValidationEngine},{"./common.js":105,pvutils:"pvutils","regenerator-runtime":106}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _PolicyInformation=require("./PolicyInformation.js");var _PolicyInformation2=_interopRequireDefault(_PolicyInformation);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CertificatePolicies=function(){function CertificatePolicies(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,CertificatePolicies);this.certificatePolicies=(0,_pvutils.getParametersValue)(parameters,"certificatePolicies",CertificatePolicies.defaultValues("certificatePolicies"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(CertificatePolicies,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,CertificatePolicies.schema({names:{certificatePolicies:"certificatePolicies"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CertificatePolicies");this.certificatePolicies=Array.from(asn1.result.certificatePolicies,function(element){return new _PolicyInformation2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:Array.from(this.certificatePolicies,function(element){return element.toSchema()})})}},{key:"toJSON",value:function toJSON(){return{certificatePolicies:Array.from(this.certificatePolicies,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"certificatePolicies":return[];default:throw new Error("Invalid member name for CertificatePolicies class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Repeated({name:names.certificatePolicies||"",value:_PolicyInformation2.default.schema()})]})}}]);return CertificatePolicies}();exports.default=CertificatePolicies},{"./PolicyInformation.js":69,asn1js:"asn1js",pvutils:"pvutils"}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _RelativeDistinguishedNames=require("./RelativeDistinguishedNames.js");var _RelativeDistinguishedNames2=_interopRequireDefault(_RelativeDistinguishedNames);var _Time=require("./Time.js");var _Time2=_interopRequireDefault(_Time);var _RevokedCertificate=require("./RevokedCertificate.js");var _RevokedCertificate2=_interopRequireDefault(_RevokedCertificate);var _Extensions=require("./Extensions.js");var _Extensions2=_interopRequireDefault(_Extensions);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function tbsCertList(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"tbsCertList",value:[new asn1js.Integer({optional:true,name:names.tbsCertListVersion||"tbsCertList.version",value:2}),_AlgorithmIdentifier2.default.schema(names.signature||{names:{blockName:"tbsCertList.signature"}}),_RelativeDistinguishedNames2.default.schema(names.issuer||{names:{blockName:"tbsCertList.issuer"}}),_Time2.default.schema(names.tbsCertListThisUpdate||{names:{utcTimeName:"tbsCertList.thisUpdate",generalTimeName:"tbsCertList.thisUpdate"}}),_Time2.default.schema(names.tbsCertListNextUpdate||{names:{utcTimeName:"tbsCertList.nextUpdate",generalTimeName:"tbsCertList.nextUpdate"}},true),new asn1js.Sequence({optional:true,value:[new asn1js.Repeated({name:names.tbsCertListRevokedCertificates||"tbsCertList.revokedCertificates",value:new asn1js.Sequence({value:[new asn1js.Integer,_Time2.default.schema(),_Extensions2.default.schema({},true)]})})]}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[_Extensions2.default.schema(names.crlExtensions||{names:{blockName:"tbsCertList.extensions"}})]})]})}var CertificateRevocationList=function(){function CertificateRevocationList(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,CertificateRevocationList);this.tbs=(0,_pvutils.getParametersValue)(parameters,"tbs",CertificateRevocationList.defaultValues("tbs"));this.version=(0,_pvutils.getParametersValue)(parameters,"version",CertificateRevocationList.defaultValues("version"));this.signature=(0,_pvutils.getParametersValue)(parameters,"signature",CertificateRevocationList.defaultValues("signature"));this.issuer=(0,_pvutils.getParametersValue)(parameters,"issuer",CertificateRevocationList.defaultValues("issuer"));this.thisUpdate=(0,_pvutils.getParametersValue)(parameters,"thisUpdate",CertificateRevocationList.defaultValues("thisUpdate"));if("nextUpdate"in parameters)this.nextUpdate=(0,_pvutils.getParametersValue)(parameters,"nextUpdate",CertificateRevocationList.defaultValues("nextUpdate"));if("revokedCertificates"in parameters)this.revokedCertificates=(0,_pvutils.getParametersValue)(parameters,"revokedCertificates",CertificateRevocationList.defaultValues("revokedCertificates"));if("crlExtensions"in parameters)this.crlExtensions=(0,_pvutils.getParametersValue)(parameters,"crlExtensions",CertificateRevocationList.defaultValues("crlExtensions"));this.signatureAlgorithm=(0,_pvutils.getParametersValue)(parameters,"signatureAlgorithm",CertificateRevocationList.defaultValues("signatureAlgorithm"));this.signatureValue=(0,_pvutils.getParametersValue)(parameters,"signatureValue",CertificateRevocationList.defaultValues("signatureValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(CertificateRevocationList,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,CertificateRevocationList.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CRL");this.tbs=asn1.result.tbsCertList.valueBeforeDecode;if("tbsCertList.version"in asn1.result)this.version=asn1.result["tbsCertList.version"].valueBlock.valueDec;this.signature=new _AlgorithmIdentifier2.default({schema:asn1.result["tbsCertList.signature"]});this.issuer=new _RelativeDistinguishedNames2.default({schema:asn1.result["tbsCertList.issuer"]});this.thisUpdate=new _Time2.default({schema:asn1.result["tbsCertList.thisUpdate"]});if("tbsCertList.nextUpdate"in asn1.result)this.nextUpdate=new _Time2.default({schema:asn1.result["tbsCertList.nextUpdate"]});if("tbsCertList.revokedCertificates"in asn1.result)this.revokedCertificates=Array.from(asn1.result["tbsCertList.revokedCertificates"],function(element){return new _RevokedCertificate2.default({schema:element})});if("tbsCertList.extensions"in asn1.result)this.crlExtensions=new _Extensions2.default({schema:asn1.result["tbsCertList.extensions"]});this.signatureAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.signatureAlgorithm});this.signatureValue=asn1.result.signatureValue}},{key:"encodeTBS",value:function encodeTBS(){var outputArray=[];if(this.version!==CertificateRevocationList.defaultValues("version"))outputArray.push(new asn1js.Integer({value:this.version}));outputArray.push(this.signature.toSchema());outputArray.push(this.issuer.toSchema());outputArray.push(this.thisUpdate.toSchema());if("nextUpdate"in this)outputArray.push(this.nextUpdate.toSchema());if("revokedCertificates"in this){outputArray.push(new asn1js.Sequence({value:Array.from(this.revokedCertificates,function(element){return element.toSchema()})}))}if("crlExtensions"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[this.crlExtensions.toSchema()]}))}return new asn1js.Sequence({value:outputArray})}},{key:"toSchema",value:function toSchema(){var encodeFlag=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var tbsSchema=void 0;if(encodeFlag===false){if(this.tbs.length===0)return CertificateRevocationList.schema();tbsSchema=asn1js.fromBER(this.tbs).result}else tbsSchema=this.encodeTBS();return new asn1js.Sequence({value:[tbsSchema,this.signatureAlgorithm.toSchema(),this.signatureValue]})}},{key:"toJSON",value:function toJSON(){var object={tbs:(0,_pvutils.bufferToHexCodes)(this.tbs,0,this.tbs.byteLength),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),thisUpdate:this.thisUpdate.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};if(this.version!==CertificateRevocationList.defaultValues("version"))object.version=this.version;if("nextUpdate"in this)object.nextUpdate=this.nextUpdate.toJSON();if("revokedCertificates"in this)object.revokedCertificates=Array.from(this.revokedCertificates,function(element){return element.toJSON()});if("crlExtensions"in this)object.crlExtensions=this.crlExtensions.toJSON();return object}},{key:"isCertificateRevoked",value:function isCertificateRevoked(certificate){if(this.issuer.isEqual(certificate.issuer)===false)return false;if("revokedCertificates"in this===false)return false;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.revokedCertificates[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var revokedCertificate=_step.value;if(revokedCertificate.userCertificate.isEqual(certificate.serialNumber))return true}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return false}},{key:"sign",value:function sign(privateKey){var _this=this;var hashAlgorithm=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"SHA-1";if(typeof privateKey==="undefined")return Promise.reject("Need to provide a private key for signing");var sequence=Promise.resolve();var parameters=void 0;var engine=(0,_common.getEngine)();sequence=sequence.then(function(){return engine.subtle.getSignatureParameters(privateKey,hashAlgorithm)});sequence=sequence.then(function(result){parameters=result.parameters;_this.signature=result.signatureAlgorithm;_this.signatureAlgorithm=result.signatureAlgorithm});sequence=sequence.then(function(){_this.tbs=_this.encodeTBS().toBER(false)});sequence=sequence.then(function(){return engine.subtle.signWithPrivateKey(_this.tbs,privateKey,parameters)});sequence=sequence.then(function(result){_this.signatureValue=new asn1js.BitString({valueHex:result})});return sequence}},{key:"verify",value:function verify(){var _this2=this;var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var sequence=Promise.resolve();var subjectPublicKeyInfo=-1;var engine=(0,_common.getEngine)();if("issuerCertificate"in parameters){subjectPublicKeyInfo=parameters.issuerCertificate.subjectPublicKeyInfo;if(this.issuer.isEqual(parameters.issuerCertificate.subject)===false)return Promise.resolve(false)}if("publicKeyInfo"in parameters)subjectPublicKeyInfo=parameters.publicKeyInfo;if("subjectPublicKey"in subjectPublicKeyInfo===false)return Promise.reject("Issuer's certificate must be provided as an input parameter");if("crlExtensions"in this){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=this.crlExtensions.extensions[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var extension=_step2.value;if(extension.critical){if("parsedValue"in extension===false)return Promise.resolve(false)}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}}sequence=sequence.then(function(){return engine.subtle.verifyWithPublicKey(_this2.tbs,_this2.signatureValue,subjectPublicKeyInfo,_this2.signatureAlgorithm)});return sequence}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"tbs":return new ArrayBuffer(0);case"version":return 1;case"signature":return new _AlgorithmIdentifier2.default;case"issuer":return new _RelativeDistinguishedNames2.default;case"thisUpdate":return new _Time2.default;case"nextUpdate":return new _Time2.default;case"revokedCertificates":return[];case"crlExtensions":return new _Extensions2.default;case"signatureAlgorithm":return new _AlgorithmIdentifier2.default;case"signatureValue":return new asn1js.BitString;default:throw new Error("Invalid member name for CertificateRevocationList class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"CertificateList",value:[tbsCertList(parameters),_AlgorithmIdentifier2.default.schema(names.signatureAlgorithm||{names:{blockName:"signatureAlgorithm"}}),new asn1js.BitString({name:names.signatureValue||"signatureValue"})]})}}]);return CertificateRevocationList}();exports.default=CertificateRevocationList},{"./AlgorithmIdentifier.js":3,"./Extensions.js":36,"./RelativeDistinguishedNames.js":85,"./RevokedCertificate.js":90,"./Time.js":102,"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],21:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _Certificate=require("./Certificate.js");var _Certificate2=_interopRequireDefault(_Certificate);var _AttributeCertificateV=require("./AttributeCertificateV1.js");var _AttributeCertificateV2=_interopRequireDefault(_AttributeCertificateV);var _AttributeCertificateV3=require("./AttributeCertificateV2.js");var _AttributeCertificateV4=_interopRequireDefault(_AttributeCertificateV3);var _OtherCertificateFormat=require("./OtherCertificateFormat.js");var _OtherCertificateFormat2=_interopRequireDefault(_OtherCertificateFormat);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CertificateSet=function(){function CertificateSet(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,CertificateSet);this.certificates=(0,_pvutils.getParametersValue)(parameters,"certificates",CertificateSet.defaultValues("certificates"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(CertificateSet,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,CertificateSet.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CertificateSet");this.certificates=Array.from(asn1.result.certificates,function(element){var initialTagNumber=element.idBlock.tagNumber;if(element.idBlock.tagClass===1)return new _Certificate2.default({schema:element});element.idBlock.tagClass=1;element.idBlock.tagNumber=16;switch(initialTagNumber){case 1:return new _AttributeCertificateV2.default({schema:element});case 2:return new _AttributeCertificateV4.default({schema:element});case 3:return new _OtherCertificateFormat2.default({schema:element});case 0:default:}return element})}},{key:"toSchema",value:function toSchema(){return new asn1js.Set({value:Array.from(this.certificates,function(element){switch(true){case element instanceof _Certificate2.default:return element.toSchema();case element instanceof _AttributeCertificateV2.default:return new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:element.toSchema().valueBlock.value});case element instanceof _AttributeCertificateV4.default:return new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:2},value:element.toSchema().valueBlock.value});case element instanceof _OtherCertificateFormat2.default:return new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:3},value:element.toSchema().valueBlock.value});default:}return element})})}},{key:"toJSON",value:function toJSON(){return{certificates:Array.from(this.certificates,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"certificates":return[];default:throw new Error("Invalid member name for Attribute class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Set({name:names.blockName||"",value:[new asn1js.Repeated({name:names.certificates||"certificates",value:new asn1js.Choice({value:[_Certificate2.default.schema(),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Any]}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:_AttributeCertificateV2.default.schema().valueBlock.value}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:2},value:_AttributeCertificateV4.default.schema().valueBlock.value}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:3},value:_OtherCertificateFormat2.default.schema().valueBlock.value})]})})]})}}]);return CertificateSet}();exports.default=CertificateSet},{"./AttributeCertificateV1.js":6,"./AttributeCertificateV2.js":7,"./Certificate.js":17,"./OtherCertificateFormat.js":57,asn1js:"asn1js",pvutils:"pvutils"}],22:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");var _PublicKeyInfo=require("./PublicKeyInfo.js");var _PublicKeyInfo2=_interopRequireDefault(_PublicKeyInfo);var _RelativeDistinguishedNames=require("./RelativeDistinguishedNames.js");var _RelativeDistinguishedNames2=_interopRequireDefault(_RelativeDistinguishedNames);var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _Attribute=require("./Attribute.js");var _Attribute2=_interopRequireDefault(_Attribute);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function CertificationRequestInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.CertificationRequestInfo||"CertificationRequestInfo",value:[new asn1js.Integer({name:names.CertificationRequestInfoVersion||"CertificationRequestInfo.version"}),_RelativeDistinguishedNames2.default.schema(names.subject||{names:{blockName:"CertificationRequestInfo.subject"}}),_PublicKeyInfo2.default.schema({names:{blockName:"CertificationRequestInfo.subjectPublicKeyInfo"}}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Repeated({optional:true,name:names.CertificationRequestInfoAttributes||"CertificationRequestInfo.attributes",value:_Attribute2.default.schema(names.attributes||{})})]})]})}var CertificationRequest=function(){function CertificationRequest(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,CertificationRequest);this.tbs=(0,_pvutils.getParametersValue)(parameters,"tbs",CertificationRequest.defaultValues("tbs"));this.version=(0,_pvutils.getParametersValue)(parameters,"version",CertificationRequest.defaultValues("version"));this.subject=(0,_pvutils.getParametersValue)(parameters,"subject",CertificationRequest.defaultValues("subject"));this.subjectPublicKeyInfo=(0,_pvutils.getParametersValue)(parameters,"subjectPublicKeyInfo",CertificationRequest.defaultValues("subjectPublicKeyInfo"));if("attributes"in parameters)this.attributes=(0,_pvutils.getParametersValue)(parameters,"attributes",CertificationRequest.defaultValues("attributes"));this.signatureAlgorithm=(0,_pvutils.getParametersValue)(parameters,"signatureAlgorithm",CertificationRequest.defaultValues("signatureAlgorithm"));this.signatureValue=(0,_pvutils.getParametersValue)(parameters,"signatureValue",CertificationRequest.defaultValues("signatureValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(CertificationRequest,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,CertificationRequest.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PKCS10");this.tbs=asn1.result.CertificationRequestInfo.valueBeforeDecode;this.version=asn1.result["CertificationRequestInfo.version"].valueBlock.valueDec;this.subject=new _RelativeDistinguishedNames2.default({schema:asn1.result["CertificationRequestInfo.subject"]});this.subjectPublicKeyInfo=new _PublicKeyInfo2.default({schema:asn1.result["CertificationRequestInfo.subjectPublicKeyInfo"]});if("CertificationRequestInfo.attributes"in asn1.result)this.attributes=Array.from(asn1.result["CertificationRequestInfo.attributes"],function(element){return new _Attribute2.default({schema:element})});this.signatureAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.signatureAlgorithm});this.signatureValue=asn1.result.signatureValue}},{key:"encodeTBS",value:function encodeTBS(){var outputArray=[new asn1js.Integer({value:this.version}),this.subject.toSchema(),this.subjectPublicKeyInfo.toSchema()];if("attributes"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,function(element){return element.toSchema()})}))}return new asn1js.Sequence({value:outputArray})}},{key:"toSchema",value:function toSchema(){var encodeFlag=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var tbsSchema=void 0;if(encodeFlag===false){if(this.tbs.byteLength===0)return CertificationRequest.schema();tbsSchema=asn1js.fromBER(this.tbs).result}else tbsSchema=this.encodeTBS();return new asn1js.Sequence({value:[tbsSchema,this.signatureAlgorithm.toSchema(),this.signatureValue]})}},{key:"toJSON",value:function toJSON(){var object={tbs:(0,_pvutils.bufferToHexCodes)(this.tbs,0,this.tbs.byteLength),version:this.version,subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};if("attributes"in this)object.attributes=Array.from(this.attributes,function(element){return element.toJSON()});return object}},{key:"sign",value:function sign(privateKey){var _this=this;var hashAlgorithm=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"SHA-1";if(typeof privateKey==="undefined")return Promise.reject("Need to provide a private key for signing");var sequence=Promise.resolve();var parameters=void 0;var engine=(0,_common.getEngine)();sequence=sequence.then(function(){return engine.subtle.getSignatureParameters(privateKey,hashAlgorithm)});sequence=sequence.then(function(result){parameters=result.parameters;_this.signatureAlgorithm=result.signatureAlgorithm});sequence=sequence.then(function(){_this.tbs=_this.encodeTBS().toBER(false)});sequence=sequence.then(function(){return engine.subtle.signWithPrivateKey(_this.tbs,privateKey,parameters)});sequence=sequence.then(function(result){_this.signatureValue=new asn1js.BitString({valueHex:result})});return sequence}},{key:"verify",value:function verify(){return(0,_common.getEngine)().subtle.verifyWithPublicKey(this.tbs,this.signatureValue,this.subjectPublicKeyInfo,this.signatureAlgorithm)}},{key:"getPublicKey",value:function getPublicKey(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return(0,_common.getEngine)().getPublicKey(this.subjectPublicKeyInfo,this.signatureAlgorithm,parameters)}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"tbs":return new ArrayBuffer(0);case"version":return 0;case"subject":return new _RelativeDistinguishedNames2.default;case"subjectPublicKeyInfo":return new _PublicKeyInfo2.default;case"attributes":return[];case"signatureAlgorithm":return new _AlgorithmIdentifier2.default;case"signatureValue":return new asn1js.BitString;default:throw new Error("Invalid member name for CertificationRequest class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({value:[CertificationRequestInfo(names.certificationRequestInfo||{}),new asn1js.Sequence({name:names.signatureAlgorithm||"signatureAlgorithm",value:[new asn1js.ObjectIdentifier,new asn1js.Any({optional:true})]}),new asn1js.BitString({name:names.signatureValue||"signatureValue"})]})}}]);return CertificationRequest}();exports.default=CertificationRequest},{"./AlgorithmIdentifier.js":3,"./Attribute.js":5,"./PublicKeyInfo.js":75,"./RelativeDistinguishedNames.js":85,"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],23:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ContentInfo=function(){function ContentInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,ContentInfo);this.contentType=(0,_pvutils.getParametersValue)(parameters,"contentType",ContentInfo.defaultValues("contentType"));this.content=(0,_pvutils.getParametersValue)(parameters,"content",ContentInfo.defaultValues("content"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(ContentInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,ContentInfo.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CMS_CONTENT_INFO");this.contentType=asn1.result.contentType.valueBlock.toString();this.content=asn1.result.content}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.ObjectIdentifier({value:this.contentType}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.content]})]})}},{key:"toJSON",value:function toJSON(){var object={contentType:this.contentType};if(!(this.content instanceof asn1js.Any))object.content=this.content.toJSON();return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"contentType":return"";case"content":return new asn1js.Any;default:throw new Error("Invalid member name for ContentInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"contentType":return memberValue==="";case"content":return memberValue instanceof asn1js.Any;default:throw new Error("Invalid member name for ContentInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});if("optional"in names===false)names.optional=false;return new asn1js.Sequence({name:names.blockName||"ContentInfo",optional:names.optional,value:[new asn1js.ObjectIdentifier({name:names.contentType||"contentType"}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Any({name:names.content||"content"})]})]})}}]);return ContentInfo}();exports.default=ContentInfo},{asn1js:"asn1js",pvutils:"pvutils"}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");var _PublicKeyInfo=require("./PublicKeyInfo.js");var _PublicKeyInfo2=_interopRequireDefault(_PublicKeyInfo);var _PrivateKeyInfo=require("./PrivateKeyInfo.js");var _PrivateKeyInfo2=_interopRequireDefault(_PrivateKeyInfo);var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _EncryptedContentInfo=require("./EncryptedContentInfo.js");var _EncryptedContentInfo2=_interopRequireDefault(_EncryptedContentInfo);var _RSASSAPSSParams=require("./RSASSAPSSParams.js");var _RSASSAPSSParams2=_interopRequireDefault(_RSASSAPSSParams);var _PBKDF2Params=require("./PBKDF2Params.js");var _PBKDF2Params2=_interopRequireDefault(_PBKDF2Params);var _PBES2Params=require("./PBES2Params.js");var _PBES2Params2=_interopRequireDefault(_PBES2Params);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}function makePKCS12B2Key(cryptoEngine,hashAlgorithm,keyLength,password,salt,iterationCount){var u=void 0;var v=void 0;var result=[];switch(hashAlgorithm.toUpperCase()){case"SHA-1":u=20;v=64;break;case"SHA-256":u=32;v=64;break;case"SHA-384":u=48;v=128;break;case"SHA-512":u=64;v=128;break;default:throw new Error("Unsupported hashing algorithm")}var passwordViewInitial=new Uint8Array(password);var passwordTransformed=new ArrayBuffer(password.byteLength*2+2);var passwordTransformedView=new Uint8Array(passwordTransformed);for(var i=0;i<passwordViewInitial.length;i++){passwordTransformedView[i*2]=0;passwordTransformedView[i*2+1]=passwordViewInitial[i]}passwordTransformedView[passwordTransformedView.length-2]=0;passwordTransformedView[passwordTransformedView.length-1]=0;password=passwordTransformed.slice(0);var D=new ArrayBuffer(v);var dView=new Uint8Array(D);for(var _i=0;_i<D.byteLength;_i++){dView[_i]=3}var saltLength=salt.byteLength;var sLen=v*Math.ceil(saltLength/v);var S=new ArrayBuffer(sLen);var sView=new Uint8Array(S);var saltView=new Uint8Array(salt);for(var _i2=0;_i2<sLen;_i2++){sView[_i2]=saltView[_i2%saltLength]}var passwordLength=password.byteLength;var pLen=v*Math.ceil(passwordLength/v);var P=new ArrayBuffer(pLen);var pView=new Uint8Array(P);var passwordView=new Uint8Array(password);for(var _i3=0;_i3<pLen;_i3++){pView[_i3]=passwordView[_i3%passwordLength]}var sPlusPLength=S.byteLength+P.byteLength;var I=new ArrayBuffer(sPlusPLength);var iView=new Uint8Array(I);iView.set(sView);iView.set(pView,sView.length);var c=Math.ceil((keyLength>>3)/u);var internalSequence=Promise.resolve(I);for(var _i4=0;_i4<=c;_i4++){internalSequence=internalSequence.then(function(_I){var dAndI=new ArrayBuffer(D.byteLength+_I.byteLength);var dAndIView=new Uint8Array(dAndI);dAndIView.set(dView);dAndIView.set(iView,dView.length);return dAndI});for(var j=0;j<iterationCount;j++){internalSequence=internalSequence.then(function(roundBuffer){return cryptoEngine.digest({name:hashAlgorithm},new Uint8Array(roundBuffer))})}internalSequence=internalSequence.then(function(roundBuffer){var B=new ArrayBuffer(v);var bView=new Uint8Array(B);for(var _j=0;_j<B.byteLength;_j++){bView[_j]=roundBuffer[_j%roundBuffer.length]}var k=Math.ceil(saltLength/v)+Math.ceil(passwordLength/v);var iRound=[];var sliceStart=0;var sliceLength=v;for(var _j2=0;_j2<k;_j2++){var chunk=Array.from(new Uint8Array(I.slice(sliceStart,sliceStart+sliceLength)));sliceStart+=v;if(sliceStart+v>I.byteLength)sliceLength=I.byteLength-sliceStart;var x=511;for(var l=B.byteLength-1;l>=0;l--){x>>=8;x+=bView[l]+chunk[l];chunk[l]=x&255}iRound.push.apply(iRound,_toConsumableArray(chunk))}I=new ArrayBuffer(iRound.length);iView=new Uint8Array(I);iView.set(iRound);result.push.apply(result,_toConsumableArray(new Uint8Array(roundBuffer)));return I})}internalSequence=internalSequence.then(function(){var resultBuffer=new ArrayBuffer(keyLength>>3);var resultView=new Uint8Array(resultBuffer);resultView.set(new Uint8Array(result).slice(0,keyLength>>3));return resultBuffer});return internalSequence}var CryptoEngine=function(){function CryptoEngine(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,CryptoEngine);this.crypto=(0,_pvutils.getParametersValue)(parameters,"crypto",{});this.subtle=(0,_pvutils.getParametersValue)(parameters,"subtle",{});this.name=(0,_pvutils.getParametersValue)(parameters,"name","")}_createClass(CryptoEngine,[{key:"importKey",value:function importKey(format,keyData,algorithm,extractable,keyUsages){var _this=this;var jwk={};if(keyData instanceof Uint8Array)keyData=keyData.buffer;switch(format.toLowerCase()){case"raw":return this.subtle.importKey("raw",keyData,algorithm,extractable,keyUsages);case"spki":{var asn1=asn1js.fromBER(keyData);if(asn1.offset===-1)return Promise.reject("Incorrect keyData");var publicKeyInfo=new _PublicKeyInfo2.default;try{publicKeyInfo.fromSchema(asn1.result)}catch(ex){return Promise.reject("Incorrect keyData")}switch(algorithm.name.toUpperCase()){case"RSA-PSS":{switch(algorithm.hash.name.toUpperCase()){case"SHA-1":jwk.alg="PS1";break;case"SHA-256":jwk.alg="PS256";break;case"SHA-384":jwk.alg="PS384";break;case"SHA-512":jwk.alg="PS512";break;default:return Promise.reject("Incorrect hash algorithm: "+algorithm.hash.name.toUpperCase())}}case"RSASSA-PKCS1-V1_5":{keyUsages=["verify"];jwk.kty="RSA";jwk.ext=extractable;jwk.key_ops=keyUsages;if(publicKeyInfo.algorithm.algorithmId!=="1.2.840.113549.1.1.1")return Promise.reject("Incorrect public key algorithm: "+publicKeyInfo.algorithm.algorithmId);if("alg"in jwk===false){switch(algorithm.hash.name.toUpperCase()){case"SHA-1":jwk.alg="RS1";break;case"SHA-256":jwk.alg="RS256";break;case"SHA-384":jwk.alg="RS384";break;case"SHA-512":jwk.alg="RS512";break;default:return Promise.reject("Incorrect public key algorithm: "+publicKeyInfo.algorithm.algorithmId)}}var publicKeyJSON=publicKeyInfo.toJSON();var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=Object.keys(publicKeyJSON)[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var key=_step.value;jwk[key]=publicKeyJSON[key]}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}break;case"ECDSA":keyUsages=["verify"];case"ECDH":{jwk={kty:"EC",ext:extractable,key_ops:keyUsages};if(publicKeyInfo.algorithm.algorithmId!=="1.2.840.10045.2.1")return Promise.reject("Incorrect public key algorithm: "+publicKeyInfo.algorithm.algorithmId);var _publicKeyJSON=publicKeyInfo.toJSON();var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=Object.keys(_publicKeyJSON)[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var _key=_step2.value;jwk[_key]=_publicKeyJSON[_key]}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}}break;case"RSA-OAEP":{jwk.kty="RSA";jwk.ext=extractable;jwk.key_ops=keyUsages;if(this.name.toLowerCase()==="safari")jwk.alg="RSA-OAEP";else{switch(algorithm.hash.name.toUpperCase()){case"SHA-1":jwk.alg="RSA-OAEP-1";break;case"SHA-256":jwk.alg="RSA-OAEP-256";break;case"SHA-384":jwk.alg="RSA-OAEP-384";break;case"SHA-512":jwk.alg="RSA-OAEP-512";break;default:return Promise.reject("Incorrect public key algorithm: "+publicKeyInfo.algorithm.algorithmId)}}var _publicKeyJSON2=publicKeyInfo.toJSON();var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=Object.keys(_publicKeyJSON2)[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var _key2=_step3.value;jwk[_key2]=_publicKeyJSON2[_key2]}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}}break;default:return Promise.reject("Incorrect algorithm name: "+algorithm.name.toUpperCase())}}break;case"pkcs8":{var privateKeyInfo=new _PrivateKeyInfo2.default;var _asn=asn1js.fromBER(keyData);if(_asn.offset===-1)return Promise.reject("Incorrect keyData");try{privateKeyInfo.fromSchema(_asn.result)}catch(ex){return Promise.reject("Incorrect keyData")}if("parsedKey"in privateKeyInfo===false)return Promise.reject("Incorrect keyData");switch(algorithm.name.toUpperCase()){case"RSA-PSS":{switch(algorithm.hash.name.toUpperCase()){case"SHA-1":jwk.alg="PS1";break;case"SHA-256":jwk.alg="PS256";break;case"SHA-384":jwk.alg="PS384";break;case"SHA-512":jwk.alg="PS512";break;default:return Promise.reject("Incorrect hash algorithm: "+algorithm.hash.name.toUpperCase())}}case"RSASSA-PKCS1-V1_5":{keyUsages=["sign"];jwk.kty="RSA";jwk.ext=extractable;jwk.key_ops=keyUsages;if(privateKeyInfo.privateKeyAlgorithm.algorithmId!=="1.2.840.113549.1.1.1")return Promise.reject("Incorrect private key algorithm: "+privateKeyInfo.privateKeyAlgorithm.algorithmId);if("alg"in jwk===false){switch(algorithm.hash.name.toUpperCase()){case"SHA-1":jwk.alg="RS1";break;case"SHA-256":jwk.alg="RS256";break;case"SHA-384":jwk.alg="RS384";break;case"SHA-512":jwk.alg="RS512";break;default:return Promise.reject("Incorrect hash algorithm: "+algorithm.hash.name.toUpperCase())}}var privateKeyJSON=privateKeyInfo.toJSON();var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=Object.keys(privateKeyJSON)[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var _key3=_step4.value;jwk[_key3]=privateKeyJSON[_key3]}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally{try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally{if(_didIteratorError4){throw _iteratorError4}}}}break;case"ECDSA":keyUsages=["sign"];case"ECDH":{jwk={kty:"EC",ext:extractable,key_ops:keyUsages};if(privateKeyInfo.privateKeyAlgorithm.algorithmId!=="1.2.840.10045.2.1")return Promise.reject("Incorrect algorithm: "+privateKeyInfo.privateKeyAlgorithm.algorithmId);var _privateKeyJSON=privateKeyInfo.toJSON();var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=Object.keys(_privateKeyJSON)[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var _key4=_step5.value;jwk[_key4]=_privateKeyJSON[_key4]}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally{try{if(!_iteratorNormalCompletion5&&_iterator5.return){_iterator5.return()}}finally{if(_didIteratorError5){throw _iteratorError5}}}}break;case"RSA-OAEP":{jwk.kty="RSA";jwk.ext=extractable;jwk.key_ops=keyUsages;if(this.name.toLowerCase()==="safari")jwk.alg="RSA-OAEP";else{switch(algorithm.hash.name.toUpperCase()){case"SHA-1":jwk.alg="RSA-OAEP-1";break;case"SHA-256":jwk.alg="RSA-OAEP-256";break;case"SHA-384":jwk.alg="RSA-OAEP-384";break;case"SHA-512":jwk.alg="RSA-OAEP-512";break;default:return Promise.reject("Incorrect hash algorithm: "+algorithm.hash.name.toUpperCase())}}var _privateKeyJSON2=privateKeyInfo.toJSON();var _iteratorNormalCompletion6=true;var _didIteratorError6=false;var _iteratorError6=undefined;try{for(var _iterator6=Object.keys(_privateKeyJSON2)[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=true){var _key5=_step6.value;jwk[_key5]=_privateKeyJSON2[_key5]}}catch(err){_didIteratorError6=true;_iteratorError6=err}finally{try{if(!_iteratorNormalCompletion6&&_iterator6.return){_iterator6.return()}}finally{if(_didIteratorError6){throw _iteratorError6}}}}break;default:return Promise.reject("Incorrect algorithm name: "+algorithm.name.toUpperCase())}}break;case"jwk":jwk=keyData;break;default:return Promise.reject("Incorrect format: "+format)}if(this.name.toLowerCase()==="safari"){return Promise.resolve().then(function(){return _this.subtle.importKey("jwk",(0,_pvutils.stringToArrayBuffer)(JSON.stringify(jwk)),algorithm,extractable,keyUsages)}).then(function(result){return result},function(){return _this.subtle.importKey("jwk",jwk,algorithm,extractable,keyUsages)})}return this.subtle.importKey("jwk",jwk,algorithm,extractable,keyUsages)}},{key:"exportKey",value:function exportKey(format,key){var sequence=this.subtle.exportKey("jwk",key);if(this.name.toLowerCase()==="safari"){sequence=sequence.then(function(result){if(result instanceof ArrayBuffer)return JSON.parse((0,_pvutils.arrayBufferToString)(result));return result})}switch(format.toLowerCase()){case"raw":return this.subtle.exportKey("raw",key);case"spki":sequence=sequence.then(function(result){var publicKeyInfo=new _PublicKeyInfo2.default;try{publicKeyInfo.fromJSON(result)}catch(ex){return Promise.reject("Incorrect key data")}return publicKeyInfo.toSchema().toBER(false)});break;case"pkcs8":sequence=sequence.then(function(result){var privateKeyInfo=new _PrivateKeyInfo2.default;try{privateKeyInfo.fromJSON(result)}catch(ex){return Promise.reject("Incorrect key data")}return privateKeyInfo.toSchema().toBER(false)});break;case"jwk":break;default:return Promise.reject("Incorrect format: "+format)}return sequence}},{key:"convert",value:function convert(inputFormat,outputFormat,keyData,algorithm,extractable,keyUsages){var _this2=this;switch(inputFormat.toLowerCase()){case"raw":switch(outputFormat.toLowerCase()){case"raw":return Promise.resolve(keyData);case"spki":return Promise.resolve().then(function(){return _this2.importKey("raw",keyData,algorithm,extractable,keyUsages)}).then(function(result){return _this2.exportKey("spki",result)});case"pkcs8":return Promise.resolve().then(function(){return _this2.importKey("raw",keyData,algorithm,extractable,keyUsages)}).then(function(result){return _this2.exportKey("pkcs8",result)});case"jwk":return Promise.resolve().then(function(){return _this2.importKey("raw",keyData,algorithm,extractable,keyUsages)}).then(function(result){return _this2.exportKey("jwk",result)});default:return Promise.reject("Incorrect outputFormat: "+outputFormat)}case"spki":switch(outputFormat.toLowerCase()){case"raw":return Promise.resolve().then(function(){return _this2.importKey("spki",keyData,algorithm,extractable,keyUsages)}).then(function(result){return _this2.exportKey("raw",result)});case"spki":return Promise.resolve(keyData);case"pkcs8":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"jwk":return Promise.resolve().then(function(){return _this2.importKey("spki",keyData,algorithm,extractable,keyUsages)}).then(function(result){return _this2.exportKey("jwk",result)});default:return Promise.reject("Incorrect outputFormat: "+outputFormat)}case"pkcs8":switch(outputFormat.toLowerCase()){case"raw":return Promise.resolve().then(function(){return _this2.importKey("pkcs8",keyData,algorithm,extractable,keyUsages)}).then(function(result){return _this2.exportKey("raw",result)});case"spki":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"pkcs8":return Promise.resolve(keyData);case"jwk":return Promise.resolve().then(function(){return _this2.importKey("pkcs8",keyData,algorithm,extractable,keyUsages)}).then(function(result){return _this2.exportKey("jwk",result)});default:return Promise.reject("Incorrect outputFormat: "+outputFormat)}case"jwk":switch(outputFormat.toLowerCase()){case"raw":return Promise.resolve().then(function(){return _this2.importKey("jwk",keyData,algorithm,extractable,keyUsages)}).then(function(result){return _this2.exportKey("raw",result)});case"spki":return Promise.resolve().then(function(){return _this2.importKey("jwk",keyData,algorithm,extractable,keyUsages)}).then(function(result){return _this2.exportKey("spki",result)});case"pkcs8":return Promise.resolve().then(function(){return _this2.importKey("jwk",keyData,algorithm,extractable,keyUsages)}).then(function(result){return _this2.exportKey("pkcs8",result)});case"jwk":return Promise.resolve(keyData);default:return Promise.reject("Incorrect outputFormat: "+outputFormat)}default:return Promise.reject("Incorrect inputFormat: "+inputFormat)}}},{key:"encrypt",value:function encrypt(){var _subtle;return(_subtle=this.subtle).encrypt.apply(_subtle,arguments)}},{key:"decrypt",value:function decrypt(){var _subtle2;return(_subtle2=this.subtle).decrypt.apply(_subtle2,arguments)}},{key:"sign",value:function sign(){var _subtle3;return(_subtle3=this.subtle).sign.apply(_subtle3,arguments)}},{key:"verify",value:function verify(){var _subtle4;return(_subtle4=this.subtle).verify.apply(_subtle4,arguments)}},{key:"digest",value:function digest(){var _subtle5;return(_subtle5=this.subtle).digest.apply(_subtle5,arguments)}},{key:"generateKey",value:function generateKey(){var _subtle6;return(_subtle6=this.subtle).generateKey.apply(_subtle6,arguments)}},{key:"deriveKey",value:function deriveKey(){var _subtle7;return(_subtle7=this.subtle).deriveKey.apply(_subtle7,arguments)}},{key:"deriveBits",value:function deriveBits(){var _subtle8;return(_subtle8=this.subtle).deriveBits.apply(_subtle8,arguments)}},{key:"wrapKey",value:function wrapKey(){var _subtle9;return(_subtle9=this.subtle).wrapKey.apply(_subtle9,arguments)}},{key:"unwrapKey",value:function unwrapKey(){var _subtle10;return(_subtle10=this.subtle).unwrapKey.apply(_subtle10,arguments)}},{key:"getRandomValues",value:function getRandomValues(view){if("getRandomValues"in this.crypto===false)throw new Error("No support for getRandomValues");return this.crypto.getRandomValues(view)}},{key:"getAlgorithmByOID",value:function getAlgorithmByOID(oid){switch(oid){case"1.2.840.113549.1.1.1":case"1.2.840.113549.1.1.5":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case"1.2.840.113549.1.1.11":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"1.2.840.113549.1.1.12":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case"1.2.840.113549.1.1.13":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case"1.2.840.113549.1.1.10":return{name:"RSA-PSS"};case"1.2.840.113549.1.1.7":return{name:"RSA-OAEP"};case"1.2.840.10045.2.1":case"1.2.840.10045.4.1":return{name:"ECDSA",hash:{name:"SHA-1"}};case"1.2.840.10045.4.3.2":return{name:"ECDSA",hash:{name:"SHA-256"}};case"1.2.840.10045.4.3.3":return{name:"ECDSA",hash:{name:"SHA-384"}};case"1.2.840.10045.4.3.4":return{name:"ECDSA",hash:{name:"SHA-512"}};case"1.3.133.16.840.63.0.2":return{name:"ECDH",kdf:"SHA-1"};case"1.3.132.1.11.1":return{name:"ECDH",kdf:"SHA-256"};case"1.3.132.1.11.2":return{name:"ECDH",kdf:"SHA-384"};case"1.3.132.1.11.3":return{name:"ECDH",kdf:"SHA-512"};case"2.16.840.1.101.3.4.1.2":return{name:"AES-CBC",length:128};case"2.16.840.1.101.3.4.1.22":return{name:"AES-CBC",length:192};case"2.16.840.1.101.3.4.1.42":return{name:"AES-CBC",length:256};case"2.16.840.1.101.3.4.1.6":return{name:"AES-GCM",length:128};case"2.16.840.1.101.3.4.1.26":return{name:"AES-GCM",length:192};case"2.16.840.1.101.3.4.1.46":return{name:"AES-GCM",length:256};case"2.16.840.1.101.3.4.1.4":return{name:"AES-CFB",length:128};case"2.16.840.1.101.3.4.1.24":return{name:"AES-CFB",length:192};case"2.16.840.1.101.3.4.1.44":return{name:"AES-CFB",length:256};case"2.16.840.1.101.3.4.1.5":return{name:"AES-KW",length:128};case"2.16.840.1.101.3.4.1.25":return{name:"AES-KW",length:192};case"2.16.840.1.101.3.4.1.45":return{name:"AES-KW",length:256};case"1.2.840.113549.2.7":return{name:"HMAC",hash:{name:"SHA-1"}};case"1.2.840.113549.2.9":return{name:"HMAC",hash:{name:"SHA-256"}};case"1.2.840.113549.2.10":return{name:"HMAC",hash:{name:"SHA-384"}};case"1.2.840.113549.2.11":return{name:"HMAC",hash:{name:"SHA-512"}};case"1.2.840.113549.1.9.16.3.5":return{name:"DH"};case"1.3.14.3.2.26":return{name:"SHA-1"};case"2.16.840.1.101.3.4.2.1":return{name:"SHA-256"};case"2.16.840.1.101.3.4.2.2":return{name:"SHA-384"};case"2.16.840.1.101.3.4.2.3":return{name:"SHA-512"};case"1.2.840.113549.1.5.12":return{name:"PBKDF2"};case"1.2.840.10045.3.1.7":return{name:"P-256"};case"1.3.132.0.34":return{name:"P-384"};case"1.3.132.0.35":return{name:"P-521"};default:}return{}}},{key:"getOIDByAlgorithm",value:function getOIDByAlgorithm(algorithm){var result="";switch(algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":switch(algorithm.hash.name.toUpperCase()){case"SHA-1":result="1.2.840.113549.1.1.5";break;case"SHA-256":result="1.2.840.113549.1.1.11";break;case"SHA-384":result="1.2.840.113549.1.1.12";break;case"SHA-512":result="1.2.840.113549.1.1.13";break;default:}break;case"RSA-PSS":result="1.2.840.113549.1.1.10";break;case"RSA-OAEP":result="1.2.840.113549.1.1.7";break;case"ECDSA":switch(algorithm.hash.name.toUpperCase()){case"SHA-1":result="1.2.840.10045.4.1";break;case"SHA-256":result="1.2.840.10045.4.3.2";break;case"SHA-384":result="1.2.840.10045.4.3.3";break;case"SHA-512":result="1.2.840.10045.4.3.4";break;default:}break;case"ECDH":switch(algorithm.kdf.toUpperCase()){case"SHA-1":result="1.3.133.16.840.63.0.2";break;case"SHA-256":result="1.3.132.1.11.1";break;case"SHA-384":result="1.3.132.1.11.2";break;case"SHA-512":result="1.3.132.1.11.3";break;default:}break;case"AES-CTR":break;case"AES-CBC":switch(algorithm.length){case 128:result="2.16.840.1.101.3.4.1.2";break;case 192:result="2.16.840.1.101.3.4.1.22";break;case 256:result="2.16.840.1.101.3.4.1.42";break;default:}break;case"AES-CMAC":break;case"AES-GCM":switch(algorithm.length){case 128:result="2.16.840.1.101.3.4.1.6";break;case 192:result="2.16.840.1.101.3.4.1.26";break;case 256:result="2.16.840.1.101.3.4.1.46";break;default:}break;case"AES-CFB":switch(algorithm.length){case 128:result="2.16.840.1.101.3.4.1.4";break;case 192:result="2.16.840.1.101.3.4.1.24";break;case 256:result="2.16.840.1.101.3.4.1.44";break;default:}break;case"AES-KW":switch(algorithm.length){case 128:result="2.16.840.1.101.3.4.1.5";break;case 192:result="2.16.840.1.101.3.4.1.25";break;case 256:result="2.16.840.1.101.3.4.1.45";break;default:}break;case"HMAC":switch(algorithm.hash.name.toUpperCase()){case"SHA-1":result="1.2.840.113549.2.7";break;case"SHA-256":result="1.2.840.113549.2.9";break;case"SHA-384":result="1.2.840.113549.2.10";break;case"SHA-512":result="1.2.840.113549.2.11";break;default:}break;case"DH":result="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":result="1.3.14.3.2.26";break;case"SHA-256":result="2.16.840.1.101.3.4.2.1";break;case"SHA-384":result="2.16.840.1.101.3.4.2.2";break;case"SHA-512":result="2.16.840.1.101.3.4.2.3";break;case"CONCAT":break;case"HKDF":break;case"PBKDF2":result="1.2.840.113549.1.5.12";break;case"P-256":result="1.2.840.10045.3.1.7";break;case"P-384":result="1.3.132.0.34";break;case"P-521":result="1.3.132.0.35";break;default:}return result}},{key:"getAlgorithmParameters",value:function getAlgorithmParameters(algorithmName,operation){var result={algorithm:{},usages:[]};switch(algorithmName.toUpperCase()){case"RSASSA-PKCS1-V1_5":switch(operation.toLowerCase()){case"generatekey":result={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":result={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(operation.toLowerCase()){case"sign":case"verify":result={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":result={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":result={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(operation.toLowerCase()){case"encrypt":case"decrypt":result={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":result={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":result={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;case"exportkey":default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(operation.toLowerCase()){case"generatekey":result={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":result={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":result={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(operation.toLowerCase()){case"exportkey":case"importkey":case"generatekey":result={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":result={algorithm:{name:"ECDH",namedCurve:"P-256",public:[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(operation.toLowerCase()){case"importkey":case"exportkey":case"generatekey":result={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":result={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(operation.toLowerCase()){case"importkey":case"exportkey":case"generatekey":result={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":result={algorithm:{name:"AES-CBC",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(operation.toLowerCase()){case"importkey":case"exportkey":case"generatekey":result={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":result={algorithm:{name:"AES-GCM",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(operation.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":result={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(operation.toLowerCase()){case"sign":case"verify":result={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":result={algorithm:{name:"HMAC",length:32,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":switch(operation.toLowerCase()){case"derivekey":result={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array([]),info:new Uint8Array([])},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"HKDF"},usages:[]}}break;case"PBKDF2":switch(operation.toLowerCase()){case"derivekey":result={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array([]),iterations:1e4},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"PBKDF2"},usages:[]}}break;default:}return result}},{key:"getHashAlgorithm",value:function getHashAlgorithm(signatureAlgorithm){var result="";switch(signatureAlgorithm.algorithmId){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":result="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":result="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":result="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":result="SHA-512";break;case"1.2.840.113549.1.1.10":{try{var params=new _RSASSAPSSParams2.default({schema:signatureAlgorithm.algorithmParams});if("hashAlgorithm"in params){var algorithm=this.getAlgorithmByOID(params.hashAlgorithm.algorithmId);if("name"in algorithm===false)return"";result=algorithm.name}else result="SHA-1"}catch(ex){}}break;default:}return result}},{key:"encryptEncryptedContentInfo",value:function encryptEncryptedContentInfo(parameters){var _this3=this;if(parameters instanceof Object===false)return Promise.reject('Parameters must have type "Object"');if("password"in parameters===false)return Promise.reject('Absent mandatory parameter "password"');if("contentEncryptionAlgorithm"in parameters===false)return Promise.reject('Absent mandatory parameter "contentEncryptionAlgorithm"');if("hmacHashAlgorithm"in parameters===false)return Promise.reject('Absent mandatory parameter "hmacHashAlgorithm"');if("iterationCount"in parameters===false)return Promise.reject('Absent mandatory parameter "iterationCount"');if("contentToEncrypt"in parameters===false)return Promise.reject('Absent mandatory parameter "contentToEncrypt"');if("contentType"in parameters===false)return Promise.reject('Absent mandatory parameter "contentType"');var contentEncryptionOID=this.getOIDByAlgorithm(parameters.contentEncryptionAlgorithm);if(contentEncryptionOID==="")return Promise.reject('Wrong "contentEncryptionAlgorithm" value');var pbkdf2OID=this.getOIDByAlgorithm({name:"PBKDF2"});if(pbkdf2OID==="")return Promise.reject("Can not find OID for PBKDF2");var hmacOID=this.getOIDByAlgorithm({name:"HMAC",hash:{name:parameters.hmacHashAlgorithm}});if(hmacOID==="")return Promise.reject('Incorrect value for "hmacHashAlgorithm": '+parameters.hmacHashAlgorithm);var sequence=Promise.resolve();var ivBuffer=new ArrayBuffer(16);var ivView=new Uint8Array(ivBuffer);this.getRandomValues(ivView);var saltBuffer=new ArrayBuffer(64);var saltView=new Uint8Array(saltBuffer);this.getRandomValues(saltView);var contentView=new Uint8Array(parameters.contentToEncrypt);var pbkdf2Params=new _PBKDF2Params2.default({salt:new asn1js.OctetString({valueHex:saltBuffer}),iterationCount:parameters.iterationCount,prf:new _AlgorithmIdentifier2.default({algorithmId:hmacOID,algorithmParams:new asn1js.Null})});sequence=sequence.then(function(){var passwordView=new Uint8Array(parameters.password);return _this3.importKey("raw",passwordView,"PBKDF2",false,["deriveKey"])},function(error){return Promise.reject(error)});sequence=sequence.then(function(result){return _this3.deriveKey({name:"PBKDF2",hash:{name:parameters.hmacHashAlgorithm},salt:saltView,iterations:parameters.iterationCount},result,parameters.contentEncryptionAlgorithm,false,["encrypt"])},function(error){return Promise.reject(error)});sequence=sequence.then(function(result){return _this3.encrypt({name:parameters.contentEncryptionAlgorithm.name,iv:ivView},result,contentView)},function(error){return Promise.reject(error)});sequence=sequence.then(function(result){var pbes2Parameters=new _PBES2Params2.default({keyDerivationFunc:new _AlgorithmIdentifier2.default({algorithmId:pbkdf2OID,algorithmParams:pbkdf2Params.toSchema()}),encryptionScheme:new _AlgorithmIdentifier2.default({algorithmId:contentEncryptionOID,algorithmParams:new asn1js.OctetString({valueHex:ivBuffer})})});return new _EncryptedContentInfo2.default({contentType:parameters.contentType,contentEncryptionAlgorithm:new _AlgorithmIdentifier2.default({algorithmId:"1.2.840.113549.1.5.13",algorithmParams:pbes2Parameters.toSchema()}),encryptedContent:new asn1js.OctetString({valueHex:result})})},function(error){return Promise.reject(error)});return sequence}},{key:"decryptEncryptedContentInfo",value:function decryptEncryptedContentInfo(parameters){var _this4=this;if(parameters instanceof Object===false)return Promise.reject('Parameters must have type "Object"');if("password"in parameters===false)return Promise.reject('Absent mandatory parameter "password"');if("encryptedContentInfo"in parameters===false)return Promise.reject('Absent mandatory parameter "encryptedContentInfo"');if(parameters.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId!=="1.2.840.113549.1.5.13")return Promise.reject('Unknown "contentEncryptionAlgorithm": '+parameters.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);var sequence=Promise.resolve();var pbes2Parameters=void 0;try{pbes2Parameters=new _PBES2Params2.default({schema:parameters.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams})}catch(ex){return Promise.reject('Incorrectly encoded "pbes2Parameters"')}var pbkdf2Params=void 0;try{pbkdf2Params=new _PBKDF2Params2.default({schema:pbes2Parameters.keyDerivationFunc.algorithmParams})}catch(ex){return Promise.reject('Incorrectly encoded "pbkdf2Params"')}var contentEncryptionAlgorithm=this.getAlgorithmByOID(pbes2Parameters.encryptionScheme.algorithmId);if("name"in contentEncryptionAlgorithm===false)return Promise.reject('Incorrect OID for "contentEncryptionAlgorithm": '+pbes2Parameters.encryptionScheme.algorithmId);var ivBuffer=pbes2Parameters.encryptionScheme.algorithmParams.valueBlock.valueHex;var ivView=new Uint8Array(ivBuffer);var saltBuffer=pbkdf2Params.salt.valueBlock.valueHex;var saltView=new Uint8Array(saltBuffer);var iterationCount=pbkdf2Params.iterationCount;var hmacHashAlgorithm="SHA-1";if("prf"in pbkdf2Params){var algorithm=this.getAlgorithmByOID(pbkdf2Params.prf.algorithmId);if("name"in algorithm===false)return Promise.reject("Incorrect OID for HMAC hash algorithm");hmacHashAlgorithm=algorithm.hash.name}sequence=sequence.then(function(){return _this4.importKey("raw",parameters.password,"PBKDF2",false,["deriveKey"])},function(error){return Promise.reject(error)});sequence=sequence.then(function(result){return _this4.deriveKey({name:"PBKDF2",hash:{name:hmacHashAlgorithm},salt:saltView,iterations:iterationCount},result,contentEncryptionAlgorithm,false,["decrypt"])},function(error){return Promise.reject(error)});sequence=sequence.then(function(result){var dataBuffer=new ArrayBuffer(0);if(parameters.encryptedContentInfo.encryptedContent.idBlock.isConstructed===false)dataBuffer=parameters.encryptedContentInfo.encryptedContent.valueBlock.valueHex;else{var _iteratorNormalCompletion7=true;var _didIteratorError7=false;var _iteratorError7=undefined;try{for(var _iterator7=parameters.encryptedContentInfo.encryptedContent.valueBlock.value[Symbol.iterator](),_step7;!(_iteratorNormalCompletion7=(_step7=_iterator7.next()).done);_iteratorNormalCompletion7=true){var content=_step7.value;dataBuffer=(0,_pvutils.utilConcatBuf)(dataBuffer,content.valueBlock.valueHex)}}catch(err){_didIteratorError7=true;_iteratorError7=err}finally{try{if(!_iteratorNormalCompletion7&&_iterator7.return){_iterator7.return()}}finally{if(_didIteratorError7){throw _iteratorError7}}}}return _this4.decrypt({name:contentEncryptionAlgorithm.name,iv:ivView},result,dataBuffer)},function(error){return Promise.reject(error)});return sequence}},{key:"stampDataWithPassword",value:function stampDataWithPassword(parameters){var _this5=this;if(parameters instanceof Object===false)return Promise.reject('Parameters must have type "Object"');if("password"in parameters===false)return Promise.reject('Absent mandatory parameter "password"');if("hashAlgorithm"in parameters===false)return Promise.reject('Absent mandatory parameter "hashAlgorithm"');if("salt"in parameters===false)return Promise.reject('Absent mandatory parameter "iterationCount"');if("iterationCount"in parameters===false)return Promise.reject('Absent mandatory parameter "salt"');if("contentToStamp"in parameters===false)return Promise.reject('Absent mandatory parameter "contentToStamp"');var length=void 0;switch(parameters.hashAlgorithm.toLowerCase()){case"sha-1":length=160;break;case"sha-256":length=256;break;case"sha-384":length=384;break;case"sha-512":length=512;break;default:return Promise.reject('Incorrect "parameters.hashAlgorithm" parameter: '+parameters.hashAlgorithm)}var sequence=Promise.resolve();var hmacAlgorithm={name:"HMAC",length:length,hash:{name:parameters.hashAlgorithm}};sequence=sequence.then(function(){return makePKCS12B2Key(_this5,parameters.hashAlgorithm,length,parameters.password,parameters.salt,parameters.iterationCount)});sequence=sequence.then(function(result){return _this5.importKey("raw",new Uint8Array(result),hmacAlgorithm,false,["sign"])});sequence=sequence.then(function(result){return _this5.sign(hmacAlgorithm,result,new Uint8Array(parameters.contentToStamp))},function(error){return Promise.reject(error)});return sequence}},{key:"verifyDataStampedWithPassword",value:function verifyDataStampedWithPassword(parameters){var _this6=this;if(parameters instanceof Object===false)return Promise.reject('Parameters must have type "Object"');if("password"in parameters===false)return Promise.reject('Absent mandatory parameter "password"');if("hashAlgorithm"in parameters===false)return Promise.reject('Absent mandatory parameter "hashAlgorithm"');if("salt"in parameters===false)return Promise.reject('Absent mandatory parameter "iterationCount"');if("iterationCount"in parameters===false)return Promise.reject('Absent mandatory parameter "salt"');if("contentToVerify"in parameters===false)return Promise.reject('Absent mandatory parameter "contentToVerify"');if("signatureToVerify"in parameters===false)return Promise.reject('Absent mandatory parameter "signatureToVerify"');var length=void 0;switch(parameters.hashAlgorithm.toLowerCase()){case"sha-1":length=160;break;case"sha-256":length=256;break;case"sha-384":length=384;break;case"sha-512":length=512;break;default:return Promise.reject('Incorrect "parameters.hashAlgorithm" parameter: '+parameters.hashAlgorithm)}var sequence=Promise.resolve();var hmacAlgorithm={name:"HMAC",length:length,hash:{name:parameters.hashAlgorithm}};sequence=sequence.then(function(){return makePKCS12B2Key(_this6,parameters.hashAlgorithm,length,parameters.password,parameters.salt,parameters.iterationCount)});sequence=sequence.then(function(result){return _this6.importKey("raw",new Uint8Array(result),hmacAlgorithm,false,["verify"])});sequence=sequence.then(function(result){return _this6.verify(hmacAlgorithm,result,new Uint8Array(parameters.signatureToVerify),new Uint8Array(parameters.contentToVerify))},function(error){return Promise.reject(error)});return sequence}},{key:"getSignatureParameters",value:function getSignatureParameters(privateKey){var hashAlgorithm=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"SHA-1";var oid=this.getOIDByAlgorithm({name:hashAlgorithm});if(oid==="")return Promise.reject("Unsupported hash algorithm: "+hashAlgorithm);var signatureAlgorithm=new _AlgorithmIdentifier2.default;var parameters=this.getAlgorithmParameters(privateKey.algorithm.name,"sign");parameters.algorithm.hash.name=hashAlgorithm;switch(privateKey.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":signatureAlgorithm.algorithmId=this.getOIDByAlgorithm(parameters.algorithm);break;case"RSA-PSS":{switch(hashAlgorithm.toUpperCase()){case"SHA-256":parameters.algorithm.saltLength=32;break;case"SHA-384":parameters.algorithm.saltLength=48;break;case"SHA-512":parameters.algorithm.saltLength=64;break;default:}var paramsObject={};if(hashAlgorithm.toUpperCase()!=="SHA-1"){var hashAlgorithmOID=this.getOIDByAlgorithm({name:hashAlgorithm});if(hashAlgorithmOID==="")return Promise.reject("Unsupported hash algorithm: "+hashAlgorithm);paramsObject.hashAlgorithm=new _AlgorithmIdentifier2.default({algorithmId:hashAlgorithmOID,algorithmParams:new asn1js.Null});paramsObject.maskGenAlgorithm=new _AlgorithmIdentifier2.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:paramsObject.hashAlgorithm.toSchema()})}if(parameters.algorithm.saltLength!==20)paramsObject.saltLength=parameters.algorithm.saltLength;var pssParameters=new _RSASSAPSSParams2.default(paramsObject);signatureAlgorithm.algorithmId="1.2.840.113549.1.1.10";signatureAlgorithm.algorithmParams=pssParameters.toSchema()}break;default:return Promise.reject("Unsupported signature algorithm: "+privateKey.algorithm.name)}return Promise.resolve().then(function(){return{signatureAlgorithm:signatureAlgorithm,parameters:parameters}})}},{key:"signWithPrivateKey",value:function signWithPrivateKey(data,privateKey,parameters){return this.sign(parameters.algorithm,privateKey,new Uint8Array(data)).then(function(result){if(parameters.algorithm.name==="ECDSA")result=(0,_common.createCMSECDSASignature)(result);return result},function(error){return Promise.reject("Signing error: "+error)})}},{key:"fillPublicKeyParameters",value:function fillPublicKeyParameters(publicKeyInfo,signatureAlgorithm){var parameters={};var shaAlgorithm=this.getHashAlgorithm(signatureAlgorithm);if(shaAlgorithm==="")return Promise.reject("Unsupported signature algorithm: "+signatureAlgorithm.algorithmId);var algorithmId=void 0;if(signatureAlgorithm.algorithmId==="1.2.840.113549.1.1.10")algorithmId=signatureAlgorithm.algorithmId;else algorithmId=publicKeyInfo.algorithm.algorithmId;var algorithmObject=this.getAlgorithmByOID(algorithmId);if("name"in algorithmObject==="")return Promise.reject("Unsupported public key algorithm: "+signatureAlgorithm.algorithmId);parameters.algorithm=this.getAlgorithmParameters(algorithmObject.name,"importkey");if("hash"in parameters.algorithm.algorithm)parameters.algorithm.algorithm.hash.name=shaAlgorithm;if(algorithmObject.name==="ECDSA"){var algorithmParamsChecked=false;if("algorithmParams"in publicKeyInfo.algorithm===true){if("idBlock"in publicKeyInfo.algorithm.algorithmParams){if(publicKeyInfo.algorithm.algorithmParams.idBlock.tagClass===1&&publicKeyInfo.algorithm.algorithmParams.idBlock.tagNumber===6)algorithmParamsChecked=true}}if(algorithmParamsChecked===false)return Promise.reject("Incorrect type for ECDSA public key parameters");var curveObject=this.getAlgorithmByOID(publicKeyInfo.algorithm.algorithmParams.valueBlock.toString());if("name"in curveObject===false)return Promise.reject("Unsupported named curve algorithm: "+publicKeyInfo.algorithm.algorithmParams.valueBlock.toString());parameters.algorithm.algorithm.namedCurve=curveObject.name}return parameters}},{key:"getPublicKey",value:function getPublicKey(publicKeyInfo,signatureAlgorithm){var parameters=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(parameters===null)parameters=this.fillPublicKeyParameters(publicKeyInfo,signatureAlgorithm);var publicKeyInfoSchema=publicKeyInfo.toSchema();var publicKeyInfoBuffer=publicKeyInfoSchema.toBER(false);var publicKeyInfoView=new Uint8Array(publicKeyInfoBuffer);return this.importKey("spki",publicKeyInfoView,parameters.algorithm.algorithm,true,parameters.algorithm.usages)}},{key:"verifyWithPublicKey",value:function verifyWithPublicKey(data,signature,publicKeyInfo,signatureAlgorithm){var _this7=this;var shaAlgorithm=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;var sequence=Promise.resolve();if(shaAlgorithm===null){shaAlgorithm=this.getHashAlgorithm(signatureAlgorithm);if(shaAlgorithm==="")return Promise.reject("Unsupported signature algorithm: "+signatureAlgorithm.algorithmId);sequence=sequence.then(function(){return _this7.getPublicKey(publicKeyInfo,signatureAlgorithm)})}else{var parameters={};var algorithmId=void 0;if(signatureAlgorithm.algorithmId==="1.2.840.113549.1.1.10")algorithmId=signatureAlgorithm.algorithmId;else algorithmId=publicKeyInfo.algorithm.algorithmId;var algorithmObject=this.getAlgorithmByOID(algorithmId);if("name"in algorithmObject==="")return Promise.reject("Unsupported public key algorithm: "+signatureAlgorithm.algorithmId);parameters.algorithm=this.getAlgorithmParameters(algorithmObject.name,"importkey");if("hash"in parameters.algorithm.algorithm)parameters.algorithm.algorithm.hash.name=shaAlgorithm;if(algorithmObject.name==="ECDSA"){var algorithmParamsChecked=false;if("algorithmParams"in publicKeyInfo.algorithm===true){if("idBlock"in publicKeyInfo.algorithm.algorithmParams){if(publicKeyInfo.algorithm.algorithmParams.idBlock.tagClass===1&&publicKeyInfo.algorithm.algorithmParams.idBlock.tagNumber===6)algorithmParamsChecked=true}}if(algorithmParamsChecked===false)return Promise.reject("Incorrect type for ECDSA public key parameters");var curveObject=this.getAlgorithmByOID(publicKeyInfo.algorithm.algorithmParams.valueBlock.toString());if("name"in curveObject===false)return Promise.reject("Unsupported named curve algorithm: "+publicKeyInfo.algorithm.algorithmParams.valueBlock.toString());parameters.algorithm.algorithm.namedCurve=curveObject.name}sequence=sequence.then(function(){return _this7.getPublicKey(publicKeyInfo,null,parameters)})}sequence=sequence.then(function(publicKey){var algorithm=_this7.getAlgorithmParameters(publicKey.algorithm.name,"verify");if("hash"in algorithm.algorithm)algorithm.algorithm.hash.name=shaAlgorithm;var signatureValue=signature.valueBlock.valueHex;if(publicKey.algorithm.name==="ECDSA"){var asn1=asn1js.fromBER(signatureValue);signatureValue=(0,_common.createECDSASignatureFromCMS)(asn1.result)}if(publicKey.algorithm.name==="RSA-PSS"){var pssParameters=void 0;try{pssParameters=new _RSASSAPSSParams2.default({schema:signatureAlgorithm.algorithmParams})}catch(ex){return Promise.reject(ex)}if("saltLength"in pssParameters)algorithm.algorithm.saltLength=pssParameters.saltLength;else algorithm.algorithm.saltLength=20;var hashAlgo="SHA-1";if("hashAlgorithm"in pssParameters){var hashAlgorithm=_this7.getAlgorithmByOID(pssParameters.hashAlgorithm.algorithmId);if("name"in hashAlgorithm===false)return Promise.reject("Unrecognized hash algorithm: "+pssParameters.hashAlgorithm.algorithmId);hashAlgo=hashAlgorithm.name}algorithm.algorithm.hash.name=hashAlgo}return _this7.verify(algorithm.algorithm,publicKey,new Uint8Array(signatureValue),new Uint8Array(data))});return sequence}}]);return CryptoEngine}();exports.default=CryptoEngine},{"./AlgorithmIdentifier.js":3,"./EncryptedContentInfo.js":31,"./PBES2Params.js":62,"./PBKDF2Params.js":63,"./PrivateKeyInfo.js":73,"./PublicKeyInfo.js":75,"./RSASSAPSSParams.js":79,"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var DigestInfo=function(){function DigestInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,DigestInfo);this.digestAlgorithm=(0,_pvutils.getParametersValue)(parameters,"digestAlgorithm",DigestInfo.defaultValues("digestAlgorithm"));this.digest=(0,_pvutils.getParametersValue)(parameters,"digest",DigestInfo.defaultValues("digest"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(DigestInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,DigestInfo.schema({names:{digestAlgorithm:{names:{blockName:"digestAlgorithm"}},digest:"digest"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for DigestInfo");this.digestAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.digestAlgorithm});this.digest=asn1.result.digest}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[this.digestAlgorithm.toSchema(),this.digest]})}},{key:"toJSON",value:function toJSON(){return{digestAlgorithm:this.digestAlgorithm.toJSON(),digest:this.digest.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"digestAlgorithm":return new _AlgorithmIdentifier2.default;case"digest":return new asn1js.OctetString;default:throw new Error("Invalid member name for DigestInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"digestAlgorithm":return _AlgorithmIdentifier2.default.compareWithDefault("algorithmId",memberValue.algorithmId)&&"algorithmParams"in memberValue===false;case"digest":return memberValue.isEqual(DigestInfo.defaultValues(memberName));default:throw new Error("Invalid member name for DigestInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_AlgorithmIdentifier2.default.schema(names.digestAlgorithm||{names:{blockName:"digestAlgorithm"}}),new asn1js.OctetString({name:names.digest||"digest"})]})}}]);return DigestInfo}();exports.default=DigestInfo},{"./AlgorithmIdentifier.js":3,asn1js:"asn1js",pvutils:"pvutils"}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _GeneralName=require("./GeneralName.js");var _GeneralName2=_interopRequireDefault(_GeneralName);var _RelativeDistinguishedNames=require("./RelativeDistinguishedNames.js");var _RelativeDistinguishedNames2=_interopRequireDefault(_RelativeDistinguishedNames);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var DistributionPoint=function(){function DistributionPoint(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,DistributionPoint);if("distributionPoint"in parameters)this.distributionPoint=(0,_pvutils.getParametersValue)(parameters,"distributionPoint",DistributionPoint.defaultValues("distributionPoint"));if("reasons"in parameters)this.reasons=(0,_pvutils.getParametersValue)(parameters,"reasons",DistributionPoint.defaultValues("reasons"));if("cRLIssuer"in parameters)this.cRLIssuer=(0,_pvutils.getParametersValue)(parameters,"cRLIssuer",DistributionPoint.defaultValues("cRLIssuer"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(DistributionPoint,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,DistributionPoint.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",reasons:"reasons",cRLIssuer:"cRLIssuer",cRLIssuerNames:"cRLIssuerNames"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for DistributionPoint");if("distributionPoint"in asn1.result){if(asn1.result.distributionPoint.idBlock.tagNumber===0)this.distributionPoint=Array.from(asn1.result.distributionPointNames,function(element){return new _GeneralName2.default({schema:element})});if(asn1.result.distributionPoint.idBlock.tagNumber===1){asn1.result.distributionPoint.idBlock.tagClass=1;asn1.result.distributionPoint.idBlock.tagNumber=16;this.distributionPoint=new _RelativeDistinguishedNames2.default({schema:asn1.result.distributionPoint})}}if("reasons"in asn1.result)this.reasons=new asn1js.BitString({valueHex:asn1.result.reasons.valueBlock.valueHex});if("cRLIssuer"in asn1.result)this.cRLIssuer=Array.from(asn1.result.cRLIssuerNames,function(element){return new _GeneralName2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var outputArray=[];if("distributionPoint"in this){var internalValue=void 0;if(this.distributionPoint instanceof Array){internalValue=new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,function(element){return element.toSchema()})})}else{internalValue=new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[this.distributionPoint.toSchema()]})}outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[internalValue]}))}if("reasons"in this){outputArray.push(new asn1js.Primitive({idBlock:{tagClass:3,tagNumber:1},valueHex:this.reasons.valueBlock.valueHex}))}if("cRLIssuer"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:2},value:Array.from(this.cRLIssuer,function(element){return element.toSchema()})}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={};if("distributionPoint"in this){if(this.distributionPoint instanceof Array)object.distributionPoint=Array.from(this.distributionPoint,function(element){return element.toJSON()});else object.distributionPoint=this.distributionPoint.toJSON()}if("reasons"in this)object.reasons=this.reasons.toJSON();if("cRLIssuer"in this)object.cRLIssuer=Array.from(this.cRLIssuer,function(element){return element.toJSON()});return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"distributionPoint":return[];case"reasons":return new asn1js.BitString;case"cRLIssuer":return[];default:throw new Error("Invalid member name for DistributionPoint class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Choice({value:[new asn1js.Constructed({name:names.distributionPoint||"",optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Repeated({name:names.distributionPointNames||"",value:_GeneralName2.default.schema()})]}),new asn1js.Constructed({name:names.distributionPoint||"",optional:true,idBlock:{tagClass:3,tagNumber:1},value:_RelativeDistinguishedNames2.default.schema().valueBlock.value})]})]}),new asn1js.Primitive({name:names.reasons||"",optional:true,idBlock:{tagClass:3,tagNumber:1}}),new asn1js.Constructed({name:names.cRLIssuer||"",optional:true,idBlock:{tagClass:3,tagNumber:2},value:[new asn1js.Repeated({name:names.cRLIssuerNames||"",value:_GeneralName2.default.schema()})]})]})}}]);return DistributionPoint}();exports.default=DistributionPoint},{"./GeneralName.js":37,"./RelativeDistinguishedNames.js":85,asn1js:"asn1js",pvutils:"pvutils"}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ECCCMSSharedInfo=function(){function ECCCMSSharedInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,ECCCMSSharedInfo);this.keyInfo=(0,_pvutils.getParametersValue)(parameters,"keyInfo",ECCCMSSharedInfo.defaultValues("keyInfo"));if("entityUInfo"in parameters)this.entityUInfo=(0,_pvutils.getParametersValue)(parameters,"entityUInfo",ECCCMSSharedInfo.defaultValues("entityUInfo"));this.suppPubInfo=(0,_pvutils.getParametersValue)(parameters,"suppPubInfo",ECCCMSSharedInfo.defaultValues("suppPubInfo"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(ECCCMSSharedInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,ECCCMSSharedInfo.schema({names:{keyInfo:{names:{blockName:"keyInfo"}},entityUInfo:"entityUInfo",suppPubInfo:"suppPubInfo"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for ECC_CMS_SharedInfo");this.keyInfo=new _AlgorithmIdentifier2.default({schema:asn1.result.keyInfo});if("entityUInfo"in asn1.result)this.entityUInfo=asn1.result.entityUInfo.valueBlock.value[0];this.suppPubInfo=asn1.result.suppPubInfo.valueBlock.value[0]}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(this.keyInfo.toSchema());if("entityUInfo"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.entityUInfo]}))}outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:2},value:[this.suppPubInfo]}));return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={keyInfo:this.keyInfo.toJSON()};if("entityUInfo"in this)_object.entityUInfo=this.entityUInfo.toJSON();_object.suppPubInfo=this.suppPubInfo.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"keyInfo":return new _AlgorithmIdentifier2.default;case"entityUInfo":return new asn1js.OctetString;case"suppPubInfo":return new asn1js.OctetString;default:throw new Error("Invalid member name for ECCCMSSharedInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"keyInfo":case"entityUInfo":case"suppPubInfo":return memberValue.isEqual(ECCCMSSharedInfo.defaultValues(memberName));default:throw new Error("Invalid member name for ECCCMSSharedInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_AlgorithmIdentifier2.default.schema(names.keyInfo||{}),new asn1js.Constructed({name:names.entityUInfo||"",idBlock:{tagClass:3,tagNumber:0},optional:true,value:[new asn1js.OctetString]}),new asn1js.Constructed({name:names.suppPubInfo||"",idBlock:{tagClass:3,tagNumber:2},value:[new asn1js.OctetString]})]})}}]);return ECCCMSSharedInfo}();exports.default=ECCCMSSharedInfo},{"./AlgorithmIdentifier.js":3,asn1js:"asn1js",pvutils:"pvutils"}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _ECPublicKey=require("./ECPublicKey.js");var _ECPublicKey2=_interopRequireDefault(_ECPublicKey);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ECPrivateKey=function(){function ECPrivateKey(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,ECPrivateKey);this.version=(0,_pvutils.getParametersValue)(parameters,"version",ECPrivateKey.defaultValues("version"));this.privateKey=(0,_pvutils.getParametersValue)(parameters,"privateKey",ECPrivateKey.defaultValues("privateKey"));if("namedCurve"in parameters)this.namedCurve=(0,_pvutils.getParametersValue)(parameters,"namedCurve",ECPrivateKey.defaultValues("namedCurve"));if("publicKey"in parameters)this.publicKey=(0,_pvutils.getParametersValue)(parameters,"publicKey",ECPrivateKey.defaultValues("publicKey"));if("schema"in parameters)this.fromSchema(parameters.schema);if("json"in parameters)this.fromJSON(parameters.json)}_createClass(ECPrivateKey,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,ECPrivateKey.schema({names:{version:"version",privateKey:"privateKey",namedCurve:"namedCurve",publicKey:"publicKey"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for ECPrivateKey");this.version=asn1.result.version.valueBlock.valueDec;this.privateKey=asn1.result.privateKey;if("namedCurve"in asn1.result)this.namedCurve=asn1.result.namedCurve.valueBlock.toString();if("publicKey"in asn1.result){var publicKeyData={schema:asn1.result.publicKey.valueBlock.valueHex};if("namedCurve"in this)publicKeyData.namedCurve=this.namedCurve;this.publicKey=new _ECPublicKey2.default(publicKeyData)}}},{key:"toSchema",value:function toSchema(){var outputArray=[new asn1js.Integer({value:this.version}),this.privateKey];if("namedCurve"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.ObjectIdentifier({value:this.namedCurve})]}))}if("publicKey"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.BitString({valueHex:this.publicKey.toSchema().toBER(false)})]}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){if("namedCurve"in this===false||ECPrivateKey.compareWithDefault("namedCurve",this.namedCurve))throw new Error('Not enough information for making JSON: absent "namedCurve" value');var crvName="";switch(this.namedCurve){case"1.2.840.10045.3.1.7":crvName="P-256";break;case"1.3.132.0.34":crvName="P-384";break;case"1.3.132.0.35":crvName="P-521";break;default:}var privateKeyJSON={crv:crvName,d:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.privateKey.valueBlock.valueHex),true,true,false)};if("publicKey"in this){var publicKeyJSON=this.publicKey.toJSON();privateKeyJSON.x=publicKeyJSON.x;privateKeyJSON.y=publicKeyJSON.y}return privateKeyJSON}},{key:"fromJSON",value:function fromJSON(json){var coodinateLength=0;if("crv"in json){switch(json.crv.toUpperCase()){case"P-256":this.namedCurve="1.2.840.10045.3.1.7";coodinateLength=32;break;case"P-384":this.namedCurve="1.3.132.0.34";coodinateLength=48;break;case"P-521":this.namedCurve="1.3.132.0.35";coodinateLength=66;break;default:}}else throw new Error('Absent mandatory parameter "crv"');if("d"in json){var convertBuffer=(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.d,true));if(convertBuffer.byteLength<coodinateLength){var buffer=new ArrayBuffer(coodinateLength);var view=new Uint8Array(buffer);var convertBufferView=new Uint8Array(convertBuffer);view.set(convertBufferView,1);this.privateKey=new asn1js.OctetString({valueHex:buffer})}else this.privateKey=new asn1js.OctetString({valueHex:convertBuffer.slice(0,coodinateLength)})}else throw new Error('Absent mandatory parameter "d"');if("x"in json&&"y"in json)this.publicKey=new _ECPublicKey2.default({json:json})}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 1;case"privateKey":return new asn1js.OctetString;case"namedCurve":return"";case"publicKey":return new _ECPublicKey2.default;default:throw new Error("Invalid member name for ECCPrivateKey class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"version":return memberValue===ECPrivateKey.defaultValues(memberName);case"privateKey":return memberValue.isEqual(ECPrivateKey.defaultValues(memberName));case"namedCurve":return memberValue==="";case"publicKey":return _ECPublicKey2.default.compareWithDefault("namedCurve",memberValue.namedCurve)&&_ECPublicKey2.default.compareWithDefault("x",memberValue.x)&&_ECPublicKey2.default.compareWithDefault("y",memberValue.y);default:throw new Error("Invalid member name for ECCPrivateKey class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.version||""}),new asn1js.OctetString({name:names.privateKey||""}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.ObjectIdentifier({name:names.namedCurve||""})]}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.BitString({name:names.publicKey||""})]})]})}}]);return ECPrivateKey}();exports.default=ECPrivateKey},{"./ECPublicKey.js":29,asn1js:"asn1js",pvutils:"pvutils"}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ECPublicKey=function(){function ECPublicKey(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,ECPublicKey);this.x=(0,_pvutils.getParametersValue)(parameters,"x",ECPublicKey.defaultValues("x"));this.y=(0,_pvutils.getParametersValue)(parameters,"y",ECPublicKey.defaultValues("y"));this.namedCurve=(0,_pvutils.getParametersValue)(parameters,"namedCurve",ECPublicKey.defaultValues("namedCurve"));if("schema"in parameters)this.fromSchema(parameters.schema);if("json"in parameters)this.fromJSON(parameters.json)}_createClass(ECPublicKey,[{key:"fromSchema",value:function fromSchema(schema){if(schema instanceof ArrayBuffer===false)throw new Error("Object's schema was not verified against input data for ECPublicKey");var view=new Uint8Array(schema);if(view[0]!==4)throw new Error("Object's schema was not verified against input data for ECPublicKey");var coordinateLength=void 0;switch(this.namedCurve){case"1.2.840.10045.3.1.7":coordinateLength=32;break;case"1.3.132.0.34":coordinateLength=48;break;case"1.3.132.0.35":coordinateLength=66;break;default:throw new Error("Incorrect curve OID: "+this.namedCurve)}if(schema.byteLength!==coordinateLength*2+1)throw new Error("Object's schema was not verified against input data for ECPublicKey");this.x=schema.slice(1,coordinateLength+1);this.y=schema.slice(1+coordinateLength,coordinateLength*2+1)}},{key:"toSchema",value:function toSchema(){return new asn1js.RawData({data:(0,_pvutils.utilConcatBuf)(new Uint8Array([4]).buffer,this.x,this.y)})}},{key:"toJSON",value:function toJSON(){var crvName="";switch(this.namedCurve){case"1.2.840.10045.3.1.7":crvName="P-256";break;case"1.3.132.0.34":crvName="P-384";break;case"1.3.132.0.35":crvName="P-521";break;default:}return{crv:crvName,x:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.x),true,true,false),y:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.y),true,true,false)}}},{key:"fromJSON",value:function fromJSON(json){var coodinateLength=0;if("crv"in json){switch(json.crv.toUpperCase()){case"P-256":this.namedCurve="1.2.840.10045.3.1.7";coodinateLength=32;break;case"P-384":this.namedCurve="1.3.132.0.34";coodinateLength=48;break;case"P-521":this.namedCurve="1.3.132.0.35";coodinateLength=66;break;default:}}else throw new Error('Absent mandatory parameter "crv"');if("x"in json){var convertBuffer=(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.x,true));if(convertBuffer.byteLength<coodinateLength){this.x=new ArrayBuffer(coodinateLength);var view=new Uint8Array(this.x);var convertBufferView=new Uint8Array(convertBuffer);view.set(convertBufferView,1)}else this.x=convertBuffer.slice(0,coodinateLength)}else throw new Error('Absent mandatory parameter "x"');if("y"in json){var _convertBuffer=(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.y,true));if(_convertBuffer.byteLength<coodinateLength){this.y=new ArrayBuffer(coodinateLength);var _view=new Uint8Array(this.y);var _convertBufferView=new Uint8Array(_convertBuffer);_view.set(_convertBufferView,1)}else this.y=_convertBuffer.slice(0,coodinateLength)}else throw new Error('Absent mandatory parameter "y"')}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"x":case"y":return new ArrayBuffer(0);case"namedCurve":return"";default:throw new Error("Invalid member name for ECCPublicKey class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"x":case"y":return(0,_pvutils.isEqualBuffer)(memberValue,ECPublicKey.defaultValues(memberName));case"namedCurve":return memberValue==="";default:throw new Error("Invalid member name for ECCPublicKey class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return new asn1js.RawData}}]);return ECPublicKey}();exports.default=ECPublicKey},{asn1js:"asn1js",pvutils:"pvutils"}],30:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var EncapsulatedContentInfo=function(){function EncapsulatedContentInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,EncapsulatedContentInfo);this.eContentType=(0,_pvutils.getParametersValue)(parameters,"eContentType",EncapsulatedContentInfo.defaultValues("eContentType"));if("eContent"in parameters){this.eContent=(0,_pvutils.getParametersValue)(parameters,"eContent",EncapsulatedContentInfo.defaultValues("eContent"));if(this.eContent.idBlock.tagClass===1&&this.eContent.idBlock.tagNumber===4){if(this.eContent.idBlock.isConstructed===false){var constrString=new asn1js.OctetString({idBlock:{isConstructed:true},isConstructed:true});var offset=0;var length=this.eContent.valueBlock.valueHex.byteLength;while(length>0){var pieceView=new Uint8Array(this.eContent.valueBlock.valueHex,offset,offset+65536>this.eContent.valueBlock.valueHex.byteLength?this.eContent.valueBlock.valueHex.byteLength-offset:65536);var _array=new ArrayBuffer(pieceView.length);var _view=new Uint8Array(_array);for(var i=0;i<_view.length;i++){_view[i]=pieceView[i]}constrString.valueBlock.value.push(new asn1js.OctetString({valueHex:_array}));length-=pieceView.length;offset+=pieceView.length}this.eContent=constrString}}}if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(EncapsulatedContentInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,EncapsulatedContentInfo.schema({names:{eContentType:"eContentType",eContent:"eContent"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for EncapsulatedContentInfo");this.eContentType=asn1.result.eContentType.valueBlock.toString();if("eContent"in asn1.result)this.eContent=asn1.result.eContent}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(new asn1js.ObjectIdentifier({value:this.eContentType}));if("eContent"in this){if(EncapsulatedContentInfo.compareWithDefault("eContent",this.eContent)===false){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[this.eContent]}))}}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={eContentType:this.eContentType};if("eContent"in this){if(EncapsulatedContentInfo.compareWithDefault("eContent",this.eContent)===false)_object.eContent=this.eContent.toJSON()}return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"eContentType":return"";case"eContent":return new asn1js.OctetString;default:throw new Error("Invalid member name for EncapsulatedContentInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"eContentType":return memberValue==="";case"eContent":{if(memberValue.idBlock.tagClass===1&&memberValue.idBlock.tagNumber===4)return memberValue.isEqual(EncapsulatedContentInfo.defaultValues("eContent"));return false}default:throw new Error("Invalid member name for EncapsulatedContentInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.eContentType||""}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Any({name:names.eContent||""})]})]})}}]);return EncapsulatedContentInfo}();exports.default=EncapsulatedContentInfo},{asn1js:"asn1js",pvutils:"pvutils"}],31:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var EncryptedContentInfo=function(){function EncryptedContentInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,EncryptedContentInfo);this.contentType=(0,_pvutils.getParametersValue)(parameters,"contentType",EncryptedContentInfo.defaultValues("contentType"));this.contentEncryptionAlgorithm=(0,_pvutils.getParametersValue)(parameters,"contentEncryptionAlgorithm",EncryptedContentInfo.defaultValues("contentEncryptionAlgorithm"));if("encryptedContent"in parameters){this.encryptedContent=parameters.encryptedContent;if(this.encryptedContent.idBlock.tagClass===1&&this.encryptedContent.idBlock.tagNumber===4){if(this.encryptedContent.idBlock.isConstructed===false){var constrString=new asn1js.OctetString({idBlock:{isConstructed:true},isConstructed:true});var offset=0;var length=this.encryptedContent.valueBlock.valueHex.byteLength;while(length>0){var pieceView=new Uint8Array(this.encryptedContent.valueBlock.valueHex,offset,offset+1024>this.encryptedContent.valueBlock.valueHex.byteLength?this.encryptedContent.valueBlock.valueHex.byteLength-offset:1024);var _array=new ArrayBuffer(pieceView.length);var _view=new Uint8Array(_array);for(var i=0;i<_view.length;i++){_view[i]=pieceView[i]}constrString.valueBlock.value.push(new asn1js.OctetString({valueHex:_array}));length-=pieceView.length;offset+=pieceView.length}this.encryptedContent=constrString}}}if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(EncryptedContentInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,EncryptedContentInfo.schema({names:{contentType:"contentType",contentEncryptionAlgorithm:{names:{blockName:"contentEncryptionAlgorithm"}},encryptedContent:"encryptedContent"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for EncryptedContentInfo");this.contentType=asn1.result.contentType.valueBlock.toString();this.contentEncryptionAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.contentEncryptionAlgorithm});if("encryptedContent"in asn1.result){this.encryptedContent=asn1.result.encryptedContent;this.encryptedContent.idBlock.tagClass=1;this.encryptedContent.idBlock.tagNumber=4}}},{key:"toSchema",value:function toSchema(){var sequenceLengthBlock={isIndefiniteForm:false};var outputArray=[];outputArray.push(new asn1js.ObjectIdentifier({value:this.contentType}));outputArray.push(this.contentEncryptionAlgorithm.toSchema());if("encryptedContent"in this){sequenceLengthBlock.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed;var encryptedValue=this.encryptedContent;encryptedValue.idBlock.tagClass=3;encryptedValue.idBlock.tagNumber=0;encryptedValue.lenBlock.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed;outputArray.push(encryptedValue)}return new asn1js.Sequence({lenBlock:sequenceLengthBlock,value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={contentType:this.contentType,contentEncryptionAlgorithm:this.contentEncryptionAlgorithm.toJSON()};if("encryptedContent"in this)_object.encryptedContent=this.encryptedContent.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"contentType":return"";case"contentEncryptionAlgorithm":return new _AlgorithmIdentifier2.default;case"encryptedContent":return new asn1js.OctetString;default:throw new Error("Invalid member name for EncryptedContentInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"contentType":return memberValue==="";case"contentEncryptionAlgorithm":return memberValue.algorithmId===""&&"algorithmParams"in memberValue===false;case"encryptedContent":return memberValue.isEqual(EncryptedContentInfo.defaultValues(memberName));default:throw new Error("Invalid member name for EncryptedContentInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.contentType||""}),_AlgorithmIdentifier2.default.schema(names.contentEncryptionAlgorithm||{}),new asn1js.Choice({value:[new asn1js.Constructed({name:names.encryptedContent||"",idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Repeated({value:new asn1js.OctetString})]}),new asn1js.Primitive({name:names.encryptedContent||"",idBlock:{tagClass:3,tagNumber:0}})]})]})}}]);return EncryptedContentInfo}();exports.default=EncryptedContentInfo},{"./AlgorithmIdentifier.js":3,asn1js:"asn1js",pvutils:"pvutils"}],32:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");var _EncryptedContentInfo=require("./EncryptedContentInfo.js");var _EncryptedContentInfo2=_interopRequireDefault(_EncryptedContentInfo);var _Attribute=require("./Attribute.js");var _Attribute2=_interopRequireDefault(_Attribute);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var EncryptedData=function(){function EncryptedData(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,EncryptedData);this.version=(0,_pvutils.getParametersValue)(parameters,"version",EncryptedData.defaultValues("version"));this.encryptedContentInfo=(0,_pvutils.getParametersValue)(parameters,"encryptedContentInfo",EncryptedData.defaultValues("encryptedContentInfo"));if("unprotectedAttrs"in parameters)this.unprotectedAttrs=(0,_pvutils.getParametersValue)(parameters,"unprotectedAttrs",EncryptedData.defaultValues("unprotectedAttrs"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(EncryptedData,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,EncryptedData.schema({names:{version:"version",encryptedContentInfo:{names:{blockName:"encryptedContentInfo"}},unprotectedAttrs:"unprotectedAttrs"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CMS_ENCRYPTED_DATA");this.version=asn1.result.version.valueBlock.valueDec;this.encryptedContentInfo=new _EncryptedContentInfo2.default({schema:asn1.result.encryptedContentInfo});if("unprotectedAttrs"in asn1.result)this.unprotectedAttrs=Array.from(asn1.result.unprotectedAttrs,function(element){return new _Attribute2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(new asn1js.Integer({value:this.version}));outputArray.push(this.encryptedContentInfo.toSchema());if("unprotectedAttrs"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,function(element){return element.toSchema()})}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={version:this.version,encryptedContentInfo:this.encryptedContentInfo.toJSON()};if("unprotectedAttrs"in this)_object.unprotectedAttrs=Array.from(this.unprotectedAttrs,function(element){return element.toJSON()});return _object}},{key:"encrypt",value:function encrypt(parameters){var _this=this;if(parameters instanceof Object===false)return Promise.reject('Parameters must have type "Object"');var engine=(0,_common.getEngine)();if(typeof engine==="undefined")return Promise.reject("Unable to initialize cryptographic engine");parameters.contentType="1.2.840.113549.1.7.1";if("encryptEncryptedContentInfo"in engine.subtle){return engine.subtle.encryptEncryptedContentInfo(parameters).then(function(result){_this.encryptedContentInfo=result})}return Promise.reject('No support for "encryptEncryptedContentInfo" in current crypto engine '+engine.name)}},{key:"decrypt",value:function decrypt(parameters){if(parameters instanceof Object===false)return Promise.reject('Parameters must have type "Object"');var engine=(0,_common.getEngine)();if(typeof engine==="undefined")return Promise.reject("Unable to initialize cryptographic engine");parameters.encryptedContentInfo=this.encryptedContentInfo;if("decryptEncryptedContentInfo"in engine.subtle)return engine.subtle.decryptEncryptedContentInfo(parameters);return Promise.reject('No support for "decryptEncryptedContentInfo" in current crypto engine '+engine.name)}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 0;case"encryptedContentInfo":return new _EncryptedContentInfo2.default;case"unprotectedAttrs":return[];default:throw new Error("Invalid member name for EncryptedData class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"version":return memberValue===0;case"encryptedContentInfo":return _EncryptedContentInfo2.default.compareWithDefault("contentType",memberValue.contentType)&&_EncryptedContentInfo2.default.compareWithDefault("contentEncryptionAlgorithm",memberValue.contentEncryptionAlgorithm)&&_EncryptedContentInfo2.default.compareWithDefault("encryptedContent",memberValue.encryptedContent);case"unprotectedAttrs":return memberValue.length===0;default:throw new Error("Invalid member name for EncryptedData class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.version||""}),_EncryptedContentInfo2.default.schema(names.encryptedContentInfo||{}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.Repeated({name:names.unprotectedAttrs||"",value:_Attribute2.default.schema()})]})]})}}]);return EncryptedData}();exports.default=EncryptedData},{"./Attribute.js":5,"./EncryptedContentInfo.js":31,"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],33:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");var _OriginatorInfo=require("./OriginatorInfo.js");var _OriginatorInfo2=_interopRequireDefault(_OriginatorInfo);var _RecipientInfo=require("./RecipientInfo.js");var _RecipientInfo2=_interopRequireDefault(_RecipientInfo);var _EncryptedContentInfo=require("./EncryptedContentInfo.js");var _EncryptedContentInfo2=_interopRequireDefault(_EncryptedContentInfo);var _Attribute=require("./Attribute.js");var _Attribute2=_interopRequireDefault(_Attribute);var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _RSAESOAEPParams=require("./RSAESOAEPParams.js");var _RSAESOAEPParams2=_interopRequireDefault(_RSAESOAEPParams);var _KeyTransRecipientInfo=require("./KeyTransRecipientInfo.js");var _KeyTransRecipientInfo2=_interopRequireDefault(_KeyTransRecipientInfo);var _IssuerAndSerialNumber=require("./IssuerAndSerialNumber.js");var _IssuerAndSerialNumber2=_interopRequireDefault(_IssuerAndSerialNumber);var _RecipientEncryptedKey=require("./RecipientEncryptedKey.js");var _RecipientEncryptedKey2=_interopRequireDefault(_RecipientEncryptedKey);var _KeyAgreeRecipientIdentifier=require("./KeyAgreeRecipientIdentifier.js");var _KeyAgreeRecipientIdentifier2=_interopRequireDefault(_KeyAgreeRecipientIdentifier);var _KeyAgreeRecipientInfo=require("./KeyAgreeRecipientInfo.js");var _KeyAgreeRecipientInfo2=_interopRequireDefault(_KeyAgreeRecipientInfo);var _RecipientEncryptedKeys=require("./RecipientEncryptedKeys.js");var _RecipientEncryptedKeys2=_interopRequireDefault(_RecipientEncryptedKeys);var _KEKRecipientInfo=require("./KEKRecipientInfo.js");var _KEKRecipientInfo2=_interopRequireDefault(_KEKRecipientInfo);var _KEKIdentifier=require("./KEKIdentifier.js");var _KEKIdentifier2=_interopRequireDefault(_KEKIdentifier);var _PBKDF2Params=require("./PBKDF2Params.js");var _PBKDF2Params2=_interopRequireDefault(_PBKDF2Params);var _PasswordRecipientinfo=require("./PasswordRecipientinfo.js");var _PasswordRecipientinfo2=_interopRequireDefault(_PasswordRecipientinfo);var _ECCCMSSharedInfo=require("./ECCCMSSharedInfo.js");var _ECCCMSSharedInfo2=_interopRequireDefault(_ECCCMSSharedInfo);var _OriginatorIdentifierOrKey=require("./OriginatorIdentifierOrKey.js");var _OriginatorIdentifierOrKey2=_interopRequireDefault(_OriginatorIdentifierOrKey);var _OriginatorPublicKey=require("./OriginatorPublicKey.js");var _OriginatorPublicKey2=_interopRequireDefault(_OriginatorPublicKey);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var EnvelopedData=function(){function EnvelopedData(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,EnvelopedData);this.version=(0,_pvutils.getParametersValue)(parameters,"version",EnvelopedData.defaultValues("version"));if("originatorInfo"in parameters)this.originatorInfo=(0,_pvutils.getParametersValue)(parameters,"originatorInfo",EnvelopedData.defaultValues("originatorInfo"));this.recipientInfos=(0,_pvutils.getParametersValue)(parameters,"recipientInfos",EnvelopedData.defaultValues("recipientInfos"));this.encryptedContentInfo=(0,_pvutils.getParametersValue)(parameters,"encryptedContentInfo",EnvelopedData.defaultValues("encryptedContentInfo"));if("unprotectedAttrs"in parameters)this.unprotectedAttrs=(0,_pvutils.getParametersValue)(parameters,"unprotectedAttrs",EnvelopedData.defaultValues("unprotectedAttrs"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(EnvelopedData,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,EnvelopedData.schema({names:{version:"version",originatorInfo:"originatorInfo",recipientInfos:"recipientInfos",encryptedContentInfo:{names:{blockName:"encryptedContentInfo"}},unprotectedAttrs:"unprotectedAttrs"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CMS_ENVELOPED_DATA");this.version=asn1.result.version.valueBlock.valueDec;if("originatorInfo"in asn1.result){asn1.result.originatorInfo.idBlock.tagClass=1;asn1.result.originatorInfo.idBlock.tagNumber=16;this.originatorInfo=new _OriginatorInfo2.default({schema:asn1.result.originatorInfo})}this.recipientInfos=Array.from(asn1.result.recipientInfos,function(element){return new _RecipientInfo2.default({schema:element})});this.encryptedContentInfo=new _EncryptedContentInfo2.default({schema:asn1.result.encryptedContentInfo});if("unprotectedAttrs"in asn1.result)this.unprotectedAttrs=Array.from(asn1.result.unprotectedAttrs,function(element){return new _Attribute2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(new asn1js.Integer({value:this.version}));if("originatorInfo"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:this.originatorInfo.toSchema().valueBlock.value}))}outputArray.push(new asn1js.Set({value:Array.from(this.recipientInfos,function(element){return element.toSchema()})}));outputArray.push(this.encryptedContentInfo.toSchema());if("unprotectedAttrs"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,function(element){return element.toSchema()})}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={version:this.version};if("originatorInfo"in this)_object.originatorInfo=this.originatorInfo.toJSON();_object.recipientInfos=Array.from(this.recipientInfos,function(element){return element.toJSON()});_object.encryptedContentInfo=this.encryptedContentInfo.toJSON();if("unprotectedAttrs"in this)_object.unprotectedAttrs=Array.from(this.unprotectedAttrs,function(element){return element.toJSON()});return _object}},{key:"addRecipientByCertificate",value:function addRecipientByCertificate(certificate,parameters,variant){var encryptionParameters=parameters||{};if(certificate.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.113549")!==-1)variant=1;else{if(certificate.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.10045")!==-1)variant=2;else throw new Error("Unknown type of certificate's public key: "+certificate.subjectPublicKeyInfo.algorithm.algorithmId)}if("oaepHashAlgorithm"in encryptionParameters===false)encryptionParameters.oaepHashAlgorithm="SHA-512";if("kdfAlgorithm"in encryptionParameters===false)encryptionParameters.kdfAlgorithm="SHA-512";if("kekEncryptionLength"in encryptionParameters===false)encryptionParameters.kekEncryptionLength=256;switch(variant){case 1:{var oaepOID=(0,_common.getOIDByAlgorithm)({name:"RSA-OAEP"});if(oaepOID==="")throw new Error("Can not find OID for OAEP");var hashOID=(0,_common.getOIDByAlgorithm)({name:encryptionParameters.oaepHashAlgorithm});if(hashOID==="")throw new Error("Unknown OAEP hash algorithm: "+encryptionParameters.oaepHashAlgorithm);var hashAlgorithm=new _AlgorithmIdentifier2.default({algorithmId:hashOID,algorithmParams:new asn1js.Null});var rsaOAEPParams=new _RSAESOAEPParams2.default({hashAlgorithm:hashAlgorithm,maskGenAlgorithm:new _AlgorithmIdentifier2.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:hashAlgorithm.toSchema()})});var keyInfo=new _KeyTransRecipientInfo2.default({version:0,rid:new _IssuerAndSerialNumber2.default({issuer:certificate.issuer,serialNumber:certificate.serialNumber}),keyEncryptionAlgorithm:new _AlgorithmIdentifier2.default({algorithmId:oaepOID,algorithmParams:rsaOAEPParams.toSchema()}),recipientCertificate:certificate});this.recipientInfos.push(new _RecipientInfo2.default({variant:1,value:keyInfo}))}break;case 2:{var encryptedKey=new _RecipientEncryptedKey2.default({rid:new _KeyAgreeRecipientIdentifier2.default({variant:1,value:new _IssuerAndSerialNumber2.default({issuer:certificate.issuer,serialNumber:certificate.serialNumber})})});var aesKWoid=(0,_common.getOIDByAlgorithm)({name:"AES-KW",length:encryptionParameters.kekEncryptionLength});if(aesKWoid==="")throw new Error("Unknown length for key encryption algorithm: "+encryptionParameters.kekEncryptionLength);var aesKW=new _AlgorithmIdentifier2.default({algorithmId:aesKWoid,algorithmParams:new asn1js.Null});var ecdhOID=(0,_common.getOIDByAlgorithm)({name:"ECDH",kdf:encryptionParameters.kdfAlgorithm});if(ecdhOID==="")throw new Error("Unknown KDF algorithm: "+encryptionParameters.kdfAlgorithm);var ukmBuffer=new ArrayBuffer(64);var ukmView=new Uint8Array(ukmBuffer);(0,_common.getRandomValues)(ukmView);var _keyInfo=new _KeyAgreeRecipientInfo2.default({version:3,ukm:new asn1js.OctetString({valueHex:ukmBuffer}),keyEncryptionAlgorithm:new _AlgorithmIdentifier2.default({algorithmId:ecdhOID,algorithmParams:aesKW.toSchema()}),recipientEncryptedKeys:new _RecipientEncryptedKeys2.default({encryptedKeys:[encryptedKey]}),recipientCertificate:certificate});this.recipientInfos.push(new _RecipientInfo2.default({variant:2,value:_keyInfo}))}break;default:throw new Error('Unknown "variant" value: '+variant)}return true}},{key:"addRecipientByPreDefinedData",value:function addRecipientByPreDefinedData(preDefinedData,parameters,variant){var encryptionParameters=parameters||{};if(preDefinedData instanceof ArrayBuffer===false)throw new Error('Please pass "preDefinedData" in ArrayBuffer type');if(preDefinedData.byteLength===0)throw new Error("Pre-defined data could have zero length");if("keyIdentifier"in encryptionParameters===false){var keyIdentifierBuffer=new ArrayBuffer(16);var keyIdentifierView=new Uint8Array(keyIdentifierBuffer);(0,_common.getRandomValues)(keyIdentifierView);encryptionParameters.keyIdentifier=keyIdentifierBuffer}if("hmacHashAlgorithm"in encryptionParameters===false)encryptionParameters.hmacHashAlgorithm="SHA-512";if("iterationCount"in encryptionParameters===false)encryptionParameters.iterationCount=2048;if("keyEncryptionAlgorithm"in encryptionParameters===false){encryptionParameters.keyEncryptionAlgorithm={name:"AES-KW",length:256}}if("keyEncryptionAlgorithmParams"in encryptionParameters===false)encryptionParameters.keyEncryptionAlgorithmParams=new asn1js.Null;switch(variant){case 1:{var kekOID=(0,_common.getOIDByAlgorithm)(encryptionParameters.keyEncryptionAlgorithm);if(kekOID==="")throw new Error('Incorrect value for "keyEncryptionAlgorithm"');var keyInfo=new _KEKRecipientInfo2.default({version:4,kekid:new _KEKIdentifier2.default({keyIdentifier:new asn1js.OctetString({valueHex:encryptionParameters.keyIdentifier})}),keyEncryptionAlgorithm:new _AlgorithmIdentifier2.default({algorithmId:kekOID,algorithmParams:encryptionParameters.keyEncryptionAlgorithmParams}),preDefinedKEK:preDefinedData});this.recipientInfos.push(new _RecipientInfo2.default({variant:3,value:keyInfo}))}break;case 2:{var pbkdf2OID=(0,_common.getOIDByAlgorithm)({name:"PBKDF2"});if(pbkdf2OID==="")throw new Error("Can not find OID for PBKDF2");var saltBuffer=new ArrayBuffer(64);var saltView=new Uint8Array(saltBuffer);(0,_common.getRandomValues)(saltView);var hmacOID=(0,_common.getOIDByAlgorithm)({name:"HMAC",hash:{name:encryptionParameters.hmacHashAlgorithm}});if(hmacOID==="")throw new Error('Incorrect value for "hmacHashAlgorithm": '+encryptionParameters.hmacHashAlgorithm);var pbkdf2Params=new _PBKDF2Params2.default({salt:new asn1js.OctetString({valueHex:saltBuffer}),iterationCount:encryptionParameters.iterationCount,prf:new _AlgorithmIdentifier2.default({algorithmId:hmacOID,algorithmParams:new asn1js.Null})});var _kekOID=(0,_common.getOIDByAlgorithm)(encryptionParameters.keyEncryptionAlgorithm);if(_kekOID==="")throw new Error('Incorrect value for "keyEncryptionAlgorithm"');var _keyInfo2=new _PasswordRecipientinfo2.default({version:0,keyDerivationAlgorithm:new _AlgorithmIdentifier2.default({algorithmId:pbkdf2OID,algorithmParams:pbkdf2Params.toSchema()}),keyEncryptionAlgorithm:new _AlgorithmIdentifier2.default({algorithmId:_kekOID,algorithmParams:encryptionParameters.keyEncryptionAlgorithmParams}),password:preDefinedData});this.recipientInfos.push(new _RecipientInfo2.default({variant:4,value:_keyInfo2}))}break;default:throw new Error('Unknown value for "variant": '+variant)}}},{key:"encrypt",value:function encrypt(contentEncryptionAlgorithm,contentToEncrypt){var _this2=this;var sequence=Promise.resolve();var ivBuffer=new ArrayBuffer(16);var ivView=new Uint8Array(ivBuffer);(0,_common.getRandomValues)(ivView);var contentView=new Uint8Array(contentToEncrypt);var sessionKey=void 0;var encryptedContent=void 0;var exportedSessionKey=void 0;var recipientsPromises=[];var _this=this;var contentEncryptionOID=(0,_common.getOIDByAlgorithm)(contentEncryptionAlgorithm);if(contentEncryptionOID==="")return Promise.reject('Wrong "contentEncryptionAlgorithm" value');var crypto=(0,_common.getCrypto)();if(typeof crypto==="undefined")return Promise.reject("Unable to create WebCrypto object");sequence=sequence.then(function(){return crypto.generateKey(contentEncryptionAlgorithm,true,["encrypt"])});sequence=sequence.then(function(result){sessionKey=result;return crypto.encrypt({name:contentEncryptionAlgorithm.name,iv:ivView},sessionKey,contentView)},function(error){return Promise.reject(error)});sequence=sequence.then(function(result){encryptedContent=result;return crypto.exportKey("raw",sessionKey)},function(error){return Promise.reject(error)}).then(function(result){exportedSessionKey=result;return true},function(error){return Promise.reject(error)});sequence=sequence.then(function(){_this2.version=2;_this2.encryptedContentInfo=new _EncryptedContentInfo2.default({contentType:"1.2.840.113549.1.7.1",contentEncryptionAlgorithm:new _AlgorithmIdentifier2.default({algorithmId:contentEncryptionOID,algorithmParams:new asn1js.OctetString({valueHex:ivBuffer})}),encryptedContent:new asn1js.OctetString({valueHex:encryptedContent})})},function(error){return Promise.reject(error)});function SubKeyAgreeRecipientInfo(index){var currentSequence=Promise.resolve();var ecdhPublicKey=void 0;var ecdhPrivateKey=void 0;var recipientCurve=void 0;var recipientCurveLength=void 0;var exportedECDHPublicKey=void 0;currentSequence=currentSequence.then(function(){var curveObject=_this.recipientInfos[index].value.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(curveObject instanceof asn1js.ObjectIdentifier===false)return Promise.reject('Incorrect "recipientCertificate" for index '+index);var curveOID=curveObject.valueBlock.toString();switch(curveOID){case"1.2.840.10045.3.1.7":recipientCurve="P-256";recipientCurveLength=256;break;case"1.3.132.0.34":recipientCurve="P-384";recipientCurveLength=384;break;case"1.3.132.0.35":recipientCurve="P-521";recipientCurveLength=528;break;default:return Promise.reject("Incorrect curve OID for index "+index)}return recipientCurve},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){return crypto.generateKey({name:"ECDH",namedCurve:result},true,["deriveBits"])},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){ecdhPublicKey=result.publicKey;ecdhPrivateKey=result.privateKey;return crypto.exportKey("spki",ecdhPublicKey)},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){exportedECDHPublicKey=result;return _this.recipientInfos[index].value.recipientCertificate.getPublicKey({algorithm:{algorithm:{name:"ECDH",namedCurve:recipientCurve},usages:[]}})},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){return crypto.deriveBits({name:"ECDH",public:result},ecdhPrivateKey,recipientCurveLength)},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){var aesKWAlgorithm=new _AlgorithmIdentifier2.default({schema:_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmParams});var KWalgorithm=(0,_common.getAlgorithmByOID)(aesKWAlgorithm.algorithmId);if("name"in KWalgorithm===false)return Promise.reject("Incorrect OID for key encryption algorithm: "+aesKWAlgorithm.algorithmId);var kwLength=KWalgorithm.length;var kwLengthBuffer=new ArrayBuffer(4);var kwLengthView=new Uint8Array(kwLengthBuffer);for(var j=3;j>=0;j--){kwLengthView[j]=kwLength;kwLength>>=8}var eccInfo=new _ECCCMSSharedInfo2.default({keyInfo:new _AlgorithmIdentifier2.default({algorithmId:aesKWAlgorithm.algorithmId,algorithmParams:new asn1js.Null}),entityUInfo:_this.recipientInfos[index].value.ukm,suppPubInfo:new asn1js.OctetString({valueHex:kwLengthBuffer})});var encodedInfo=eccInfo.toSchema().toBER(false);var ecdhAlgorithm=(0,_common.getAlgorithmByOID)(_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmId);if("name"in ecdhAlgorithm===false)return Promise.reject("Incorrect OID for key encryption algorithm: "+_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmId);return(0,_common.kdf)(ecdhAlgorithm.kdf,result,KWalgorithm.length,encodedInfo)},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){return crypto.importKey("raw",result,{name:"AES-KW"},true,["wrapKey"])},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){return crypto.wrapKey("raw",sessionKey,result,{name:"AES-KW"})},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){var asn1=asn1js.fromBER(exportedECDHPublicKey);var originator=new _OriginatorIdentifierOrKey2.default;originator.variant=3;originator.value=new _OriginatorPublicKey2.default({schema:asn1.result});if("algorithmParams"in originator.value.algorithm)delete originator.value.algorithm.algorithmParams;_this.recipientInfos[index].value.originator=originator;_this.recipientInfos[index].value.recipientEncryptedKeys.encryptedKeys[0].encryptedKey=new asn1js.OctetString({valueHex:result})},function(error){return Promise.reject(error)});return currentSequence}function SubKeyTransRecipientInfo(index){var currentSequence=Promise.resolve();currentSequence=currentSequence.then(function(){var schema=_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmParams;var rsaOAEPParams=new _RSAESOAEPParams2.default({schema:schema});var hashAlgorithm=(0,_common.getAlgorithmByOID)(rsaOAEPParams.hashAlgorithm.algorithmId);if("name"in hashAlgorithm===false)return Promise.reject("Incorrect OID for hash algorithm: "+rsaOAEPParams.hashAlgorithm.algorithmId);return _this.recipientInfos[index].value.recipientCertificate.getPublicKey({algorithm:{algorithm:{name:"RSA-OAEP",hash:{name:hashAlgorithm.name}},usages:["encrypt","wrapKey"]}})},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){return crypto.encrypt(result.algorithm,result,exportedSessionKey)},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){_this.recipientInfos[index].value.encryptedKey=new asn1js.OctetString({valueHex:result})},function(error){return Promise.reject(error)});return currentSequence}function SubKEKRecipientInfo(index){var currentSequence=Promise.resolve();var kekAlgorithm=void 0;currentSequence=currentSequence.then(function(){kekAlgorithm=(0,_common.getAlgorithmByOID)(_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmId);if("name"in kekAlgorithm===false)return Promise.reject('Incorrect OID for "keyEncryptionAlgorithm": '+_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmId);return crypto.importKey("raw",new Uint8Array(_this.recipientInfos[index].value.preDefinedKEK),kekAlgorithm,true,["wrapKey"])},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){return crypto.wrapKey("raw",sessionKey,result,kekAlgorithm)},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){_this.recipientInfos[index].value.encryptedKey=new asn1js.OctetString({valueHex:result})},function(error){return Promise.reject(error)});return currentSequence}function SubPasswordRecipientinfo(index){var currentSequence=Promise.resolve();var pbkdf2Params=void 0;var kekAlgorithm=void 0;currentSequence=currentSequence.then(function(){if("keyDerivationAlgorithm"in _this.recipientInfos[index].value===false)return Promise.reject('Please append encoded "keyDerivationAlgorithm"');if("algorithmParams"in _this.recipientInfos[index].value.keyDerivationAlgorithm===false)return Promise.reject('Incorrectly encoded "keyDerivationAlgorithm"');try{pbkdf2Params=new _PBKDF2Params2.default({schema:_this.recipientInfos[index].value.keyDerivationAlgorithm.algorithmParams})}catch(ex){return Promise.reject('Incorrectly encoded "keyDerivationAlgorithm"')}return Promise.resolve()},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(){var passwordView=new Uint8Array(_this.recipientInfos[index].value.password);return crypto.importKey("raw",passwordView,"PBKDF2",false,["deriveKey"])},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){kekAlgorithm=(0,_common.getAlgorithmByOID)(_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmId);if("name"in kekAlgorithm===false)return Promise.reject('Incorrect OID for "keyEncryptionAlgorithm": '+_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmId);var hmacHashAlgorithm="SHA-1";if("prf"in pbkdf2Params){var algorithm=(0,_common.getAlgorithmByOID)(pbkdf2Params.prf.algorithmId);if("name"in algorithm===false)return Promise.reject("Incorrect OID for HMAC hash algorithm");hmacHashAlgorithm=algorithm.hash.name}var saltView=new Uint8Array(pbkdf2Params.salt.valueBlock.valueHex);var iterations=pbkdf2Params.iterationCount;return crypto.deriveKey({name:"PBKDF2",hash:{name:hmacHashAlgorithm},salt:saltView,iterations:iterations},result,kekAlgorithm,true,["wrapKey"])},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){return crypto.wrapKey("raw",sessionKey,result,kekAlgorithm)},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){_this.recipientInfos[index].value.encryptedKey=new asn1js.OctetString({valueHex:result})},function(error){return Promise.reject(error)});return currentSequence}sequence=sequence.then(function(){for(var i=0;i<_this2.recipientInfos.length;i++){var currentSequence=Promise.resolve();switch(_this2.recipientInfos[i].variant){case 1:currentSequence=SubKeyTransRecipientInfo(i);break;case 2:currentSequence=SubKeyAgreeRecipientInfo(i);break;case 3:currentSequence=SubKEKRecipientInfo(i);break;case 4:currentSequence=SubPasswordRecipientinfo(i);break;default:return Promise.reject("Uknown recipient type in array with index "+i)}recipientsPromises.push(currentSequence)}return Promise.all(recipientsPromises)},function(error){return Promise.reject(error)});return sequence}},{key:"decrypt",value:function decrypt(recipientIndex,parameters){var _this3=this;var sequence=Promise.resolve();var decryptionParameters=parameters||{};var _this=this;if(recipientIndex+1>this.recipientInfos.length)return Promise.reject('Maximum value for "index" is: '+(this.recipientInfos.length-1));var crypto=(0,_common.getCrypto)();if(typeof crypto==="undefined")return Promise.reject("Unable to create WebCrypto object");function SubKeyAgreeRecipientInfo(index){var currentSequence=Promise.resolve();var recipientCurve=void 0;var recipientCurveLength=void 0;var curveOID=void 0;var ecdhPrivateKey=void 0;currentSequence=currentSequence.then(function(){if("recipientCertificate"in decryptionParameters===false)return Promise.reject('Parameter "recipientCertificate" is mandatory for "KeyAgreeRecipientInfo"');if("recipientPrivateKey"in decryptionParameters===false)return Promise.reject('Parameter "recipientPrivateKey" is mandatory for "KeyAgreeRecipientInfo"');var curveObject=decryptionParameters.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(curveObject instanceof asn1js.ObjectIdentifier===false)return Promise.reject('Incorrect "recipientCertificate" for index '+index);curveOID=curveObject.valueBlock.toString();switch(curveOID){case"1.2.840.10045.3.1.7":recipientCurve="P-256";recipientCurveLength=256;break;case"1.3.132.0.34":recipientCurve="P-384";recipientCurveLength=384;break;case"1.3.132.0.35":recipientCurve="P-521";recipientCurveLength=528;break;default:return Promise.reject("Incorrect curve OID for index "+index)}return crypto.importKey("pkcs8",decryptionParameters.recipientPrivateKey,{name:"ECDH",namedCurve:recipientCurve},true,["deriveBits"])},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){ecdhPrivateKey=result;if("algorithmParams"in _this.recipientInfos[index].value.originator.value.algorithm===false)_this.recipientInfos[index].value.originator.value.algorithm.algorithmParams=new asn1js.ObjectIdentifier({value:curveOID});var buffer=_this.recipientInfos[index].value.originator.value.toSchema().toBER(false);return crypto.importKey("spki",buffer,{name:"ECDH",namedCurve:recipientCurve},true,[])},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){return crypto.deriveBits({name:"ECDH",public:result},ecdhPrivateKey,recipientCurveLength)},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){var aesKWAlgorithm=new _AlgorithmIdentifier2.default({schema:_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmParams});var KWalgorithm=(0,_common.getAlgorithmByOID)(aesKWAlgorithm.algorithmId);if("name"in KWalgorithm===false)return Promise.reject("Incorrect OID for key encryption algorithm: "+aesKWAlgorithm.algorithmId);var kwLength=KWalgorithm.length;var kwLengthBuffer=new ArrayBuffer(4);var kwLengthView=new Uint8Array(kwLengthBuffer);for(var j=3;j>=0;j--){kwLengthView[j]=kwLength;kwLength>>=8}var eccInfo=new _ECCCMSSharedInfo2.default({keyInfo:new _AlgorithmIdentifier2.default({algorithmId:aesKWAlgorithm.algorithmId,algorithmParams:new asn1js.Null}),entityUInfo:_this.recipientInfos[index].value.ukm,suppPubInfo:new asn1js.OctetString({valueHex:kwLengthBuffer})});var encodedInfo=eccInfo.toSchema().toBER(false);var ecdhAlgorithm=(0,_common.getAlgorithmByOID)(_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmId);if("name"in ecdhAlgorithm===false)return Promise.reject("Incorrect OID for key encryption algorithm: "+_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmId);return(0,_common.kdf)(ecdhAlgorithm.kdf,result,KWalgorithm.length,encodedInfo)},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){return crypto.importKey("raw",result,{name:"AES-KW"},true,["unwrapKey"])},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){var contentEncryptionAlgorithm=(0,_common.getAlgorithmByOID)(_this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);if("name"in contentEncryptionAlgorithm===false)return Promise.reject('Incorrect "contentEncryptionAlgorithm": '+_this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);return crypto.unwrapKey("raw",_this.recipientInfos[index].value.recipientEncryptedKeys.encryptedKeys[0].encryptedKey.valueBlock.valueHex,result,{name:"AES-KW"},contentEncryptionAlgorithm,true,["decrypt"])},function(error){return Promise.reject(error)});return currentSequence}function SubKeyTransRecipientInfo(index){var currentSequence=Promise.resolve();currentSequence=currentSequence.then(function(){if("recipientPrivateKey"in decryptionParameters===false)return Promise.reject('Parameter "recipientPrivateKey" is mandatory for "KeyTransRecipientInfo"');var schema=_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmParams;var rsaOAEPParams=new _RSAESOAEPParams2.default({schema:schema});var hashAlgorithm=(0,_common.getAlgorithmByOID)(rsaOAEPParams.hashAlgorithm.algorithmId);if("name"in hashAlgorithm===false)return Promise.reject("Incorrect OID for hash algorithm: "+rsaOAEPParams.hashAlgorithm.algorithmId);return crypto.importKey("pkcs8",decryptionParameters.recipientPrivateKey,{name:"RSA-OAEP",hash:{name:hashAlgorithm.name}},true,["decrypt"])},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){return crypto.decrypt(result.algorithm,result,_this.recipientInfos[index].value.encryptedKey.valueBlock.valueHex)},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){var contentEncryptionAlgorithm=(0,_common.getAlgorithmByOID)(_this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);if("name"in contentEncryptionAlgorithm===false)return Promise.reject('Incorrect "contentEncryptionAlgorithm": '+_this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);return crypto.importKey("raw",result,contentEncryptionAlgorithm,true,["decrypt"])},function(error){return Promise.reject(error)});return currentSequence}function SubKEKRecipientInfo(index){var currentSequence=Promise.resolve();var kekAlgorithm=void 0;currentSequence=currentSequence.then(function(){if("preDefinedData"in decryptionParameters===false)return Promise.reject('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');kekAlgorithm=(0,_common.getAlgorithmByOID)(_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmId);if("name"in kekAlgorithm===false)return Promise.reject('Incorrect OID for "keyEncryptionAlgorithm": '+_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmId);return crypto.importKey("raw",decryptionParameters.preDefinedData,kekAlgorithm,true,["unwrapKey"])},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){var contentEncryptionAlgorithm=(0,_common.getAlgorithmByOID)(_this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);if("name"in contentEncryptionAlgorithm===false)return Promise.reject('Incorrect "contentEncryptionAlgorithm": '+_this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);return crypto.unwrapKey("raw",_this.recipientInfos[index].value.encryptedKey.valueBlock.valueHex,result,kekAlgorithm,contentEncryptionAlgorithm,true,["decrypt"])},function(error){return Promise.reject(error)});return currentSequence}function SubPasswordRecipientinfo(index){var currentSequence=Promise.resolve();var pbkdf2Params=void 0;var kekAlgorithm=void 0;currentSequence=currentSequence.then(function(){if("preDefinedData"in decryptionParameters===false)return Promise.reject('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');if("keyDerivationAlgorithm"in _this.recipientInfos[index].value===false)return Promise.reject('Please append encoded "keyDerivationAlgorithm"');if("algorithmParams"in _this.recipientInfos[index].value.keyDerivationAlgorithm===false)return Promise.reject('Incorrectly encoded "keyDerivationAlgorithm"');try{pbkdf2Params=new _PBKDF2Params2.default({schema:_this.recipientInfos[index].value.keyDerivationAlgorithm.algorithmParams})}catch(ex){return Promise.reject('Incorrectly encoded "keyDerivationAlgorithm"')}return crypto.importKey("raw",decryptionParameters.preDefinedData,"PBKDF2",false,["deriveKey"])},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){kekAlgorithm=(0,_common.getAlgorithmByOID)(_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmId);if("name"in kekAlgorithm===false)return Promise.reject('Incorrect OID for "keyEncryptionAlgorithm": '+_this.recipientInfos[index].value.keyEncryptionAlgorithm.algorithmId);var hmacHashAlgorithm="SHA-1";if("prf"in pbkdf2Params){var algorithm=(0,_common.getAlgorithmByOID)(pbkdf2Params.prf.algorithmId);if("name"in algorithm===false)return Promise.reject("Incorrect OID for HMAC hash algorithm");hmacHashAlgorithm=algorithm.hash.name}var saltView=new Uint8Array(pbkdf2Params.salt.valueBlock.valueHex);var iterations=pbkdf2Params.iterationCount;return crypto.deriveKey({name:"PBKDF2",hash:{name:hmacHashAlgorithm},salt:saltView,iterations:iterations},result,kekAlgorithm,true,["unwrapKey"])},function(error){return Promise.reject(error)});currentSequence=currentSequence.then(function(result){var contentEncryptionAlgorithm=(0,_common.getAlgorithmByOID)(_this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);if("name"in contentEncryptionAlgorithm===false)return Promise.reject('Incorrect "contentEncryptionAlgorithm": '+_this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);return crypto.unwrapKey("raw",_this.recipientInfos[index].value.encryptedKey.valueBlock.valueHex,result,kekAlgorithm,contentEncryptionAlgorithm,true,["decrypt"])},function(error){return Promise.reject(error)});return currentSequence}sequence=sequence.then(function(){var currentSequence=Promise.resolve();switch(_this3.recipientInfos[recipientIndex].variant){case 1:currentSequence=SubKeyTransRecipientInfo(recipientIndex);break;case 2:currentSequence=SubKeyAgreeRecipientInfo(recipientIndex);break;case 3:currentSequence=SubKEKRecipientInfo(recipientIndex);break;case 4:currentSequence=SubPasswordRecipientinfo(recipientIndex);break;default:return Promise.reject("Uknown recipient type in array with index "+recipientIndex)}return currentSequence},function(error){return Promise.reject(error)});sequence=sequence.then(function(result){var contentEncryptionAlgorithm=(0,_common.getAlgorithmByOID)(_this3.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);if("name"in contentEncryptionAlgorithm===false)return Promise.reject('Incorrect "contentEncryptionAlgorithm": '+_this3.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);var ivBuffer=_this3.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams.valueBlock.valueHex;var ivView=new Uint8Array(ivBuffer);var dataBuffer=new ArrayBuffer(0);if(_this3.encryptedContentInfo.encryptedContent.idBlock.isConstructed===false)dataBuffer=_this3.encryptedContentInfo.encryptedContent.valueBlock.valueHex;else{var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=_this3.encryptedContentInfo.encryptedContent.valueBlock.value[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var content=_step.value;dataBuffer=(0,_pvutils.utilConcatBuf)(dataBuffer,content.valueBlock.valueHex)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}return crypto.decrypt({name:contentEncryptionAlgorithm.name,iv:ivView},result,dataBuffer)},function(error){return Promise.reject(error)});return sequence}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 0;case"originatorInfo":return new _OriginatorInfo2.default;case"recipientInfos":return[];case"encryptedContentInfo":return new _EncryptedContentInfo2.default;case"unprotectedAttrs":return[];default:throw new Error("Invalid member name for EnvelopedData class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"version":return memberValue===EnvelopedData.defaultValues(memberName);case"originatorInfo":return memberValue.certs.certificates.length===0&&memberValue.crls.crls.length===0;case"recipientInfos":case"unprotectedAttrs":return memberValue.length===0;case"encryptedContentInfo":return _EncryptedContentInfo2.default.compareWithDefault("contentType",memberValue.contentType)&&_EncryptedContentInfo2.default.compareWithDefault("contentEncryptionAlgorithm",memberValue.contentEncryptionAlgorithm)&&_EncryptedContentInfo2.default.compareWithDefault("encryptedContent",memberValue.encryptedContent);default:throw new Error("Invalid member name for EnvelopedData class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.version||""}),new asn1js.Constructed({name:names.originatorInfo||"",optional:true,idBlock:{tagClass:3,tagNumber:0},value:_OriginatorInfo2.default.schema().valueBlock.value}),new asn1js.Set({value:[new asn1js.Repeated({name:names.recipientInfos||"",value:_RecipientInfo2.default.schema()})]}),_EncryptedContentInfo2.default.schema(names.encryptedContentInfo||{}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.Repeated({name:names.unprotectedAttrs||"",value:_Attribute2.default.schema()})]})]})}}]);return EnvelopedData}();exports.default=EnvelopedData},{"./AlgorithmIdentifier.js":3,"./Attribute.js":5,"./ECCCMSSharedInfo.js":27,"./EncryptedContentInfo.js":31,"./IssuerAndSerialNumber.js":41,"./KEKIdentifier.js":43,"./KEKRecipientInfo.js":44,"./KeyAgreeRecipientIdentifier.js":45,"./KeyAgreeRecipientInfo.js":46,"./KeyTransRecipientInfo.js":48,"./OriginatorIdentifierOrKey.js":54,"./OriginatorInfo.js":55,"./OriginatorPublicKey.js":56,"./PBKDF2Params.js":63,"./PasswordRecipientinfo.js":67,"./RSAESOAEPParams.js":76,"./RecipientEncryptedKey.js":80,"./RecipientEncryptedKeys.js":81,"./RecipientInfo.js":83,"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ExtKeyUsage=function(){function ExtKeyUsage(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,ExtKeyUsage);this.keyPurposes=(0,_pvutils.getParametersValue)(parameters,"keyPurposes",ExtKeyUsage.defaultValues("keyPurposes"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(ExtKeyUsage,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,ExtKeyUsage.schema({names:{keyPurposes:"keyPurposes"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for ExtKeyUsage");this.keyPurposes=Array.from(asn1.result.keyPurposes,function(element){return element.valueBlock.toString()})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:Array.from(this.keyPurposes,function(element){return new asn1js.ObjectIdentifier({value:element})})})}},{key:"toJSON",value:function toJSON(){return{keyPurposes:Array.from(this.keyPurposes)}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"keyPurposes":return[];default:throw new Error("Invalid member name for ExtKeyUsage class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Repeated({name:names.keyPurposes||"",value:new asn1js.ObjectIdentifier})]})}}]);return ExtKeyUsage}();exports.default=ExtKeyUsage},{asn1js:"asn1js",pvutils:"pvutils"}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _SubjectDirectoryAttributes=require("./SubjectDirectoryAttributes.js");var _SubjectDirectoryAttributes2=_interopRequireDefault(_SubjectDirectoryAttributes);var _PrivateKeyUsagePeriod=require("./PrivateKeyUsagePeriod.js");var _PrivateKeyUsagePeriod2=_interopRequireDefault(_PrivateKeyUsagePeriod);var _AltName=require("./AltName.js");var _AltName2=_interopRequireDefault(_AltName);var _BasicConstraints=require("./BasicConstraints.js");var _BasicConstraints2=_interopRequireDefault(_BasicConstraints);var _IssuingDistributionPoint=require("./IssuingDistributionPoint.js");var _IssuingDistributionPoint2=_interopRequireDefault(_IssuingDistributionPoint);var _GeneralNames=require("./GeneralNames.js");var _GeneralNames2=_interopRequireDefault(_GeneralNames);var _NameConstraints=require("./NameConstraints.js");var _NameConstraints2=_interopRequireDefault(_NameConstraints);var _CRLDistributionPoints=require("./CRLDistributionPoints.js");var _CRLDistributionPoints2=_interopRequireDefault(_CRLDistributionPoints);var _CertificatePolicies=require("./CertificatePolicies.js");var _CertificatePolicies2=_interopRequireDefault(_CertificatePolicies);var _PolicyMappings=require("./PolicyMappings.js");var _PolicyMappings2=_interopRequireDefault(_PolicyMappings);var _AuthorityKeyIdentifier=require("./AuthorityKeyIdentifier.js");var _AuthorityKeyIdentifier2=_interopRequireDefault(_AuthorityKeyIdentifier);var _PolicyConstraints=require("./PolicyConstraints.js");var _PolicyConstraints2=_interopRequireDefault(_PolicyConstraints);var _ExtKeyUsage=require("./ExtKeyUsage.js");var _ExtKeyUsage2=_interopRequireDefault(_ExtKeyUsage);var _InfoAccess=require("./InfoAccess.js");var _InfoAccess2=_interopRequireDefault(_InfoAccess);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Extension=function(){function Extension(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Extension);this.extnID=(0,_pvutils.getParametersValue)(parameters,"extnID",Extension.defaultValues("extnID"));this.critical=(0,_pvutils.getParametersValue)(parameters,"critical",Extension.defaultValues("critical"));if("extnValue"in parameters)this.extnValue=new asn1js.OctetString({valueHex:parameters.extnValue});else this.extnValue=Extension.defaultValues("extnValue");if("parsedValue"in parameters)this.parsedValue=(0,_pvutils.getParametersValue)(parameters,"parsedValue",Extension.defaultValues("parsedValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(Extension,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,Extension.schema({names:{extnID:"extnID",critical:"critical",extnValue:"extnValue"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for EXTENSION");this.extnID=asn1.result.extnID.valueBlock.toString();if("critical"in asn1.result)this.critical=asn1.result.critical.valueBlock.value;this.extnValue=asn1.result.extnValue;asn1=asn1js.fromBER(this.extnValue.valueBlock.valueHex);if(asn1.offset===-1)return;switch(this.extnID){case"2.5.29.9":this.parsedValue=new _SubjectDirectoryAttributes2.default({schema:asn1.result});break;case"2.5.29.14":this.parsedValue=asn1.result;break;case"2.5.29.15":this.parsedValue=asn1.result;break;case"2.5.29.16":this.parsedValue=new _PrivateKeyUsagePeriod2.default({schema:asn1.result});break;case"2.5.29.17":case"2.5.29.18":this.parsedValue=new _AltName2.default({schema:asn1.result});break;case"2.5.29.19":this.parsedValue=new _BasicConstraints2.default({schema:asn1.result});break;case"2.5.29.20":case"2.5.29.27":this.parsedValue=asn1.result;break;case"2.5.29.21":this.parsedValue=asn1.result;break;case"2.5.29.24":this.parsedValue=asn1.result;break;case"2.5.29.28":this.parsedValue=new _IssuingDistributionPoint2.default({schema:asn1.result});break;case"2.5.29.29":this.parsedValue=new _GeneralNames2.default({schema:asn1.result});break;case"2.5.29.30":this.parsedValue=new _NameConstraints2.default({schema:asn1.result});break;case"2.5.29.31":case"2.5.29.46":this.parsedValue=new _CRLDistributionPoints2.default({schema:asn1.result});break;case"2.5.29.32":this.parsedValue=new _CertificatePolicies2.default({schema:asn1.result});break;case"2.5.29.33":this.parsedValue=new _PolicyMappings2.default({schema:asn1.result});break;case"2.5.29.35":this.parsedValue=new _AuthorityKeyIdentifier2.default({schema:asn1.result});break;case"2.5.29.36":this.parsedValue=new _PolicyConstraints2.default({schema:asn1.result});break;case"2.5.29.37":this.parsedValue=new _ExtKeyUsage2.default({schema:asn1.result});break;case"2.5.29.54":this.parsedValue=asn1.result;break;case"1.3.6.1.5.5.7.1.1":case"1.3.6.1.5.5.7.1.11":this.parsedValue=new _InfoAccess2.default({schema:asn1.result});break;default:}}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(new asn1js.ObjectIdentifier({value:this.extnID}));if(this.critical!==Extension.defaultValues("critical"))outputArray.push(new asn1js.Boolean({value:this.critical}));outputArray.push(this.extnValue);return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={extnID:this.extnID,extnValue:this.extnValue.toJSON()};if(this.critical!==Extension.defaultValues("critical"))object.critical=this.critical;if("parsedValue"in this)object.parsedValue=this.parsedValue.toJSON();return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"extnID":return"";case"critical":return false;case"extnValue":return new asn1js.OctetString;case"parsedValue":return{};default:throw new Error("Invalid member name for Extension class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.extnID||""}),new asn1js.Boolean({name:names.critical||"",optional:true}),new asn1js.OctetString({name:names.extnValue||""})]})}}]);return Extension}();exports.default=Extension},{"./AltName.js":4,"./AuthorityKeyIdentifier.js":10,"./BasicConstraints.js":11,"./CRLDistributionPoints.js":14,"./CertificatePolicies.js":19,"./ExtKeyUsage.js":34,"./GeneralNames.js":38,"./InfoAccess.js":40,"./IssuingDistributionPoint.js":42,"./NameConstraints.js":51,"./PolicyConstraints.js":68,"./PolicyMappings.js":71,"./PrivateKeyUsagePeriod.js":74,"./SubjectDirectoryAttributes.js":99,asn1js:"asn1js",pvutils:"pvutils"}],36:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _Extension=require("./Extension.js");var _Extension2=_interopRequireDefault(_Extension);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Extensions=function(){function Extensions(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Extensions);this.extensions=(0,_pvutils.getParametersValue)(parameters,"extensions",Extensions.defaultValues("extensions"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(Extensions,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,Extensions.schema({names:{extensions:"extensions"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for EXTENSIONS");this.extensions=Array.from(asn1.result.extensions,function(element){return new _Extension2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:Array.from(this.extensions,function(element){return element.toSchema()})})}},{key:"toJSON",value:function toJSON(){return{extensions:Array.from(this.extensions,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"extensions":return[];default:throw new Error("Invalid member name for Extensions class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var optional=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({optional:optional,name:names.blockName||"",value:[new asn1js.Repeated({name:names.extensions||"",value:_Extension2.default.schema(names.extension||{})})]})}}]);return Extensions}();exports.default=Extensions},{"./Extension.js":35,asn1js:"asn1js",pvutils:"pvutils"}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _RelativeDistinguishedNames=require("./RelativeDistinguishedNames.js");var _RelativeDistinguishedNames2=_interopRequireDefault(_RelativeDistinguishedNames);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function builtInStandardAttributes(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var optional=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({optional:optional,value:[new asn1js.Constructed({optional:true,idBlock:{tagClass:2,tagNumber:1},name:names.country_name||"",value:[new asn1js.Choice({value:[new asn1js.NumericString,new asn1js.PrintableString]})]}),new asn1js.Constructed({optional:true,idBlock:{tagClass:2,tagNumber:2},name:names.administration_domain_name||"",value:[new asn1js.Choice({value:[new asn1js.NumericString,new asn1js.PrintableString]})]}),new asn1js.Primitive({optional:true,idBlock:{tagClass:3,tagNumber:0},name:names.network_address||"",isHexOnly:true}),new asn1js.Primitive({optional:true,idBlock:{tagClass:3,tagNumber:1},name:names.terminal_identifier||"",isHexOnly:true}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:2},name:names.private_domain_name||"",value:[new asn1js.Choice({value:[new asn1js.NumericString,new asn1js.PrintableString]})]}),new asn1js.Primitive({optional:true,idBlock:{tagClass:3,tagNumber:3},name:names.organization_name||"",isHexOnly:true}),new asn1js.Primitive({optional:true,name:names.numeric_user_identifier||"",idBlock:{tagClass:3,tagNumber:4},isHexOnly:true}),new asn1js.Constructed({optional:true,name:names.personal_name||"",idBlock:{tagClass:3,tagNumber:5},value:[new asn1js.Primitive({idBlock:{tagClass:3,tagNumber:0},isHexOnly:true}),new asn1js.Primitive({optional:true,idBlock:{tagClass:3,tagNumber:1},isHexOnly:true}),new asn1js.Primitive({optional:true,idBlock:{tagClass:3,tagNumber:2},isHexOnly:true}),new asn1js.Primitive({optional:true,idBlock:{tagClass:3,tagNumber:3},isHexOnly:true})]}),new asn1js.Constructed({optional:true,name:names.organizational_unit_names||"",idBlock:{tagClass:3,tagNumber:6},value:[new asn1js.Repeated({value:new asn1js.PrintableString})]})]})}function builtInDomainDefinedAttributes(){var optional=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return new asn1js.Sequence({optional:optional,value:[new asn1js.PrintableString,new asn1js.PrintableString]})}function extensionAttributes(){var optional=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return new asn1js.Set({optional:optional,value:[new asn1js.Primitive({optional:true,idBlock:{tagClass:3,tagNumber:0},isHexOnly:true}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.Any]})]})}var GeneralName=function(){function GeneralName(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,GeneralName);this.type=(0,_pvutils.getParametersValue)(parameters,"type",GeneralName.defaultValues("type"));this.value=(0,_pvutils.getParametersValue)(parameters,"value",GeneralName.defaultValues("value"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(GeneralName,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,GeneralName.schema({names:{blockName:"blockName",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{blockName:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for GENERAL_NAME");this.type=asn1.result.blockName.idBlock.tagNumber;switch(this.type){case 0:this.value=asn1.result.blockName;break;case 1:case 2:case 6:{var value=asn1.result.blockName;value.idBlock.tagClass=1;value.idBlock.tagNumber=22;var valueBER=value.toBER(false);this.value=asn1js.fromBER(valueBER).result.valueBlock.value}break;case 3:this.value=asn1.result.blockName;break;case 4:this.value=new _RelativeDistinguishedNames2.default({schema:asn1.result.directoryName});break;case 5:this.value=asn1.result.ediPartyName;break;case 7:this.value=new asn1js.OctetString({valueHex:asn1.result.blockName.valueBlock.valueHex});break;case 8:{var _value=asn1.result.blockName;_value.idBlock.tagClass=1;_value.idBlock.tagNumber=6;var _valueBER=_value.toBER(false);this.value=asn1js.fromBER(_valueBER).result.valueBlock.toString()}break;default:}}},{key:"toSchema",value:function toSchema(){switch(this.type){case 0:case 3:case 5:return new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:this.type},value:[this.value]});case 1:case 2:case 6:{var value=new asn1js.IA5String({value:this.value});value.idBlock.tagClass=3;value.idBlock.tagNumber=this.type;return value}case 4:return new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:4},value:[this.value.toSchema()]});case 7:{var _value2=this.value;_value2.idBlock.tagClass=3;_value2.idBlock.tagNumber=this.type;return _value2}case 8:{var _value3=new asn1js.ObjectIdentifier({value:this.value});_value3.idBlock.tagClass=3;_value3.idBlock.tagNumber=this.type;return _value3}default:return GeneralName.schema()}}},{key:"toJSON",value:function toJSON(){var _object={type:this.type};if(typeof this.value==="string")_object.value=this.value;else _object.value=this.value.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"type":return 9;case"value":return{};default:throw new Error("Invalid member name for GeneralName class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"type":return memberValue===GeneralName.defaultValues(memberName);case"value":return Object.keys(memberValue).length===0;default:throw new Error("Invalid member name for GeneralName class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Choice({value:[new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},name:names.blockName||"",value:[new asn1js.ObjectIdentifier,new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Any]})]}),new asn1js.Primitive({name:names.blockName||"",idBlock:{tagClass:3,tagNumber:1}}),new asn1js.Primitive({name:names.blockName||"",idBlock:{tagClass:3,tagNumber:2}}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:3},name:names.blockName||"",value:[builtInStandardAttributes(names.builtInStandardAttributes||{},false),builtInDomainDefinedAttributes(true),extensionAttributes(true)]}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:4},name:names.blockName||"",value:[_RelativeDistinguishedNames2.default.schema(names.directoryName||{})]}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:5},name:names.blockName||"",value:[new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Choice({value:[new asn1js.TeletexString,new asn1js.PrintableString,new asn1js.UniversalString,new asn1js.Utf8String,new asn1js.BmpString]})]}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.Choice({value:[new asn1js.TeletexString,new asn1js.PrintableString,new asn1js.UniversalString,new asn1js.Utf8String,new asn1js.BmpString]})]})]}),new asn1js.Primitive({name:names.blockName||"",idBlock:{tagClass:3,tagNumber:6}}),new asn1js.Primitive({name:names.blockName||"",idBlock:{tagClass:3,tagNumber:7}}),new asn1js.Primitive({name:names.blockName||"",idBlock:{tagClass:3,tagNumber:8}})]})}}]);return GeneralName}();exports.default=GeneralName},{"./RelativeDistinguishedNames.js":85,asn1js:"asn1js",pvutils:"pvutils"}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _GeneralName=require("./GeneralName.js");var _GeneralName2=_interopRequireDefault(_GeneralName);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var GeneralNames=function(){function GeneralNames(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,GeneralNames);this.names=(0,_pvutils.getParametersValue)(parameters,"names",GeneralNames.defaultValues("names"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(GeneralNames,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,GeneralNames.schema({names:{blockName:"names",generalNames:"generalNames"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for GeneralNames");this.names=Array.from(asn1.result.generalNames,function(element){return new _GeneralName2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:Array.from(this.names,function(element){return element.toSchema()})})}},{key:"toJSON",value:function toJSON(){return{names:Array.from(this.names,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"names":return[];default:throw new Error("Invalid member name for GeneralNames class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var optional=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({optional:optional,name:names.blockName||"",value:[new asn1js.Repeated({name:names.generalNames||"",value:_GeneralName2.default.schema()})]})}}]);return GeneralNames}();exports.default=GeneralNames},{"./GeneralName.js":37,asn1js:"asn1js",pvutils:"pvutils"}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _GeneralName=require("./GeneralName.js");var _GeneralName2=_interopRequireDefault(_GeneralName);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var GeneralSubtree=function(){function GeneralSubtree(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,GeneralSubtree);this.base=(0,_pvutils.getParametersValue)(parameters,"base",GeneralSubtree.defaultValues("base"));this.minimum=(0,_pvutils.getParametersValue)(parameters,"minimum",GeneralSubtree.defaultValues("minimum"));if("maximum"in parameters)this.maximum=(0,_pvutils.getParametersValue)(parameters,"maximum",GeneralSubtree.defaultValues("maximum"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(GeneralSubtree,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,GeneralSubtree.schema({names:{base:{names:{blockName:"base"}},minimum:"minimum",maximum:"maximum"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for ");this.base=new _GeneralName2.default({schema:asn1.result.base});if("minimum"in asn1.result){if(asn1.result.minimum.valueBlock.isHexOnly)this.minimum=asn1.result.minimum;else this.minimum=asn1.result.minimum.valueBlock.valueDec}if("maximum"in asn1.result){if(asn1.result.maximum.valueBlock.isHexOnly)this.maximum=asn1.result.maximum;else this.maximum=asn1.result.maximum.valueBlock.valueDec}}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(this.base.toSchema());if(this.minimum!==0){var valueMinimum=0;if(this.minimum instanceof asn1js.Integer)valueMinimum=this.minimum;else valueMinimum=new asn1js.Integer({value:this.minimum});outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[valueMinimum]}))}if("maximum"in this){var valueMaximum=0;if(this.maximum instanceof asn1js.Integer)valueMaximum=this.maximum;else valueMaximum=new asn1js.Integer({value:this.maximum});outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[valueMaximum]}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={base:this.base.toJSON()};if(this.minimum!==0){if(typeof this.minimum==="number")object.minimum=this.minimum;else object.minimum=this.minimum.toJSON()}if("maximum"in this){if(typeof this.maximum==="number")object.maximum=this.maximum;else object.maximum=this.maximum.toJSON()}return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"base":return new _GeneralName2.default;case"minimum":return 0;case"maximum":return 0;default:throw new Error("Invalid member name for GeneralSubtree class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_GeneralName2.default.schema(names.base||{}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Integer({name:names.minimum||""})]}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.Integer({name:names.maximum||""})]})]})}}]);return GeneralSubtree}();exports.default=GeneralSubtree},{"./GeneralName.js":37,asn1js:"asn1js",pvutils:"pvutils"}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AccessDescription=require("./AccessDescription.js");var _AccessDescription2=_interopRequireDefault(_AccessDescription);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var InfoAccess=function(){function InfoAccess(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,InfoAccess);this.accessDescriptions=(0,_pvutils.getParametersValue)(parameters,"accessDescriptions",InfoAccess.defaultValues("accessDescriptions"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(InfoAccess,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,InfoAccess.schema({names:{accessDescriptions:"accessDescriptions"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for InfoAccess");this.accessDescriptions=Array.from(asn1.result.accessDescriptions,function(element){return new _AccessDescription2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:Array.from(this.accessDescriptions,function(element){return element.toSchema()})})}},{key:"toJSON",value:function toJSON(){return{accessDescriptions:Array.from(this.accessDescriptions,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"accessDescriptions":return[];default:throw new Error("Invalid member name for InfoAccess class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Repeated({name:names.accessDescriptions||"",value:_AccessDescription2.default.schema()})]})}}]);return InfoAccess}();exports.default=InfoAccess},{"./AccessDescription.js":1,asn1js:"asn1js",pvutils:"pvutils"}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _RelativeDistinguishedNames=require("./RelativeDistinguishedNames.js");var _RelativeDistinguishedNames2=_interopRequireDefault(_RelativeDistinguishedNames);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var IssuerAndSerialNumber=function(){function IssuerAndSerialNumber(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,IssuerAndSerialNumber);this.issuer=(0,_pvutils.getParametersValue)(parameters,"issuer",IssuerAndSerialNumber.defaultValues("issuer"));this.serialNumber=(0,_pvutils.getParametersValue)(parameters,"serialNumber",IssuerAndSerialNumber.defaultValues("serialNumber"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(IssuerAndSerialNumber,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,IssuerAndSerialNumber.schema({names:{issuer:{names:{blockName:"issuer"}},serialNumber:"serialNumber"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for IssuerAndSerialNumber");this.issuer=new _RelativeDistinguishedNames2.default({schema:asn1.result.issuer});this.serialNumber=asn1.result.serialNumber}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[this.issuer.toSchema(),this.serialNumber]})}},{key:"toJSON",value:function toJSON(){return{issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"issuer":return new _RelativeDistinguishedNames2.default;case"serialNumber":return new asn1js.Integer;default:throw new Error("Invalid member name for IssuerAndSerialNumber class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_RelativeDistinguishedNames2.default.schema(names.issuer||{}),new asn1js.Integer({name:names.serialNumber||""})]})}}]);return IssuerAndSerialNumber}();exports.default=IssuerAndSerialNumber},{"./RelativeDistinguishedNames.js":85,asn1js:"asn1js",pvutils:"pvutils"}],42:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _GeneralName=require("./GeneralName.js");var _GeneralName2=_interopRequireDefault(_GeneralName);var _RelativeDistinguishedNames=require("./RelativeDistinguishedNames.js");var _RelativeDistinguishedNames2=_interopRequireDefault(_RelativeDistinguishedNames);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var IssuingDistributionPoint=function(){function IssuingDistributionPoint(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,IssuingDistributionPoint);if("distributionPoint"in parameters)this.distributionPoint=(0,_pvutils.getParametersValue)(parameters,"distributionPoint",IssuingDistributionPoint.defaultValues("distributionPoint"));this.onlyContainsUserCerts=(0,_pvutils.getParametersValue)(parameters,"onlyContainsUserCerts",IssuingDistributionPoint.defaultValues("onlyContainsUserCerts"));this.onlyContainsCACerts=(0,_pvutils.getParametersValue)(parameters,"onlyContainsCACerts",IssuingDistributionPoint.defaultValues("onlyContainsCACerts"));if("onlySomeReasons"in parameters)this.onlySomeReasons=(0,_pvutils.getParametersValue)(parameters,"onlySomeReasons",IssuingDistributionPoint.defaultValues("onlySomeReasons"));this.indirectCRL=(0,_pvutils.getParametersValue)(parameters,"indirectCRL",IssuingDistributionPoint.defaultValues("indirectCRL"));this.onlyContainsAttributeCerts=(0,_pvutils.getParametersValue)(parameters,"onlyContainsAttributeCerts",IssuingDistributionPoint.defaultValues("onlyContainsAttributeCerts"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(IssuingDistributionPoint,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,IssuingDistributionPoint.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",onlyContainsUserCerts:"onlyContainsUserCerts",onlyContainsCACerts:"onlyContainsCACerts",onlySomeReasons:"onlySomeReasons",indirectCRL:"indirectCRL",onlyContainsAttributeCerts:"onlyContainsAttributeCerts"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for IssuingDistributionPoint");if("distributionPoint"in asn1.result){switch(true){case asn1.result.distributionPoint.idBlock.tagNumber===0:this.distributionPoint=Array.from(asn1.result.distributionPointNames,function(element){return new _GeneralName2.default({schema:element})});break;case asn1.result.distributionPoint.idBlock.tagNumber===1:{asn1.result.distributionPoint.idBlock.tagClass=1;asn1.result.distributionPoint.idBlock.tagNumber=16;this.distributionPoint=new _RelativeDistinguishedNames2.default({schema:asn1.result.distributionPoint})}break;default:throw new Error("Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}")}}if("onlyContainsUserCerts"in asn1.result){var view=new Uint8Array(asn1.result.onlyContainsUserCerts.valueBlock.valueHex);this.onlyContainsUserCerts=view[0]!==0}if("onlyContainsCACerts"in asn1.result){var _view=new Uint8Array(asn1.result.onlyContainsCACerts.valueBlock.valueHex);this.onlyContainsCACerts=_view[0]!==0}if("onlySomeReasons"in asn1.result){var _view2=new Uint8Array(asn1.result.onlySomeReasons.valueBlock.valueHex);this.onlySomeReasons=_view2[0]}if("indirectCRL"in asn1.result){var _view3=new Uint8Array(asn1.result.indirectCRL.valueBlock.valueHex);this.indirectCRL=_view3[0]!==0}if("onlyContainsAttributeCerts"in asn1.result){var _view4=new Uint8Array(asn1.result.onlyContainsAttributeCerts.valueBlock.valueHex);this.onlyContainsAttributeCerts=_view4[0]!==0}}},{key:"toSchema",value:function toSchema(){var outputArray=[];if("distributionPoint"in this){var value=void 0;if(this.distributionPoint instanceof Array){value=new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,function(element){return element.toSchema()})})}else{value=this.distributionPoint.toSchema();value.idBlock.tagClass=3;value.idBlock.tagNumber=1}outputArray.push(value)}if(this.onlyContainsUserCerts!==IssuingDistributionPoint.defaultValues("onlyContainsUserCerts")){outputArray.push(new asn1js.Primitive({idBlock:{tagClass:3,tagNumber:1},valueHex:new Uint8Array([255]).buffer}))}if(this.onlyContainsCACerts!==IssuingDistributionPoint.defaultValues("onlyContainsCACerts")){outputArray.push(new asn1js.Primitive({idBlock:{tagClass:3,tagNumber:2},valueHex:new Uint8Array([255]).buffer}))}if("onlySomeReasons"in this){var buffer=new ArrayBuffer(1);var view=new Uint8Array(buffer);view[0]=this.onlySomeReasons;outputArray.push(new asn1js.Primitive({idBlock:{tagClass:3,tagNumber:3},valueHex:buffer}))}if(this.indirectCRL!==IssuingDistributionPoint.defaultValues("indirectCRL")){outputArray.push(new asn1js.Primitive({idBlock:{tagClass:3,tagNumber:4},valueHex:new Uint8Array([255]).buffer}))}if(this.onlyContainsAttributeCerts!==IssuingDistributionPoint.defaultValues("onlyContainsAttributeCerts")){outputArray.push(new asn1js.Primitive({idBlock:{tagClass:3,tagNumber:5},valueHex:new Uint8Array([255]).buffer}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={};if("distributionPoint"in this){if(this.distributionPoint instanceof Array)object.distributionPoint=Array.from(this.distributionPoint,function(element){return element.toJSON()});else object.distributionPoint=this.distributionPoint.toJSON()}if(this.onlyContainsUserCerts!==IssuingDistributionPoint.defaultValues("onlyContainsUserCerts"))object.onlyContainsUserCerts=this.onlyContainsUserCerts;if(this.onlyContainsCACerts!==IssuingDistributionPoint.defaultValues("onlyContainsCACerts"))object.onlyContainsCACerts=this.onlyContainsCACerts;if("onlySomeReasons"in this)object.onlySomeReasons=this.onlySomeReasons;if(this.indirectCRL!==IssuingDistributionPoint.defaultValues("indirectCRL"))object.indirectCRL=this.indirectCRL;if(this.onlyContainsAttributeCerts!==IssuingDistributionPoint.defaultValues("onlyContainsAttributeCerts"))object.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts;return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"distributionPoint":return[];case"onlyContainsUserCerts":return false;case"onlyContainsCACerts":return false;case"onlySomeReasons":return 0;case"indirectCRL":return false;case"onlyContainsAttributeCerts":return false;default:throw new Error("Invalid member name for IssuingDistributionPoint class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Choice({value:[new asn1js.Constructed({name:names.distributionPoint||"",idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Repeated({name:names.distributionPointNames||"",value:_GeneralName2.default.schema()})]}),new asn1js.Constructed({name:names.distributionPoint||"",idBlock:{tagClass:3,tagNumber:1},value:_RelativeDistinguishedNames2.default.schema().valueBlock.value})]})]}),new asn1js.Primitive({name:names.onlyContainsUserCerts||"",optional:true,idBlock:{tagClass:3,tagNumber:1}}),new asn1js.Primitive({name:names.onlyContainsCACerts||"",optional:true,idBlock:{tagClass:3,tagNumber:2}}),new asn1js.Primitive({name:names.onlySomeReasons||"",optional:true,idBlock:{tagClass:3,tagNumber:3}}),new asn1js.Primitive({name:names.indirectCRL||"",optional:true,idBlock:{tagClass:3,tagNumber:4}}),new asn1js.Primitive({name:names.onlyContainsAttributeCerts||"",optional:true,idBlock:{tagClass:3,tagNumber:5}})]})}}]);return IssuingDistributionPoint}();exports.default=IssuingDistributionPoint},{"./GeneralName.js":37,"./RelativeDistinguishedNames.js":85,asn1js:"asn1js",pvutils:"pvutils"}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _OtherKeyAttribute=require("./OtherKeyAttribute.js");var _OtherKeyAttribute2=_interopRequireDefault(_OtherKeyAttribute);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var KEKIdentifier=function(){function KEKIdentifier(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,KEKIdentifier);this.keyIdentifier=(0,_pvutils.getParametersValue)(parameters,"keyIdentifier",KEKIdentifier.defaultValues("keyIdentifier"));if("date"in parameters)this.date=(0,_pvutils.getParametersValue)(parameters,"date",KEKIdentifier.defaultValues("date"));if("other"in parameters)this.other=(0,_pvutils.getParametersValue)(parameters,"other",KEKIdentifier.defaultValues("other"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(KEKIdentifier,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,KEKIdentifier.schema({names:{keyIdentifier:"keyIdentifier",date:"date",other:{names:{blockName:"other"}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for KEKIdentifier");this.keyIdentifier=asn1.result.keyIdentifier;if("date"in asn1.result)this.date=asn1.result.date;if("other"in asn1.result)this.other=new _OtherKeyAttribute2.default({schema:asn1.result.other})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(this.keyIdentifier);if("date"in this)outputArray.push(this.date);if("other"in this)outputArray.push(this.other.toSchema());return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={keyIdentifier:this.keyIdentifier.toJSON()};if("date"in this)_object.date=this.date;if("other"in this)_object.other=this.other.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"keyIdentifier":return new asn1js.OctetString;case"date":return new asn1js.GeneralizedTime;case"other":return new _OtherKeyAttribute2.default;default:throw new Error("Invalid member name for KEKIdentifier class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"keyIdentifier":return memberValue.isEqual(KEKIdentifier.defaultValues("keyIdentifier"));case"date":return memberValue.year===0&&memberValue.month===0&&memberValue.day===0&&memberValue.hour===0&&memberValue.minute===0&&memberValue.second===0&&memberValue.millisecond===0;case"other":return memberValue.compareWithDefault("keyAttrId",memberValue.keyAttrId)&&"keyAttr"in memberValue===false;default:throw new Error("Invalid member name for KEKIdentifier class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.OctetString({name:names.keyIdentifier||""}),new asn1js.GeneralizedTime({optional:true,name:names.date||""}),_OtherKeyAttribute2.default.schema(names.other||{})]})}}]);return KEKIdentifier}();exports.default=KEKIdentifier},{"./OtherKeyAttribute.js":58,asn1js:"asn1js",pvutils:"pvutils"}],44:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _KEKIdentifier=require("./KEKIdentifier.js");var _KEKIdentifier2=_interopRequireDefault(_KEKIdentifier);var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var KEKRecipientInfo=function(){function KEKRecipientInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,KEKRecipientInfo);this.version=(0,_pvutils.getParametersValue)(parameters,"version",KEKRecipientInfo.defaultValues("version"));this.kekid=(0,_pvutils.getParametersValue)(parameters,"kekid",KEKRecipientInfo.defaultValues("kekid"));this.keyEncryptionAlgorithm=(0,_pvutils.getParametersValue)(parameters,"keyEncryptionAlgorithm",KEKRecipientInfo.defaultValues("keyEncryptionAlgorithm"));this.encryptedKey=(0,_pvutils.getParametersValue)(parameters,"encryptedKey",KEKRecipientInfo.defaultValues("encryptedKey"));this.preDefinedKEK=(0,_pvutils.getParametersValue)(parameters,"preDefinedKEK",KEKRecipientInfo.defaultValues("preDefinedKEK"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(KEKRecipientInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,KEKRecipientInfo.schema({names:{version:"version",kekid:{names:{blockName:"kekid"}},keyEncryptionAlgorithm:{names:{blockName:"keyEncryptionAlgorithm"}},encryptedKey:"encryptedKey"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for KEKRecipientInfo");this.version=asn1.result.version.valueBlock.valueDec;this.kekid=new _KEKIdentifier2.default({schema:asn1.result.kekid});this.keyEncryptionAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.keyEncryptionAlgorithm});this.encryptedKey=asn1.result.encryptedKey}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.Integer({value:this.version}),this.kekid.toSchema(),this.keyEncryptionAlgorithm.toSchema(),this.encryptedKey]})}},{key:"toJSON",value:function toJSON(){return{version:this.version,kekid:this.kekid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 0;case"kekid":return new _KEKIdentifier2.default;case"keyEncryptionAlgorithm":return new _AlgorithmIdentifier2.default;case"encryptedKey":return new asn1js.OctetString;case"preDefinedKEK":return new ArrayBuffer(0);default:throw new Error("Invalid member name for KEKRecipientInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"KEKRecipientInfo":return memberValue===KEKRecipientInfo.defaultValues("version");case"kekid":return memberValue.compareWithDefault("keyIdentifier",memberValue.keyIdentifier)&&"date"in memberValue===false&&"other"in memberValue===false;case"keyEncryptionAlgorithm":return memberValue.algorithmId===""&&"algorithmParams"in memberValue===false;case"encryptedKey":return memberValue.isEqual(KEKRecipientInfo.defaultValues("encryptedKey"));case"preDefinedKEK":return memberValue.byteLength===0;default:throw new Error("Invalid member name for KEKRecipientInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.version||""}),_KEKIdentifier2.default.schema(names.kekid||{}),_AlgorithmIdentifier2.default.schema(names.keyEncryptionAlgorithm||{}),new asn1js.OctetString({name:names.encryptedKey||""})]})}}]);return KEKRecipientInfo}();exports.default=KEKRecipientInfo},{"./AlgorithmIdentifier.js":3,"./KEKIdentifier.js":43,asn1js:"asn1js",pvutils:"pvutils"}],45:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _IssuerAndSerialNumber=require("./IssuerAndSerialNumber.js");var _IssuerAndSerialNumber2=_interopRequireDefault(_IssuerAndSerialNumber);var _RecipientKeyIdentifier=require("./RecipientKeyIdentifier.js");var _RecipientKeyIdentifier2=_interopRequireDefault(_RecipientKeyIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var KeyAgreeRecipientIdentifier=function(){function KeyAgreeRecipientIdentifier(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,KeyAgreeRecipientIdentifier);this.variant=(0,_pvutils.getParametersValue)(parameters,"variant",KeyAgreeRecipientIdentifier.defaultValues("variant"));this.value=(0,_pvutils.getParametersValue)(parameters,"value",KeyAgreeRecipientIdentifier.defaultValues("value"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(KeyAgreeRecipientIdentifier,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,KeyAgreeRecipientIdentifier.schema({names:{blockName:"blockName"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for KeyAgreeRecipientIdentifier");if(asn1.result.blockName.idBlock.tagClass===1){this.variant=1;this.value=new _IssuerAndSerialNumber2.default({schema:asn1.result.blockName})}else{this.variant=2;asn1.result.blockName.idBlock.tagClass=1;asn1.result.blockName.idBlock.tagNumber=16;this.value=new _RecipientKeyIdentifier2.default({schema:asn1.result.blockName})}}},{key:"toSchema",value:function toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:this.value.toSchema().valueBlock.value});default:return new asn1js.Any}}},{key:"toJSON",value:function toJSON(){var _object={variant:this.variant};if(this.variant===1||this.variant===2)_object.value=this.value.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"variant":return-1;case"value":return{};default:throw new Error("Invalid member name for KeyAgreeRecipientIdentifier class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"variant":return memberValue===-1;case"value":return Object.keys(memberValue).length===0;default:throw new Error("Invalid member name for KeyAgreeRecipientIdentifier class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Choice({value:[_IssuerAndSerialNumber2.default.schema(names.issuerAndSerialNumber||{names:{blockName:names.blockName||""}}),new asn1js.Constructed({name:names.blockName||"",idBlock:{tagClass:3,tagNumber:0},value:_RecipientKeyIdentifier2.default.schema(names.rKeyId||{names:{blockName:names.blockName||""}}).valueBlock.value})]})}}]);return KeyAgreeRecipientIdentifier}();exports.default=KeyAgreeRecipientIdentifier},{"./IssuerAndSerialNumber.js":41,"./RecipientKeyIdentifier.js":84,asn1js:"asn1js",pvutils:"pvutils"}],46:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _OriginatorIdentifierOrKey=require("./OriginatorIdentifierOrKey.js");var _OriginatorIdentifierOrKey2=_interopRequireDefault(_OriginatorIdentifierOrKey);var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _RecipientEncryptedKeys=require("./RecipientEncryptedKeys.js");var _RecipientEncryptedKeys2=_interopRequireDefault(_RecipientEncryptedKeys);var _Certificate=require("./Certificate.js");var _Certificate2=_interopRequireDefault(_Certificate);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var KeyAgreeRecipientInfo=function(){function KeyAgreeRecipientInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,KeyAgreeRecipientInfo);this.version=(0,_pvutils.getParametersValue)(parameters,"version",KeyAgreeRecipientInfo.defaultValues("version"));this.originator=(0,_pvutils.getParametersValue)(parameters,"originator",KeyAgreeRecipientInfo.defaultValues("originator"));if("ukm"in parameters)this.ukm=(0,_pvutils.getParametersValue)(parameters,"ukm",KeyAgreeRecipientInfo.defaultValues("ukm"));this.keyEncryptionAlgorithm=(0,_pvutils.getParametersValue)(parameters,"keyEncryptionAlgorithm",KeyAgreeRecipientInfo.defaultValues("keyEncryptionAlgorithm"));this.recipientEncryptedKeys=(0,_pvutils.getParametersValue)(parameters,"recipientEncryptedKeys",KeyAgreeRecipientInfo.defaultValues("recipientEncryptedKeys"));this.recipientCertificate=(0,_pvutils.getParametersValue)(parameters,"recipientCertificate",KeyAgreeRecipientInfo.defaultValues("recipientCertificate"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(KeyAgreeRecipientInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,KeyAgreeRecipientInfo.schema({names:{version:"version",originator:{names:{blockName:"originator"}},ukm:"ukm",keyEncryptionAlgorithm:{names:{blockName:"keyEncryptionAlgorithm"}},recipientEncryptedKeys:{names:{blockName:"recipientEncryptedKeys"}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for KeyAgreeRecipientInfo");this.version=asn1.result.version.valueBlock.valueDec;this.originator=new _OriginatorIdentifierOrKey2.default({schema:asn1.result.originator});if("ukm"in asn1.result)this.ukm=asn1.result.ukm;this.keyEncryptionAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.keyEncryptionAlgorithm});this.recipientEncryptedKeys=new _RecipientEncryptedKeys2.default({schema:asn1.result.recipientEncryptedKeys})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(new asn1js.Integer({value:this.version}));outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.originator.toSchema()]}));if("ukm"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[this.ukm]}))}outputArray.push(this.keyEncryptionAlgorithm.toSchema());outputArray.push(this.recipientEncryptedKeys.toSchema());return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={version:this.version,originator:this.originator.toJSON()};if("ukm"in this)_object.ukm=this.ukm.toJSON();_object.keyEncryptionAlgorithm=this.keyEncryptionAlgorithm.toJSON();_object.recipientEncryptedKeys=this.recipientEncryptedKeys.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 0;case"originator":return new _OriginatorIdentifierOrKey2.default;case"ukm":return new asn1js.OctetString;case"keyEncryptionAlgorithm":return new _AlgorithmIdentifier2.default;case"recipientEncryptedKeys":return new _RecipientEncryptedKeys2.default;case"recipientCertificate":return new _Certificate2.default;default:throw new Error("Invalid member name for KeyAgreeRecipientInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"version":return memberValue===0;case"originator":return memberValue.variant===-1&&"value"in memberValue===false;case"ukm":return memberValue.isEqual(KeyAgreeRecipientInfo.defaultValues("ukm"));case"keyEncryptionAlgorithm":return memberValue.algorithmId===""&&"algorithmParams"in memberValue===false;case"recipientEncryptedKeys":return memberValue.encryptedKeys.length===0;case"recipientCertificate":return false;default:throw new Error("Invalid member name for KeyAgreeRecipientInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.version||""}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[_OriginatorIdentifierOrKey2.default.schema(names.originator||{})]}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.OctetString({name:names.ukm||""})]}),_AlgorithmIdentifier2.default.schema(names.keyEncryptionAlgorithm||{}),_RecipientEncryptedKeys2.default.schema(names.recipientEncryptedKeys||{})]})}}]);return KeyAgreeRecipientInfo}();exports.default=KeyAgreeRecipientInfo},{"./AlgorithmIdentifier.js":3,"./Certificate.js":17,"./OriginatorIdentifierOrKey.js":54,"./RecipientEncryptedKeys.js":81,asn1js:"asn1js",pvutils:"pvutils"}],47:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _PrivateKeyInfo2=require("./PrivateKeyInfo.js");var _PrivateKeyInfo3=_interopRequireDefault(_PrivateKeyInfo2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var KeyBag=function(_PrivateKeyInfo){_inherits(KeyBag,_PrivateKeyInfo);function KeyBag(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,KeyBag);return _possibleConstructorReturn(this,(KeyBag.__proto__||Object.getPrototypeOf(KeyBag)).call(this,parameters))}return KeyBag}(_PrivateKeyInfo3.default);exports.default=KeyBag},{"./PrivateKeyInfo.js":73}],48:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _Certificate=require("./Certificate.js");var _Certificate2=_interopRequireDefault(_Certificate);var _RecipientIdentifier=require("./RecipientIdentifier.js");var _RecipientIdentifier2=_interopRequireDefault(_RecipientIdentifier);var _IssuerAndSerialNumber=require("./IssuerAndSerialNumber.js");var _IssuerAndSerialNumber2=_interopRequireDefault(_IssuerAndSerialNumber);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var KeyTransRecipientInfo=function(){function KeyTransRecipientInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,KeyTransRecipientInfo);this.version=(0,_pvutils.getParametersValue)(parameters,"version",KeyTransRecipientInfo.defaultValues("version"));this.rid=(0,_pvutils.getParametersValue)(parameters,"rid",KeyTransRecipientInfo.defaultValues("rid"));this.keyEncryptionAlgorithm=(0,_pvutils.getParametersValue)(parameters,"keyEncryptionAlgorithm",KeyTransRecipientInfo.defaultValues("keyEncryptionAlgorithm"));this.encryptedKey=(0,_pvutils.getParametersValue)(parameters,"encryptedKey",KeyTransRecipientInfo.defaultValues("encryptedKey"));this.recipientCertificate=(0,_pvutils.getParametersValue)(parameters,"recipientCertificate",KeyTransRecipientInfo.defaultValues("recipientCertificate"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(KeyTransRecipientInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,KeyTransRecipientInfo.schema({names:{version:"version",rid:{names:{blockName:"rid"}},keyEncryptionAlgorithm:{names:{blockName:"keyEncryptionAlgorithm"}},encryptedKey:"encryptedKey"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for KeyTransRecipientInfo");this.version=asn1.result.version.valueBlock.valueDec;if(asn1.result.rid.idBlock.tagClass===3)this.rid=asn1.result.rid.valueBlock.value[0];else this.rid=new _IssuerAndSerialNumber2.default({schema:asn1.result.rid});this.keyEncryptionAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.keyEncryptionAlgorithm});this.encryptedKey=asn1.result.encryptedKey}},{key:"toSchema",value:function toSchema(){var outputArray=[];if(this.rid instanceof _IssuerAndSerialNumber2.default){this.version=0;outputArray.push(new asn1js.Integer({value:this.version}));outputArray.push(this.rid.toSchema())}else{this.version=2;outputArray.push(new asn1js.Integer({value:this.version}));outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.rid]}))}outputArray.push(this.keyEncryptionAlgorithm.toSchema());outputArray.push(this.encryptedKey);return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){return{version:this.version,rid:this.rid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return-1;case"rid":return{};case"keyEncryptionAlgorithm":return new _AlgorithmIdentifier2.default;case"encryptedKey":return new asn1js.OctetString;case"recipientCertificate":return new _Certificate2.default;default:throw new Error("Invalid member name for KeyTransRecipientInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"version":return memberValue===KeyTransRecipientInfo.defaultValues("version");case"rid":return Object.keys(memberValue).length===0;case"keyEncryptionAlgorithm":case"encryptedKey":return memberValue.isEqual(KeyTransRecipientInfo.defaultValues(memberName));case"recipientCertificate":return false;default:throw new Error("Invalid member name for KeyTransRecipientInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.version||""}),_RecipientIdentifier2.default.schema(names.rid||{}),_AlgorithmIdentifier2.default.schema(names.keyEncryptionAlgorithm||{}),new asn1js.OctetString({name:names.encryptedKey||""})]})}}]);return KeyTransRecipientInfo}();exports.default=KeyTransRecipientInfo},{"./AlgorithmIdentifier.js":3,"./Certificate.js":17,"./IssuerAndSerialNumber.js":41,"./RecipientIdentifier.js":82,asn1js:"asn1js",pvutils:"pvutils"}],49:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _DigestInfo=require("./DigestInfo.js");var _DigestInfo2=_interopRequireDefault(_DigestInfo);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var MacData=function(){function MacData(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,MacData);this.mac=(0,_pvutils.getParametersValue)(parameters,"mac",MacData.defaultValues("mac"));this.macSalt=(0,_pvutils.getParametersValue)(parameters,"macSalt",MacData.defaultValues("macSalt"));if("iterations"in parameters)this.iterations=(0,_pvutils.getParametersValue)(parameters,"iterations",MacData.defaultValues("iterations"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(MacData,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,MacData.schema({names:{mac:{names:{blockName:"mac"}},macSalt:"macSalt",iterations:"iterations"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for MacData");this.mac=new _DigestInfo2.default({schema:asn1.result.mac});this.macSalt=asn1.result.macSalt;if("iterations"in asn1.result)this.iterations=asn1.result.iterations.valueBlock.valueDec}},{key:"toSchema",value:function toSchema(){var outputArray=[this.mac.toSchema(),this.macSalt];if("iterations"in this)outputArray.push(new asn1js.Integer({value:this.iterations}));return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var output={mac:this.mac.toJSON(),macSalt:this.macSalt.toJSON()};if("iterations"in this)output.iterations=this.iterations.toJSON();return output}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"mac":return new _DigestInfo2.default;case"macSalt":return new asn1js.OctetString;case"iterations":return 1;default:throw new Error("Invalid member name for MacData class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"mac":return _DigestInfo2.default.compareWithDefault("digestAlgorithm",memberValue.digestAlgorithm)&&_DigestInfo2.default.compareWithDefault("digest",memberValue.digest);case"macSalt":return memberValue.isEqual(MacData.defaultValues(memberName));case"iterations":return memberValue===MacData.defaultValues(memberName);default:throw new Error("Invalid member name for MacData class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",optional:names.optional||true,value:[_DigestInfo2.default.schema(names.mac||{names:{blockName:"mac"}}),new asn1js.OctetString({name:names.macSalt||"macSalt"}),new asn1js.Integer({optional:true,name:names.iterations||"iterations"})]})}}]);return MacData}();exports.default=MacData},{"./DigestInfo.js":25,asn1js:"asn1js",pvutils:"pvutils"}],50:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var MessageImprint=function(){function MessageImprint(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,MessageImprint);this.hashAlgorithm=(0,_pvutils.getParametersValue)(parameters,"hashAlgorithm",MessageImprint.defaultValues("hashAlgorithm"));this.hashedMessage=(0,_pvutils.getParametersValue)(parameters,"hashedMessage",MessageImprint.defaultValues("hashedMessage"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(MessageImprint,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,MessageImprint.schema({names:{hashAlgorithm:{names:{blockName:"hashAlgorithm"}},hashedMessage:"hashedMessage"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for MessageImprint");this.hashAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.hashAlgorithm});this.hashedMessage=asn1.result.hashedMessage}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[this.hashAlgorithm.toSchema(),this.hashedMessage]})}},{key:"toJSON",value:function toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),hashedMessage:this.hashedMessage.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"hashAlgorithm":return new _AlgorithmIdentifier2.default;case"hashedMessage":return new asn1js.OctetString;default:throw new Error("Invalid member name for MessageImprint class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"hashAlgorithm":return memberValue.algorithmId===""&&"algorithmParams"in memberValue===false;case"hashedMessage":return memberValue.isEqual(MessageImprint.defaultValues(memberName))===0;default:throw new Error("Invalid member name for MessageImprint class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_AlgorithmIdentifier2.default.schema(names.hashAlgorithm||{}),new asn1js.OctetString({name:names.hashedMessage||""})]})}}]);return MessageImprint}();exports.default=MessageImprint},{"./AlgorithmIdentifier.js":3,asn1js:"asn1js",pvutils:"pvutils"}],51:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _GeneralSubtree=require("./GeneralSubtree.js");var _GeneralSubtree2=_interopRequireDefault(_GeneralSubtree);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var NameConstraints=function(){function NameConstraints(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,NameConstraints);if("permittedSubtrees"in parameters)this.permittedSubtrees=(0,_pvutils.getParametersValue)(parameters,"permittedSubtrees",NameConstraints.defaultValues("permittedSubtrees"));if("excludedSubtrees"in parameters)this.excludedSubtrees=(0,_pvutils.getParametersValue)(parameters,"excludedSubtrees",NameConstraints.defaultValues("excludedSubtrees"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(NameConstraints,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,NameConstraints.schema({names:{permittedSubtrees:"permittedSubtrees",excludedSubtrees:"excludedSubtrees"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for NameConstraints");if("permittedSubtrees"in asn1.result)this.permittedSubtrees=Array.from(asn1.result.permittedSubtrees,function(element){return new _GeneralSubtree2.default({schema:element})});if("excludedSubtrees"in asn1.result)this.excludedSubtrees=Array.from(asn1.result.excludedSubtrees,function(element){return new _GeneralSubtree2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var outputArray=[];if("permittedSubtrees"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Sequence({value:Array.from(this.permittedSubtrees,function(element){return element.toSchema()})})]}))}if("excludedSubtrees"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.Sequence({value:Array.from(this.excludedSubtrees,function(element){return element.toSchema()})})]}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={};if("permittedSubtrees"in this)object.permittedSubtrees=Array.from(this.permittedSubtrees,function(element){return element.toJSON()});if("excludedSubtrees"in this)object.excludedSubtrees=Array.from(this.excludedSubtrees,function(element){return element.toJSON()});return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"permittedSubtrees":return[];case"excludedSubtrees":return[];default:throw new Error("Invalid member name for NameConstraints class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Repeated({name:names.permittedSubtrees||"",value:_GeneralSubtree2.default.schema()})]}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.Repeated({name:names.excludedSubtrees||"",value:_GeneralSubtree2.default.schema()})]})]})}}]);return NameConstraints}();exports.default=NameConstraints},{"./GeneralSubtree.js":39,asn1js:"asn1js",pvutils:"pvutils"}],52:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");var _TBSRequest=require("./TBSRequest.js");var _TBSRequest2=_interopRequireDefault(_TBSRequest);var _Signature=require("./Signature.js");var _Signature2=_interopRequireDefault(_Signature);var _Request=require("./Request.js");var _Request2=_interopRequireDefault(_Request);var _CertID=require("./CertID.js");var _CertID2=_interopRequireDefault(_CertID);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var OCSPRequest=function(){function OCSPRequest(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,OCSPRequest);this.tbsRequest=(0,_pvutils.getParametersValue)(parameters,"tbsRequest",OCSPRequest.defaultValues("tbsRequest"));if("optionalSignature"in parameters)this.optionalSignature=(0,_pvutils.getParametersValue)(parameters,"optionalSignature",OCSPRequest.defaultValues("optionalSignature"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(OCSPRequest,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,OCSPRequest.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for OCSP_REQUEST");this.tbsRequest=new _TBSRequest2.default({schema:asn1.result.tbsRequest});if("optionalSignature"in asn1.result)this.optionalSignature=new _Signature2.default({schema:asn1.result.optionalSignature})}},{key:"toSchema",value:function toSchema(){var encodeFlag=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var outputArray=[];outputArray.push(this.tbsRequest.toSchema(encodeFlag));if("optionalSignature"in this)outputArray.push(this.optionalSignature.toSchema());return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={tbsRequest:this.tbsRequest.toJSON()};if("optionalSignature"in this)_object.optionalSignature=this.optionalSignature.toJSON();return _object}},{key:"createForCertificate",value:function createForCertificate(certificate,parameters){var _this=this;var sequence=Promise.resolve();var certID=new _CertID2.default;sequence=sequence.then(function(){return certID.createForCertificate(certificate,parameters)});sequence=sequence.then(function(){_this.tbsRequest=new _TBSRequest2.default({requestList:[new _Request2.default({reqCert:certID})]})},function(error){return Promise.reject(error)});return sequence}},{key:"sign",value:function sign(privateKey){var _this2=this;var hashAlgorithm=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"SHA-1";if(typeof privateKey==="undefined")return Promise.reject("Need to provide a private key for signing");if("optionalSignature"in this===false)return Promise.reject('Need to create "optionalSignature" field before signing');var sequence=Promise.resolve();var parameters=void 0;var tbs=void 0;var engine=(0,_common.getEngine)();sequence=sequence.then(function(){return engine.subtle.getSignatureParameters(privateKey,hashAlgorithm)});sequence=sequence.then(function(result){parameters=result.parameters;_this2.optionalSignature.signatureAlgorithm=result.signatureAlgorithm});sequence=sequence.then(function(){tbs=_this2.tbsRequest.toSchema(true).toBER(false)});sequence=sequence.then(function(){return engine.subtle.signWithPrivateKey(tbs,privateKey,parameters)});sequence=sequence.then(function(result){_this2.optionalSignature.signature=new asn1js.BitString({valueHex:result})});return sequence}},{key:"verify",value:function verify(){}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"tbsRequest":return new _TBSRequest2.default;case"optionalSignature":return new _Signature2.default;default:throw new Error("Invalid member name for OCSPRequest class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"tbsRequest":return _TBSRequest2.default.compareWithDefault("tbs",memberValue.tbs)&&_TBSRequest2.default.compareWithDefault("version",memberValue.version)&&_TBSRequest2.default.compareWithDefault("requestorName",memberValue.requestorName)&&_TBSRequest2.default.compareWithDefault("requestList",memberValue.requestList)&&_TBSRequest2.default.compareWithDefault("requestExtensions",memberValue.requestExtensions);case"optionalSignature":return _Signature2.default.compareWithDefault("signatureAlgorithm",memberValue.signatureAlgorithm)&&_Signature2.default.compareWithDefault("signature",memberValue.signature)&&_Signature2.default.compareWithDefault("certs",memberValue.certs);default:throw new Error("Invalid member name for OCSPRequest class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"OCSPRequest",value:[_TBSRequest2.default.schema(names.tbsRequest||{names:{blockName:"tbsRequest"}}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[_Signature2.default.schema(names.optionalSignature||{names:{blockName:"optionalSignature"}})]})]})}}]);return OCSPRequest}();exports.default=OCSPRequest},{"./CertID.js":16,"./Request.js":86,"./Signature.js":94,"./TBSRequest.js":100,"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],53:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _ResponseBytes=require("./ResponseBytes.js");var _ResponseBytes2=_interopRequireDefault(_ResponseBytes);var _BasicOCSPResponse=require("./BasicOCSPResponse.js");var _BasicOCSPResponse2=_interopRequireDefault(_BasicOCSPResponse);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var OCSPResponse=function(){function OCSPResponse(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,OCSPResponse);this.responseStatus=(0,_pvutils.getParametersValue)(parameters,"responseStatus",OCSPResponse.defaultValues("responseStatus"));if("responseBytes"in parameters)this.responseBytes=(0,_pvutils.getParametersValue)(parameters,"responseBytes",OCSPResponse.defaultValues("responseBytes"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(OCSPResponse,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,OCSPResponse.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for OCSP_RESPONSE");this.responseStatus=asn1.result.responseStatus;if("responseBytes"in asn1.result)this.responseBytes=new _ResponseBytes2.default({schema:asn1.result.responseBytes})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(this.responseStatus);if("responseBytes"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.responseBytes.toSchema()]}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={responseStatus:this.responseStatus.toJSON()};if("responseBytes"in this)_object.responseBytes=this.responseBytes.toJSON();return _object}},{key:"getCertificateStatus",value:function getCertificateStatus(certificate,issuerCertificate){var basicResponse=void 0;var result={isForCertificate:false,status:2};if("responseBytes"in this===false)return result;if(this.responseBytes.responseType!=="1.3.6.1.5.5.7.48.1.1")return result;try{var asn1Basic=asn1js.fromBER(this.responseBytes.response.valueBlock.valueHex);basicResponse=new _BasicOCSPResponse2.default({schema:asn1Basic.result})}catch(ex){return result}return basicResponse.getCertificateStatus(certificate,issuerCertificate)}},{key:"sign",value:function sign(privateKey,hashAlgorithm){if(this.responseBytes.responseType==="1.3.6.1.5.5.7.48.1.1"){var asn1=asn1js.fromBER(this.responseBytes.response.valueBlock.valueHex);var basicResponse=new _BasicOCSPResponse2.default({schema:asn1.result});return basicResponse.sign(privateKey,hashAlgorithm)}return Promise.reject("Unknown ResponseBytes type: "+this.responseBytes.responseType)}},{key:"verify",value:function verify(){var issuerCertificate=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if("responseBytes"in this===false)return Promise.reject("Empty ResponseBytes field");if(this.responseBytes.responseType==="1.3.6.1.5.5.7.48.1.1"){var asn1=asn1js.fromBER(this.responseBytes.response.valueBlock.valueHex);var basicResponse=new _BasicOCSPResponse2.default({schema:asn1.result});if(issuerCertificate!==null){if("certs"in basicResponse===false)basicResponse.certs=[];basicResponse.certs.push(issuerCertificate)}return basicResponse.verify()}return Promise.reject("Unknown ResponseBytes type: "+this.responseBytes.responseType)}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"responseStatus":return new asn1js.Enumerated;case"responseBytes":return new _ResponseBytes2.default;default:throw new Error("Invalid member name for OCSPResponse class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"responseStatus":return memberValue.isEqual(OCSPResponse.defaultValues(memberName));case"responseBytes":return _ResponseBytes2.default.compareWithDefault("responseType",memberValue.responseType)&&_ResponseBytes2.default.compareWithDefault("response",memberValue.response);default:throw new Error("Invalid member name for OCSPResponse class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"OCSPResponse",value:[new asn1js.Enumerated({name:names.responseStatus||"responseStatus"}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[_ResponseBytes2.default.schema(names.responseBytes||{names:{blockName:"responseBytes"}})]})]})}}]);return OCSPResponse}();exports.default=OCSPResponse},{"./BasicOCSPResponse.js":12,"./ResponseBytes.js":87,asn1js:"asn1js",pvutils:"pvutils"}],54:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _IssuerAndSerialNumber=require("./IssuerAndSerialNumber.js");var _IssuerAndSerialNumber2=_interopRequireDefault(_IssuerAndSerialNumber);var _OriginatorPublicKey=require("./OriginatorPublicKey.js");var _OriginatorPublicKey2=_interopRequireDefault(_OriginatorPublicKey);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var OriginatorIdentifierOrKey=function(){function OriginatorIdentifierOrKey(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,OriginatorIdentifierOrKey);this.variant=(0,_pvutils.getParametersValue)(parameters,"variant",OriginatorIdentifierOrKey.defaultValues("variant"));if("value"in parameters)this.value=(0,_pvutils.getParametersValue)(parameters,"value",OriginatorIdentifierOrKey.defaultValues("value"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(OriginatorIdentifierOrKey,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,OriginatorIdentifierOrKey.schema({names:{blockName:"blockName"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for OriginatorIdentifierOrKey");if(asn1.result.blockName.idBlock.tagClass===1){this.variant=1;this.value=new _IssuerAndSerialNumber2.default({schema:asn1.result.blockName})}else{if(asn1.result.blockName.idBlock.tagNumber===0){asn1.result.blockName.idBlock.tagClass=1;asn1.result.blockName.idBlock.tagNumber=4;this.variant=2;this.value=asn1.result.blockName}else{asn1.result.blockName.idBlock.tagClass=1;asn1.result.blockName.idBlock.tagNumber=16;this.variant=3;this.value=new _OriginatorPublicKey2.default({schema:asn1.result.blockName})}}}},{key:"toSchema",value:function toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:this.value.idBlock.tagClass=3;this.value.idBlock.tagNumber=0;return this.value;case 3:{var _schema=this.value.toSchema();_schema.idBlock.tagClass=3;_schema.idBlock.tagNumber=1;return _schema}default:return new asn1js.Any}}},{key:"toJSON",value:function toJSON(){var _object={variant:this.variant};if(this.variant===1||this.variant===2||this.variant===3)_object.value=this.value.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"variant":return-1;case"value":return{};default:throw new Error("Invalid member name for OriginatorIdentifierOrKey class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"variant":return memberValue===-1;case"value":return Object.keys(memberValue).length===0;default:throw new Error("Invalid member name for OriginatorIdentifierOrKey class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Choice({value:[_IssuerAndSerialNumber2.default.schema({names:{blockName:names.blockName||""}}),new asn1js.Primitive({idBlock:{tagClass:3,tagNumber:0},name:names.blockName||""}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},name:names.blockName||"",value:_OriginatorPublicKey2.default.schema().valueBlock.value})]})}}]);return OriginatorIdentifierOrKey}();exports.default=OriginatorIdentifierOrKey},{"./IssuerAndSerialNumber.js":41,"./OriginatorPublicKey.js":56,asn1js:"asn1js",pvutils:"pvutils"}],55:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _CertificateSet=require("./CertificateSet.js");var _CertificateSet2=_interopRequireDefault(_CertificateSet);var _RevocationInfoChoices=require("./RevocationInfoChoices.js");var _RevocationInfoChoices2=_interopRequireDefault(_RevocationInfoChoices);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var OriginatorInfo=function(){function OriginatorInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,OriginatorInfo);this.certs=(0,_pvutils.getParametersValue)(parameters,"certs",OriginatorInfo.defaultValues("certs"));this.crls=(0,_pvutils.getParametersValue)(parameters,"crls",OriginatorInfo.defaultValues("crls"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(OriginatorInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,OriginatorInfo.schema({names:{certs:"certs",crls:"crls"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for OriginatorInfo");asn1.result.certs.idBlock.tagClass=1;asn1.result.certs.idBlock.tagNumber=17;this.certs=new _CertificateSet2.default({schema:asn1.result.certs});asn1.result.crls.idBlock.tagClass=1;asn1.result.crls.idBlock.tagNumber=17;this.crls=new _RevocationInfoChoices2.default({schema:asn1.result.crls})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:this.certs.toSchema().valueBlock.value}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:this.crls.toSchema().valueBlock.value})]})}},{key:"toJSON",value:function toJSON(){return{certs:this.certs.toJSON(),crls:this.crls.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"certs":return new _CertificateSet2.default;case"crls":return new _RevocationInfoChoices2.default;default:throw new Error("Invalid member name for OriginatorInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"certs":return memberValue.certificates.length===0;case"crls":return memberValue.crls.length===0&&memberValue.otherRevocationInfos.length===0;default:throw new Error("Invalid member name for OriginatorInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Constructed({name:names.certs||"",optional:true,idBlock:{tagClass:3,tagNumber:0},value:_CertificateSet2.default.schema().valueBlock.value}),new asn1js.Constructed({name:names.crls||"",optional:true,idBlock:{tagClass:3,tagNumber:1},value:_RevocationInfoChoices2.default.schema().valueBlock.value})]})}}]);return OriginatorInfo}();exports.default=OriginatorInfo},{"./CertificateSet.js":21,"./RevocationInfoChoices.js":89,asn1js:"asn1js",pvutils:"pvutils"}],56:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var OriginatorPublicKey=function(){function OriginatorPublicKey(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,OriginatorPublicKey);this.algorithm=(0,_pvutils.getParametersValue)(parameters,"algorithm",OriginatorPublicKey.defaultValues("algorithm"));this.publicKey=(0,_pvutils.getParametersValue)(parameters,"publicKey",OriginatorPublicKey.defaultValues("publicKey"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(OriginatorPublicKey,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,OriginatorPublicKey.schema({names:{algorithm:{names:{blockName:"algorithm"}},publicKey:"publicKey"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for OriginatorPublicKey");this.algorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.algorithm});this.publicKey=asn1.result.publicKey}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[this.algorithm.toSchema(),this.publicKey]})}},{key:"toJSON",value:function toJSON(){return{algorithm:this.algorithm.toJSON(),publicKey:this.publicKey.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"algorithm":return new _AlgorithmIdentifier2.default;case"publicKey":return new asn1js.BitString;default:throw new Error("Invalid member name for OriginatorPublicKey class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"algorithm":case"publicKey":return memberValue.isEqual(OriginatorPublicKey.defaultValues(memberName));default:throw new Error("Invalid member name for OriginatorPublicKey class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_AlgorithmIdentifier2.default.schema(names.algorithm||{}),new asn1js.BitString({name:names.publicKey||""})]})}}]);return OriginatorPublicKey}();exports.default=OriginatorPublicKey},{"./AlgorithmIdentifier.js":3,asn1js:"asn1js",pvutils:"pvutils"}],57:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var OtherCertificateFormat=function(){function OtherCertificateFormat(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,OtherCertificateFormat);this.otherCertFormat=(0,_pvutils.getParametersValue)(parameters,"otherCertFormat",OtherCertificateFormat.defaultValues("otherCertFormat"));this.otherCert=(0,_pvutils.getParametersValue)(parameters,"otherCert",OtherCertificateFormat.defaultValues("otherCert"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(OtherCertificateFormat,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,OtherCertificateFormat.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for OtherCertificateFormat");this.otherCertFormat=asn1.result.otherCertFormat.valueBlock.toString();this.otherCert=asn1.result.otherCert}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.ObjectIdentifier({value:this.otherCertFormat}),this.otherCert]})}},{key:"toJSON",value:function toJSON(){var object={otherCertFormat:this.otherCertFormat};if(!(this.otherCert instanceof asn1js.Any))object.otherCert=this.otherCert.toJSON();return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"otherCertFormat":return"";case"otherCert":return new asn1js.Any;default:throw new Error("Invalid member name for OtherCertificateFormat class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.otherCertFormat||"otherCertFormat"}),new asn1js.Any({name:names.otherCert||"otherCert"})]})}}]);return OtherCertificateFormat}();exports.default=OtherCertificateFormat},{asn1js:"asn1js",pvutils:"pvutils"}],58:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var OtherKeyAttribute=function(){function OtherKeyAttribute(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,OtherKeyAttribute);this.keyAttrId=(0,_pvutils.getParametersValue)(parameters,"keyAttrId",OtherKeyAttribute.defaultValues("keyAttrId"));if("keyAttr"in parameters)this.keyAttr=(0,_pvutils.getParametersValue)(parameters,"keyAttr",OtherKeyAttribute.defaultValues("keyAttr"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(OtherKeyAttribute,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,OtherKeyAttribute.schema({names:{keyAttrId:"keyAttrId",keyAttr:"keyAttr"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for OtherKeyAttribute");this.keyAttrId=asn1.result.keyAttrId.valueBlock.toString();if("keyAttr"in asn1.result)this.keyAttr=asn1.result.keyAttr}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(new asn1js.ObjectIdentifier({value:this.keyAttrId}));if("keyAttr"in this)outputArray.push(this.keyAttr.toSchema());return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={keyAttrId:this.keyAttrId};if("keyAttr"in this)_object.keyAttr=this.keyAttr.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"keyAttrId":return"";case"keyAttr":return{};default:throw new Error("Invalid member name for OtherKeyAttribute class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"keyAttrId":return memberValue==="";case"keyAttr":return Object.keys(memberValue).length===0;default:throw new Error("Invalid member name for OtherKeyAttribute class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({optional:names.optional||true,name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.keyAttrId||""}),new asn1js.Any({optional:true,name:names.keyAttr||""})]})}}]);return OtherKeyAttribute}();exports.default=OtherKeyAttribute},{asn1js:"asn1js",pvutils:"pvutils"}],59:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var OtherPrimeInfo=function(){function OtherPrimeInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,OtherPrimeInfo);this.prime=(0,_pvutils.getParametersValue)(parameters,"prime",OtherPrimeInfo.defaultValues("prime"));this.exponent=(0,_pvutils.getParametersValue)(parameters,"exponent",OtherPrimeInfo.defaultValues("exponent"));this.coefficient=(0,_pvutils.getParametersValue)(parameters,"coefficient",OtherPrimeInfo.defaultValues("coefficient"));if("schema"in parameters)this.fromSchema(parameters.schema);if("json"in parameters)this.fromJSON(parameters.json)}_createClass(OtherPrimeInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,OtherPrimeInfo.schema({names:{prime:"prime",exponent:"exponent",coefficient:"coefficient"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for OtherPrimeInfo");this.prime=asn1.result.prime.convertFromDER();this.exponent=asn1.result.exponent.convertFromDER();this.coefficient=asn1.result.coefficient.convertFromDER()}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[this.prime.convertToDER(),this.exponent.convertToDER(),this.coefficient.convertToDER()]})}},{key:"toJSON",value:function toJSON(){return{r:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.prime.valueBlock.valueHex),true,true),d:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.exponent.valueBlock.valueHex),true,true),t:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.coefficient.valueBlock.valueHex),true,true)}}},{key:"fromJSON",value:function fromJSON(json){if("r"in json)this.prime=new asn1js.Integer({valueHex:(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.r,true))});else throw new Error('Absent mandatory parameter "r"');if("d"in json)this.exponent=new asn1js.Integer({valueHex:(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.d,true))});else throw new Error('Absent mandatory parameter "d"');if("t"in json)this.coefficient=new asn1js.Integer({valueHex:(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.t,true))});else throw new Error('Absent mandatory parameter "t"')}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"prime":return new asn1js.Integer;case"exponent":return new asn1js.Integer;case"coefficient":return new asn1js.Integer;default:throw new Error("Invalid member name for OtherPrimeInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.prime||""}),new asn1js.Integer({name:names.exponent||""}),new asn1js.Integer({name:names.coefficient||""})]})}}]);return OtherPrimeInfo}();exports.default=OtherPrimeInfo},{asn1js:"asn1js",pvutils:"pvutils"}],60:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var OtherRecipientInfo=function(){function OtherRecipientInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,OtherRecipientInfo);this.oriType=(0,_pvutils.getParametersValue)(parameters,"oriType",OtherRecipientInfo.defaultValues("oriType"));this.oriValue=(0,_pvutils.getParametersValue)(parameters,"oriValue",OtherRecipientInfo.defaultValues("oriValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(OtherRecipientInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,OtherRecipientInfo.schema({names:{oriType:"oriType",oriValue:"oriValue"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for OtherRecipientInfo");this.oriType=asn1.result.oriType.valueBlock.toString();this.oriValue=asn1.result.oriValue}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.ObjectIdentifier({value:this.oriType}),this.oriValue]})}},{key:"toJSON",value:function toJSON(){var _object={oriType:this.oriType};if(OtherRecipientInfo.compareWithDefault("oriValue",this.oriValue)===false)_object.oriValue=this.oriValue.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"oriType":return"";case"oriValue":return{};default:throw new Error("Invalid member name for OtherRecipientInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"oriType":return memberValue==="";case"oriValue":return Object.keys(memberValue).length===0;default:throw new Error("Invalid member name for OtherRecipientInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.oriType||""}),new asn1js.Any({name:names.oriValue||""})]})}}]);return OtherRecipientInfo}();exports.default=OtherRecipientInfo},{asn1js:"asn1js",pvutils:"pvutils"}],61:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var OtherRevocationInfoFormat=function(){function OtherRevocationInfoFormat(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,OtherRevocationInfoFormat);this.otherRevInfoFormat=(0,_pvutils.getParametersValue)(parameters,"otherRevInfoFormat",OtherRevocationInfoFormat.defaultValues("otherRevInfoFormat"));this.otherRevInfo=(0,_pvutils.getParametersValue)(parameters,"otherRevInfo",OtherRevocationInfoFormat.defaultValues("otherRevInfo"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(OtherRevocationInfoFormat,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,OtherRevocationInfoFormat.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for OtherRevocationInfoFormat");this.otherRevInfoFormat=asn1.result.otherRevInfoFormat.valueBlock.toString();this.otherRevInfo=asn1.result.otherRevInfo}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.ObjectIdentifier({value:this.otherRevInfoFormat}),this.otherRevInfo]})}},{key:"toJSON",value:function toJSON(){var object={otherRevInfoFormat:this.otherRevInfoFormat};if(!(this.otherRevInfo instanceof asn1js.Any))object.otherRevInfo=this.otherRevInfo.toJSON();return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"otherRevInfoFormat":return"";case"otherRevInfo":return new asn1js.Any;default:throw new Error("Invalid member name for OtherRevocationInfoFormat class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.otherRevInfoFormat||"otherRevInfoFormat"}),new asn1js.Any({name:names.otherRevInfo||"otherRevInfo"})]})}}]);return OtherRevocationInfoFormat}();exports.default=OtherRevocationInfoFormat},{asn1js:"asn1js",pvutils:"pvutils"}],62:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PBES2Params=function(){function PBES2Params(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PBES2Params);this.keyDerivationFunc=(0,_pvutils.getParametersValue)(parameters,"keyDerivationFunc",PBES2Params.defaultValues("keyDerivationFunc"));this.encryptionScheme=(0,_pvutils.getParametersValue)(parameters,"encryptionScheme",PBES2Params.defaultValues("encryptionScheme"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(PBES2Params,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PBES2Params.schema({names:{keyDerivationFunc:{names:{blockName:"keyDerivationFunc"}},encryptionScheme:{names:{blockName:"encryptionScheme"}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PBES2_params");this.keyDerivationFunc=new _AlgorithmIdentifier2.default({schema:asn1.result.keyDerivationFunc});this.encryptionScheme=new _AlgorithmIdentifier2.default({schema:asn1.result.encryptionScheme})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[this.keyDerivationFunc.toSchema(),this.encryptionScheme.toSchema()]})}},{key:"toJSON",value:function toJSON(){return{keyDerivationFunc:this.keyDerivationFunc.toJSON(),encryptionScheme:this.encryptionScheme.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"keyDerivationFunc":return new _AlgorithmIdentifier2.default;case"encryptionScheme":return new _AlgorithmIdentifier2.default;default:throw new Error("Invalid member name for PBES2Params class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_AlgorithmIdentifier2.default.schema(names.keyDerivationFunc||{}),_AlgorithmIdentifier2.default.schema(names.encryptionScheme||{})]})}}]);return PBES2Params}();exports.default=PBES2Params},{"./AlgorithmIdentifier.js":3,asn1js:"asn1js",pvutils:"pvutils"}],63:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PBKDF2Params=function(){function PBKDF2Params(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PBKDF2Params);this.salt=(0,_pvutils.getParametersValue)(parameters,"salt",PBKDF2Params.defaultValues("salt"));this.iterationCount=(0,_pvutils.getParametersValue)(parameters,"iterationCount",PBKDF2Params.defaultValues("iterationCount"));if("keyLength"in parameters)this.keyLength=(0,_pvutils.getParametersValue)(parameters,"keyLength",PBKDF2Params.defaultValues("keyLength"));if("prf"in parameters)this.prf=(0,_pvutils.getParametersValue)(parameters,"prf",PBKDF2Params.defaultValues("prf"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(PBKDF2Params,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PBKDF2Params.schema({names:{saltPrimitive:"salt",saltConstructed:{names:{blockName:"salt"}},iterationCount:"iterationCount",keyLength:"keyLength",prf:{names:{blockName:"prf",optional:true}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PBKDF2_params");this.salt=asn1.result.salt;this.iterationCount=asn1.result.iterationCount.valueBlock.valueDec;if("keyLength"in asn1.result)this.keyLength=asn1.result.keyLength.valueBlock.valueDec;if("prf"in asn1.result)this.prf=new _AlgorithmIdentifier2.default({schema:asn1.result.prf})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(this.salt);outputArray.push(new asn1js.Integer({value:this.iterationCount}));if("keyLength"in this){if(PBKDF2Params.defaultValues("keyLength")!==this.keyLength)outputArray.push(new asn1js.Integer({value:this.keyLength}))}if("prf"in this){if(PBKDF2Params.defaultValues("prf").isEqual(this.prf)===false)outputArray.push(this.prf.toSchema())}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={salt:this.salt.toJSON(),iterationCount:this.iterationCount};if("keyLength"in this){if(PBKDF2Params.defaultValues("keyLength")!==this.keyLength)_object.keyLength=this.keyLength}if("prf"in this){if(PBKDF2Params.defaultValues("prf").isEqual(this.prf)===false)_object.prf=this.prf.toJSON()}return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"salt":return{};case"iterationCount":return-1;case"keyLength":return 0;case"prf":return new _AlgorithmIdentifier2.default({algorithmId:"1.3.14.3.2.26",algorithmParams:new asn1js.Null});default:throw new Error("Invalid member name for PBKDF2Params class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Choice({value:[new asn1js.OctetString({name:names.saltPrimitive||""}),_AlgorithmIdentifier2.default.schema(names.saltConstructed||{})]}),new asn1js.Integer({name:names.iterationCount||""}),new asn1js.Integer({name:names.keyLength||"",optional:true}),_AlgorithmIdentifier2.default.schema(names.prf||{names:{optional:true}})]})}}]);return PBKDF2Params}();exports.default=PBKDF2Params},{"./AlgorithmIdentifier.js":3,asn1js:"asn1js",pvutils:"pvutils"}],64:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");var _ContentInfo=require("./ContentInfo.js");var _ContentInfo2=_interopRequireDefault(_ContentInfo);var _MacData=require("./MacData.js");var _MacData2=_interopRequireDefault(_MacData);var _DigestInfo=require("./DigestInfo.js");var _DigestInfo2=_interopRequireDefault(_DigestInfo);var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _SignedData=require("./SignedData.js");var _SignedData2=_interopRequireDefault(_SignedData);var _EncapsulatedContentInfo=require("./EncapsulatedContentInfo.js");var _EncapsulatedContentInfo2=_interopRequireDefault(_EncapsulatedContentInfo);var _Attribute=require("./Attribute.js");var _Attribute2=_interopRequireDefault(_Attribute);var _SignerInfo=require("./SignerInfo.js");var _SignerInfo2=_interopRequireDefault(_SignerInfo);var _IssuerAndSerialNumber=require("./IssuerAndSerialNumber.js");var _IssuerAndSerialNumber2=_interopRequireDefault(_IssuerAndSerialNumber);var _SignedAndUnsignedAttributes=require("./SignedAndUnsignedAttributes.js");var _SignedAndUnsignedAttributes2=_interopRequireDefault(_SignedAndUnsignedAttributes);var _AuthenticatedSafe=require("./AuthenticatedSafe.js");var _AuthenticatedSafe2=_interopRequireDefault(_AuthenticatedSafe);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PFX=function(){function PFX(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PFX);this.version=(0,_pvutils.getParametersValue)(parameters,"version",PFX.defaultValues("version"));this.authSafe=(0,_pvutils.getParametersValue)(parameters,"authSafe",PFX.defaultValues("authSafe"));if("macData"in parameters)this.macData=(0,_pvutils.getParametersValue)(parameters,"macData",PFX.defaultValues("macData"));if("parsedValue"in parameters)this.parsedValue=(0,_pvutils.getParametersValue)(parameters,"parsedValue",PFX.defaultValues("parsedValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(PFX,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PFX.schema({names:{version:"version",authSafe:{names:{blockName:"authSafe"}},macData:{names:{blockName:"macData"}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PFX");this.version=asn1.result.version.valueBlock.valueDec;this.authSafe=new _ContentInfo2.default({schema:asn1.result.authSafe});if("macData"in asn1.result)this.macData=new _MacData2.default({schema:asn1.result.macData})}},{key:"toSchema",value:function toSchema(){var outputArray=[new asn1js.Integer({value:this.version}),this.authSafe.toSchema()];if("macData"in this)outputArray.push(this.macData.toSchema());return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var output={version:this.version,authSafe:this.authSafe.toJSON()};if("macData"in this)output.macData=this.macData.toJSON();return output}},{key:"makeInternalValues",value:function makeInternalValues(){var _this=this;var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(parameters instanceof Object===false)return Promise.reject('The "parameters" must has "Object" type');if("parsedValue"in this===false)return Promise.reject('Please call "parseValues" function first in order to make "parsedValue" data');if("integrityMode"in this.parsedValue===false)return Promise.reject('Absent mandatory parameter "integrityMode" inside "parsedValue"');var sequence=Promise.resolve();var crypto=(0,_common.getCrypto)();if(typeof crypto==="undefined")return Promise.reject("Unable to create WebCrypto object");if("authenticatedSafe"in this.parsedValue===false)return Promise.reject('Absent mandatory parameter "authenticatedSafe" in "parsedValue"');switch(this.parsedValue.integrityMode){case 0:{if("iterations"in parameters===false)return Promise.reject('Absent mandatory parameter "iterations"');if("pbkdf2HashAlgorithm"in parameters===false)return Promise.reject('Absent mandatory parameter "pbkdf2HashAlgorithm"');if("hmacHashAlgorithm"in parameters===false)return Promise.reject('Absent mandatory parameter "hmacHashAlgorithm"');if("password"in parameters===false)return Promise.reject('Absent mandatory parameter "password"');var saltBuffer=new ArrayBuffer(64);var saltView=new Uint8Array(saltBuffer);(0,_common.getRandomValues)(saltView);var data=this.parsedValue.authenticatedSafe.toSchema().toBER(false);this.authSafe=new _ContentInfo2.default({contentType:"1.2.840.113549.1.7.1",content:new asn1js.OctetString({valueHex:data})});var engine=(0,_common.getEngine)();if("stampDataWithPassword"in engine.subtle===false)return Promise.reject('No support for "stampDataWithPassword" in current engine "'+engine.name+'"');sequence=sequence.then(function(){return engine.subtle.stampDataWithPassword({password:parameters.password,hashAlgorithm:parameters.hmacHashAlgorithm,salt:saltBuffer,iterationCount:parameters.iterations,contentToStamp:data})});sequence=sequence.then(function(result){_this.macData=new _MacData2.default({mac:new _DigestInfo2.default({digestAlgorithm:new _AlgorithmIdentifier2.default({algorithmId:(0,_common.getOIDByAlgorithm)({name:parameters.hmacHashAlgorithm})}),digest:new asn1js.OctetString({valueHex:result})}),macSalt:new asn1js.OctetString({valueHex:saltBuffer}),iterations:parameters.iterations})},function(error){return Promise.reject(error)})}break;case 1:{if("signingCertificate"in parameters===false)return Promise.reject('Absent mandatory parameter "signingCertificate"');if("privateKey"in parameters===false)return Promise.reject('Absent mandatory parameter "privateKey"');if("hashAlgorithm"in parameters===false)return Promise.reject('Absent mandatory parameter "hashAlgorithm"');var toBeSigned=this.parsedValue.authenticatedSafe.toSchema().toBER(false);var cmsSigned=new _SignedData2.default({version:1,encapContentInfo:new _EncapsulatedContentInfo2.default({eContentType:"1.2.840.113549.1.7.1",eContent:new asn1js.OctetString({valueHex:toBeSigned})}),certificates:[parameters.signingCertificate]});sequence=sequence.then(function(){return crypto.digest({name:parameters.hashAlgorithm},new Uint8Array(toBeSigned))});sequence=sequence.then(function(result){var signedAttr=[];signedAttr.push(new _Attribute2.default({type:"1.2.840.113549.1.9.3",values:[new asn1js.ObjectIdentifier({value:"1.2.840.113549.1.7.1"})]}));signedAttr.push(new _Attribute2.default({type:"1.2.840.113549.1.9.5",values:[new asn1js.UTCTime({valueDate:new Date})]}));signedAttr.push(new _Attribute2.default({type:"1.2.840.113549.1.9.4",values:[new asn1js.OctetString({valueHex:result})]}));cmsSigned.signerInfos.push(new _SignerInfo2.default({version:1,sid:new _IssuerAndSerialNumber2.default({issuer:parameters.signingCertificate.issuer,serialNumber:parameters.signingCertificate.serialNumber}),signedAttrs:new _SignedAndUnsignedAttributes2.default({type:0,attributes:signedAttr})}))},function(error){return Promise.reject("Error during making digest for message: "+error)});sequence=sequence.then(function(){return cmsSigned.sign(parameters.privateKey,0,parameters.hashAlgorithm)});sequence=sequence.then(function(){_this.authSafe=new _ContentInfo2.default({contentType:"1.2.840.113549.1.7.2",content:cmsSigned.toSchema(true)})},function(error){return Promise.reject("Error during making signature: "+error)})}break;default:return Promise.reject('Parameter "integrityMode" has unknown value: '+parameters.integrityMode)}return sequence}},{key:"parseInternalValues",value:function parseInternalValues(parameters){var _this2=this;if(parameters instanceof Object===false)return Promise.reject('The "parameters" must has "Object" type');if("checkIntegrity"in parameters===false)parameters.checkIntegrity=true;var sequence=Promise.resolve();var crypto=(0,_common.getCrypto)();if(typeof crypto==="undefined")return Promise.reject("Unable to create WebCrypto object");this.parsedValue={};switch(this.authSafe.contentType){case"1.2.840.113549.1.7.1":{if("password"in parameters===false)return Promise.reject('Absent mandatory parameter "password"');this.parsedValue.integrityMode=0;if(this.authSafe.content instanceof asn1js.OctetString===false)return Promise.reject('Wrong type of "this.authSafe.content"');var authSafeContent=new ArrayBuffer(0);if(this.authSafe.content.valueBlock.isConstructed){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.authSafe.content.valueBlock.value[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var contentValue=_step.value;authSafeContent=(0,_pvutils.utilConcatBuf)(authSafeContent,contentValue.valueBlock.valueHex)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}else authSafeContent=this.authSafe.content.valueBlock.valueHex;var asn1=asn1js.fromBER(authSafeContent);if(asn1.offset===-1)return Promise.reject('Error during parsing of ASN.1 data inside "this.authSafe.content"');this.parsedValue.authenticatedSafe=new _AuthenticatedSafe2.default({schema:asn1.result});if(parameters.checkIntegrity){if("macData"in this===false)return Promise.reject('Absent "macData" value, can not check PKCS#12 data integrity');var hashAlgorithm=(0,_common.getAlgorithmByOID)(this.macData.mac.digestAlgorithm.algorithmId);if("name"in hashAlgorithm===false)return Promise.reject("Unsupported digest algorithm: "+this.macData.mac.digestAlgorithm.algorithmId);var engine=(0,_common.getEngine)();sequence=sequence.then(function(){return engine.subtle.verifyDataStampedWithPassword({password:parameters.password,hashAlgorithm:hashAlgorithm.name,salt:_this2.macData.macSalt.valueBlock.valueHex,iterationCount:_this2.macData.iterations,contentToVerify:authSafeContent,signatureToVerify:_this2.macData.mac.digest.valueBlock.valueHex})});sequence=sequence.then(function(result){if(result===false)return Promise.reject("Integrity for the PKCS#12 data is broken!");return Promise.resolve()},function(error){return Promise.reject(error)})}}break;case"1.2.840.113549.1.7.2":{this.parsedValue.integrityMode=1;var cmsSigned=new _SignedData2.default({schema:this.authSafe.content});if("eContent"in cmsSigned.encapContentInfo===false)return Promise.reject('Absent of attached data in "cmsSigned.encapContentInfo"');if(cmsSigned.encapContentInfo.eContent instanceof asn1js.OctetString===false)return Promise.reject('Wrong type of "cmsSigned.encapContentInfo.eContent"');var data=new ArrayBuffer(0);if(cmsSigned.encapContentInfo.eContent.idBlock.isConstructed===false)data=cmsSigned.encapContentInfo.eContent.valueBlock.valueHex;else{for(var i=0;i<cmsSigned.encapContentInfo.eContent.valueBlock.value.length;i++){data=(0,_pvutils.utilConcatBuf)(data,cmsSigned.encapContentInfo.eContent.valueBlock.value[i].valueBlock.valueHex)}}var _asn=asn1js.fromBER(data);if(_asn.offset===-1)return Promise.reject('Error during parsing of ASN.1 data inside "this.authSafe.content"');this.parsedValue.authenticatedSafe=new _AuthenticatedSafe2.default({schema:_asn.result});sequence=sequence.then(function(){return cmsSigned.verify({signer:0,checkChain:false})}).then(function(result){if(result===false)return Promise.reject("Integrity for the PKCS#12 data is broken!");return Promise.resolve()},function(error){return Promise.reject("Error during integrity verification: "+error)})}break;default:return Promise.reject('Incorrect value for "this.authSafe.contentType": '+this.authSafe.contentType)}return sequence.then(function(){return _this2},function(error){return Promise.reject("Error during parsing: "+error)})}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 3;case"authSafe":return new _ContentInfo2.default;case"macData":return new _MacData2.default;case"parsedValue":return{};default:throw new Error("Invalid member name for PFX class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"version":return memberValue===PFX.defaultValues(memberName);case"authSafe":return _ContentInfo2.default.compareWithDefault("contentType",memberValue.contentType)&&_ContentInfo2.default.compareWithDefault("content",memberValue.content);case"macData":return _MacData2.default.compareWithDefault("mac",memberValue.mac)&&_MacData2.default.compareWithDefault("macSalt",memberValue.macSalt)&&_MacData2.default.compareWithDefault("iterations",memberValue.iterations);case"parsedValue":return memberValue instanceof Object&&Object.keys(memberValue).length===0;default:throw new Error("Invalid member name for PFX class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.version||"version"}),_ContentInfo2.default.schema(names.authSafe||{names:{blockName:"authSafe"}}),_MacData2.default.schema(names.macData||{names:{blockName:"macData",optional:true}})]})}}]);return PFX}();exports.default=PFX},{"./AlgorithmIdentifier.js":3,"./Attribute.js":5,"./AuthenticatedSafe.js":9,"./ContentInfo.js":23,"./DigestInfo.js":25,"./EncapsulatedContentInfo.js":30,"./IssuerAndSerialNumber.js":41,"./MacData.js":49,"./SignedAndUnsignedAttributes.js":95,"./SignedData.js":96,"./SignerInfo.js":97,"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],65:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _EncryptedData=require("./EncryptedData.js");var _EncryptedData2=_interopRequireDefault(_EncryptedData);var _EncryptedContentInfo=require("./EncryptedContentInfo.js");var _EncryptedContentInfo2=_interopRequireDefault(_EncryptedContentInfo);var _PrivateKeyInfo=require("./PrivateKeyInfo.js");var _PrivateKeyInfo2=_interopRequireDefault(_PrivateKeyInfo);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PKCS8ShroudedKeyBag=function(){function PKCS8ShroudedKeyBag(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PKCS8ShroudedKeyBag);this.encryptionAlgorithm=(0,_pvutils.getParametersValue)(parameters,"encryptionAlgorithm",PKCS8ShroudedKeyBag.defaultValues("encryptionAlgorithm"));this.encryptedData=(0,_pvutils.getParametersValue)(parameters,"encryptedData",PKCS8ShroudedKeyBag.defaultValues("encryptedData"));if("parsedValue"in parameters)this.parsedValue=(0,_pvutils.getParametersValue)(parameters,"parsedValue",PKCS8ShroudedKeyBag.defaultValues("parsedValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(PKCS8ShroudedKeyBag,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PKCS8ShroudedKeyBag.schema({names:{encryptionAlgorithm:{names:{blockName:"encryptionAlgorithm"}},encryptedData:"encryptedData"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PKCS8ShroudedKeyBag");this.encryptionAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.encryptionAlgorithm});this.encryptedData=asn1.result.encryptedData}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[this.encryptionAlgorithm.toSchema(),this.encryptedData]})}},{key:"toJSON",value:function toJSON(){return{encryptionAlgorithm:this.encryptionAlgorithm.toJSON(),encryptedData:this.encryptedData.toJSON()}}},{key:"parseInternalValues",value:function parseInternalValues(parameters){var _this=this;var sequence=Promise.resolve();var cmsEncrypted=new _EncryptedData2.default({encryptedContentInfo:new _EncryptedContentInfo2.default({contentEncryptionAlgorithm:this.encryptionAlgorithm,encryptedContent:this.encryptedData})});sequence=sequence.then(function(){return cmsEncrypted.decrypt(parameters)},function(error){return Promise.reject(error)});sequence=sequence.then(function(result){var asn1=asn1js.fromBER(result);if(asn1.offset===-1)return Promise.reject("Error during parsing ASN.1 data");_this.parsedValue=new _PrivateKeyInfo2.default({schema:asn1.result});return Promise.resolve()},function(error){return Promise.reject(error)});return sequence}},{key:"makeInternalValues",value:function makeInternalValues(parameters){var _this2=this;if("parsedValue"in this===false)return Promise.reject('Please initialize "parsedValue" first');var sequence=Promise.resolve();var cmsEncrypted=new _EncryptedData2.default;sequence=sequence.then(function(){parameters.contentToEncrypt=_this2.parsedValue.toSchema().toBER(false);return cmsEncrypted.encrypt(parameters)},function(error){return Promise.reject(error)});sequence=sequence.then(function(){_this2.encryptionAlgorithm=cmsEncrypted.encryptedContentInfo.contentEncryptionAlgorithm;_this2.encryptedData=cmsEncrypted.encryptedContentInfo.encryptedContent});return sequence}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"encryptionAlgorithm":return new _AlgorithmIdentifier2.default;case"encryptedData":return new asn1js.OctetString;case"parsedValue":return{};default:throw new Error("Invalid member name for PKCS8ShroudedKeyBag class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"encryptionAlgorithm":return _AlgorithmIdentifier2.default.compareWithDefault("algorithmId",memberValue.algorithmId)&&"algorithmParams"in memberValue===false;case"encryptedData":return memberValue.isEqual(PKCS8ShroudedKeyBag.defaultValues(memberName));case"parsedValue":return memberValue instanceof Object&&Object.keys(memberValue).length===0;default:throw new Error("Invalid member name for PKCS8ShroudedKeyBag class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_AlgorithmIdentifier2.default.schema(names.encryptionAlgorithm||{names:{blockName:"encryptionAlgorithm"}}),new asn1js.Choice({value:[new asn1js.OctetString({name:names.encryptedData||"encryptedData"}),new asn1js.OctetString({idBlock:{isConstructed:true},name:names.encryptedData||"encryptedData"})]})]})}}]);return PKCS8ShroudedKeyBag}();exports.default=PKCS8ShroudedKeyBag},{"./AlgorithmIdentifier.js":3,"./EncryptedContentInfo.js":31,"./EncryptedData.js":32,"./PrivateKeyInfo.js":73,asn1js:"asn1js",pvutils:"pvutils"}],66:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PKIStatusInfo=function(){function PKIStatusInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PKIStatusInfo);this.status=(0,_pvutils.getParametersValue)(parameters,"status",PKIStatusInfo.defaultValues("status"));if("statusStrings"in parameters)this.statusStrings=(0,_pvutils.getParametersValue)(parameters,"statusStrings",PKIStatusInfo.defaultValues("statusStrings"));if("failInfo"in parameters)this.failInfo=(0,_pvutils.getParametersValue)(parameters,"failInfo",PKIStatusInfo.defaultValues("failInfo"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(PKIStatusInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PKIStatusInfo.schema({names:{status:"status",statusStrings:"statusStrings",failInfo:"failInfo"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PKIStatusInfo");var _status=asn1.result.status;if(_status.valueBlock.isHexOnly===true||_status.valueBlock.valueDec<0||_status.valueBlock.valueDec>5)throw new Error('PKIStatusInfo "status" has invalid value');this.status=_status.valueBlock.valueDec;if("statusStrings"in asn1.result)this.statusStrings=asn1.result.statusStrings;if("failInfo"in asn1.result)this.failInfo=asn1.result.failInfo}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(new asn1js.Integer({value:this.status}));if("statusStrings"in this){outputArray.push(new asn1js.Sequence({optional:true,value:this.statusStrings}))}if("failInfo"in this)outputArray.push(this.failInfo);return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={status:this.status};if("statusStrings"in this)_object.statusStrings=Array.from(this.statusStrings,function(element){return element.toJSON()});if("failInfo"in this)_object.failInfo=this.failInfo.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"status":return 2;case"statusStrings":return[];case"failInfo":return new asn1js.BitString;default:throw new Error("Invalid member name for PKIStatusInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"status":return memberValue===PKIStatusInfo.defaultValues(memberName);case"statusStrings":return memberValue.length===0;case"failInfo":return memberValue.isEqual(PKIStatusInfo.defaultValues(memberName));default:throw new Error("Invalid member name for PKIStatusInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.status||""}),new asn1js.Sequence({optional:true,value:[new asn1js.Repeated({name:names.statusStrings||"",value:new asn1js.Utf8String})]}),new asn1js.BitString({name:names.failInfo||"",optional:true})]})}}]);return PKIStatusInfo}();exports.default=PKIStatusInfo},{asn1js:"asn1js",pvutils:"pvutils"}],67:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PasswordRecipientinfo=function(){function PasswordRecipientinfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PasswordRecipientinfo);this.version=(0,_pvutils.getParametersValue)(parameters,"version",PasswordRecipientinfo.defaultValues("version"));if("keyDerivationAlgorithm"in parameters)this.keyDerivationAlgorithm=(0,_pvutils.getParametersValue)(parameters,"keyDerivationAlgorithm",PasswordRecipientinfo.defaultValues("keyDerivationAlgorithm"));this.keyEncryptionAlgorithm=(0,_pvutils.getParametersValue)(parameters,"keyEncryptionAlgorithm",PasswordRecipientinfo.defaultValues("keyEncryptionAlgorithm"));this.encryptedKey=(0,_pvutils.getParametersValue)(parameters,"encryptedKey",PasswordRecipientinfo.defaultValues("encryptedKey"));this.password=(0,_pvutils.getParametersValue)(parameters,"password",PasswordRecipientinfo.defaultValues("password"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(PasswordRecipientinfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PasswordRecipientinfo.schema({names:{version:"version",keyDerivationAlgorithm:"keyDerivationAlgorithm",keyEncryptionAlgorithm:{names:{blockName:"keyEncryptionAlgorithm"}},encryptedKey:"encryptedKey"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PasswordRecipientinfo");this.version=asn1.result.version.valueBlock.valueDec;if("keyDerivationAlgorithm"in asn1.result){asn1.result.keyDerivationAlgorithm.idBlock.tagClass=1;asn1.result.keyDerivationAlgorithm.idBlock.tagNumber=16;this.keyDerivationAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.keyDerivationAlgorithm})}this.keyEncryptionAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.keyEncryptionAlgorithm});this.encryptedKey=asn1.result.encryptedKey}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(new asn1js.Integer({value:this.version}));if("keyDerivationAlgorithm"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:this.keyDerivationAlgorithm.toSchema().valueBlock.value}))}outputArray.push(this.keyEncryptionAlgorithm.toSchema());outputArray.push(this.encryptedKey);return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){return{version:this.version,keyDerivationAlgorithm:this.keyDerivationAlgorithm.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return-1;case"keyDerivationAlgorithm":return new _AlgorithmIdentifier2.default;case"keyEncryptionAlgorithm":return new _AlgorithmIdentifier2.default;case"encryptedKey":return new asn1js.OctetString;case"password":return new ArrayBuffer(0);default:throw new Error("Invalid member name for PasswordRecipientinfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"version":return memberValue===-1;case"keyDerivationAlgorithm":case"keyEncryptionAlgorithm":return memberValue.algorithmId===""&&"algorithmParams"in memberValue===false;case"encryptedKey":return memberValue.isEqual(PasswordRecipientinfo.defaultValues("encryptedKey"));case"password":return memberValue.byteLength===0;default:throw new Error("Invalid member name for PasswordRecipientinfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.version||""}),new asn1js.Constructed({name:names.keyDerivationAlgorithm||"",optional:true,idBlock:{tagClass:3,tagNumber:0},value:_AlgorithmIdentifier2.default.schema().valueBlock.value}),_AlgorithmIdentifier2.default.schema(names.keyEncryptionAlgorithm||{}),new asn1js.OctetString({name:names.encryptedKey||""})]})}}]);return PasswordRecipientinfo}();exports.default=PasswordRecipientinfo},{"./AlgorithmIdentifier.js":3,asn1js:"asn1js",pvutils:"pvutils"}],68:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PolicyConstraints=function(){function PolicyConstraints(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PolicyConstraints);if("requireExplicitPolicy"in parameters)this.requireExplicitPolicy=(0,_pvutils.getParametersValue)(parameters,"requireExplicitPolicy",PolicyConstraints.defaultValues("requireExplicitPolicy"));if("inhibitPolicyMapping"in parameters)this.inhibitPolicyMapping=(0,_pvutils.getParametersValue)(parameters,"inhibitPolicyMapping",PolicyConstraints.defaultValues("inhibitPolicyMapping"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(PolicyConstraints,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PolicyConstraints.schema({names:{requireExplicitPolicy:"requireExplicitPolicy",inhibitPolicyMapping:"inhibitPolicyMapping"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PolicyConstraints");if("requireExplicitPolicy"in asn1.result){var field1=asn1.result.requireExplicitPolicy;field1.idBlock.tagClass=1;field1.idBlock.tagNumber=2;var ber1=field1.toBER(false);var int1=asn1js.fromBER(ber1);this.requireExplicitPolicy=int1.result.valueBlock.valueDec}if("inhibitPolicyMapping"in asn1.result){var field2=asn1.result.inhibitPolicyMapping;field2.idBlock.tagClass=1;field2.idBlock.tagNumber=2;var ber2=field2.toBER(false);var int2=asn1js.fromBER(ber2);this.inhibitPolicyMapping=int2.result.valueBlock.valueDec}}},{key:"toSchema",value:function toSchema(){var outputArray=[];if("requireExplicitPolicy"in this){var int1=new asn1js.Integer({value:this.requireExplicitPolicy});int1.idBlock.tagClass=3;int1.idBlock.tagNumber=0;outputArray.push(int1)}if("inhibitPolicyMapping"in this){var int2=new asn1js.Integer({value:this.inhibitPolicyMapping});int2.idBlock.tagClass=3;int2.idBlock.tagNumber=1;outputArray.push(int2)}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={};if("requireExplicitPolicy"in this)object.requireExplicitPolicy=this.requireExplicitPolicy;if("inhibitPolicyMapping"in this)object.inhibitPolicyMapping=this.inhibitPolicyMapping;return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"requireExplicitPolicy":return 0;case"inhibitPolicyMapping":return 0;default:throw new Error("Invalid member name for PolicyConstraints class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Primitive({name:names.requireExplicitPolicy||"",optional:true,idBlock:{tagClass:3,tagNumber:0}}),new asn1js.Primitive({name:names.inhibitPolicyMapping||"",optional:true,idBlock:{tagClass:3,tagNumber:1}})]})}}]);return PolicyConstraints}();exports.default=PolicyConstraints},{asn1js:"asn1js",pvutils:"pvutils"}],69:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _PolicyQualifierInfo=require("./PolicyQualifierInfo.js");var _PolicyQualifierInfo2=_interopRequireDefault(_PolicyQualifierInfo);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PolicyInformation=function(){function PolicyInformation(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PolicyInformation);this.policyIdentifier=(0,_pvutils.getParametersValue)(parameters,"policyIdentifier",PolicyInformation.defaultValues("policyIdentifier"));if("policyQualifiers"in parameters)this.policyQualifiers=(0,_pvutils.getParametersValue)(parameters,"policyQualifiers",PolicyInformation.defaultValues("policyQualifiers"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(PolicyInformation,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PolicyInformation.schema({names:{policyIdentifier:"policyIdentifier",policyQualifiers:"policyQualifiers"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PolicyInformation");this.policyIdentifier=asn1.result.policyIdentifier.valueBlock.toString();if("policyQualifiers"in asn1.result)this.policyQualifiers=Array.from(asn1.result.policyQualifiers,function(element){return new _PolicyQualifierInfo2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(new asn1js.ObjectIdentifier({value:this.policyIdentifier}));if("policyQualifiers"in this){outputArray.push(new asn1js.Sequence({value:Array.from(this.policyQualifiers,function(element){return element.toSchema()})}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={policyIdentifier:this.policyIdentifier};if("policyQualifiers"in this)object.policyQualifiers=Array.from(this.policyQualifiers,function(element){return element.toJSON()});return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"policyIdentifier":return"";case"policyQualifiers":return[];default:throw new Error("Invalid member name for PolicyInformation class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.policyIdentifier||""}),new asn1js.Sequence({optional:true,value:[new asn1js.Repeated({name:names.policyQualifiers||"",value:_PolicyQualifierInfo2.default.schema()})]})]})}}]);return PolicyInformation}();exports.default=PolicyInformation},{"./PolicyQualifierInfo.js":72,asn1js:"asn1js",pvutils:"pvutils"}],70:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PolicyMapping=function(){function PolicyMapping(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PolicyMapping);this.issuerDomainPolicy=(0,_pvutils.getParametersValue)(parameters,"issuerDomainPolicy",PolicyMapping.defaultValues("issuerDomainPolicy"));this.subjectDomainPolicy=(0,_pvutils.getParametersValue)(parameters,"subjectDomainPolicy",PolicyMapping.defaultValues("subjectDomainPolicy"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(PolicyMapping,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PolicyMapping.schema({names:{issuerDomainPolicy:"issuerDomainPolicy",subjectDomainPolicy:"subjectDomainPolicy"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PolicyMapping");this.issuerDomainPolicy=asn1.result.issuerDomainPolicy.valueBlock.toString();this.subjectDomainPolicy=asn1.result.subjectDomainPolicy.valueBlock.toString()}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.ObjectIdentifier({value:this.issuerDomainPolicy}),new asn1js.ObjectIdentifier({value:this.subjectDomainPolicy})]})}},{key:"toJSON",value:function toJSON(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"issuerDomainPolicy":return"";case"subjectDomainPolicy":return"";default:throw new Error("Invalid member name for PolicyMapping class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.issuerDomainPolicy||""}),new asn1js.ObjectIdentifier({name:names.subjectDomainPolicy||""})]})}}]);return PolicyMapping}();exports.default=PolicyMapping},{asn1js:"asn1js",pvutils:"pvutils"}],71:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _PolicyMapping=require("./PolicyMapping.js");var _PolicyMapping2=_interopRequireDefault(_PolicyMapping);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PolicyMappings=function(){function PolicyMappings(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PolicyMappings);this.mappings=(0,_pvutils.getParametersValue)(parameters,"mappings",PolicyMappings.defaultValues("mappings"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(PolicyMappings,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PolicyMappings.schema({names:{mappings:"mappings"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PolicyMappings");this.mappings=Array.from(asn1.result.mappings,function(element){return new _PolicyMapping2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:Array.from(this.mappings,function(element){return element.toSchema()})})}},{key:"toJSON",value:function toJSON(){return{mappings:Array.from(this.mappings,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"mappings":return[];default:throw new Error("Invalid member name for PolicyMappings class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Repeated({name:names.mappings||"",value:_PolicyMapping2.default.schema()})]})}}]);return PolicyMappings}();exports.default=PolicyMappings},{"./PolicyMapping.js":70,asn1js:"asn1js",pvutils:"pvutils"}],72:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PolicyQualifierInfo=function(){function PolicyQualifierInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PolicyQualifierInfo);this.policyQualifierId=(0,_pvutils.getParametersValue)(parameters,"policyQualifierId",PolicyQualifierInfo.defaultValues("policyQualifierId"));this.qualifier=(0,_pvutils.getParametersValue)(parameters,"qualifier",PolicyQualifierInfo.defaultValues("qualifier"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(PolicyQualifierInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PolicyQualifierInfo.schema({names:{policyQualifierId:"policyQualifierId",qualifier:"qualifier"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PolicyQualifierInfo");this.policyQualifierId=asn1.result.policyQualifierId.valueBlock.toString();this.qualifier=asn1.result.qualifier}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.ObjectIdentifier({value:this.policyQualifierId}),this.qualifier]})}},{key:"toJSON",value:function toJSON(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"policyQualifierId":return"";case"qualifier":return new asn1js.Any;default:throw new Error("Invalid member name for PolicyQualifierInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.policyQualifierId||""}),new asn1js.Any({name:names.qualifier||""})]})}}]);return PolicyQualifierInfo}();exports.default=PolicyQualifierInfo},{asn1js:"asn1js",pvutils:"pvutils"}],73:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _Attribute=require("./Attribute.js");var _Attribute2=_interopRequireDefault(_Attribute);var _ECPrivateKey=require("./ECPrivateKey.js");var _ECPrivateKey2=_interopRequireDefault(_ECPrivateKey);var _RSAPrivateKey=require("./RSAPrivateKey.js");var _RSAPrivateKey2=_interopRequireDefault(_RSAPrivateKey);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PrivateKeyInfo=function(){function PrivateKeyInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PrivateKeyInfo);this.version=(0,_pvutils.getParametersValue)(parameters,"version",PrivateKeyInfo.defaultValues("version"));this.privateKeyAlgorithm=(0,_pvutils.getParametersValue)(parameters,"privateKeyAlgorithm",PrivateKeyInfo.defaultValues("privateKeyAlgorithm"));this.privateKey=(0,_pvutils.getParametersValue)(parameters,"privateKey",PrivateKeyInfo.defaultValues("privateKey"));if("attributes"in parameters)this.attributes=(0,_pvutils.getParametersValue)(parameters,"attributes",PrivateKeyInfo.defaultValues("attributes"));if("parsedKey"in parameters)this.parsedKey=(0,_pvutils.getParametersValue)(parameters,"parsedKey",PrivateKeyInfo.defaultValues("parsedKey"));if("schema"in parameters)this.fromSchema(parameters.schema);if("json"in parameters)this.fromJSON(parameters.json)}_createClass(PrivateKeyInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PrivateKeyInfo.schema({names:{version:"version",privateKeyAlgorithm:{names:{blockName:"privateKeyAlgorithm"}},privateKey:"privateKey",attributes:"attributes"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PKCS8");this.version=asn1.result.version.valueBlock.valueDec;this.privateKeyAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.privateKeyAlgorithm});this.privateKey=asn1.result.privateKey;if("attributes"in asn1.result)this.attributes=Array.from(asn1.result.attributes,function(element){return new _Attribute2.default({schema:element})});switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.113549.1.1.1":{var privateKeyASN1=asn1js.fromBER(this.privateKey.valueBlock.valueHex);if(privateKeyASN1.offset!==-1)this.parsedKey=new _RSAPrivateKey2.default({schema:privateKeyASN1.result})}break;case"1.2.840.10045.2.1":if("algorithmParams"in this.privateKeyAlgorithm){if(this.privateKeyAlgorithm.algorithmParams instanceof asn1js.ObjectIdentifier){var _privateKeyASN=asn1js.fromBER(this.privateKey.valueBlock.valueHex);if(_privateKeyASN.offset!==-1){this.parsedKey=new _ECPrivateKey2.default({namedCurve:this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),schema:_privateKeyASN.result})}}}break;default:}}},{key:"toSchema",value:function toSchema(){var outputArray=[new asn1js.Integer({value:this.version}),this.privateKeyAlgorithm.toSchema(),this.privateKey];if("attributes"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,function(element){return element.toSchema()})}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){if("parsedKey"in this===false){var object={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};if("attributes"in this)object.attributes=Array.from(this.attributes,function(element){return element.toJSON()});return object}var jwk={};switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.10045.2.1":jwk.kty="EC";break;case"1.2.840.113549.1.1.1":jwk.kty="RSA";break;default:}var publicKeyJWK=this.parsedKey.toJSON();var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=Object.keys(publicKeyJWK)[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var key=_step.value;jwk[key]=publicKeyJWK[key]}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return jwk}},{key:"fromJSON",value:function fromJSON(json){if("kty"in json){switch(json.kty.toUpperCase()){case"EC":this.parsedKey=new _ECPrivateKey2.default({json:json});this.privateKeyAlgorithm=new _AlgorithmIdentifier2.default({algorithmId:"1.2.840.10045.2.1",algorithmParams:new asn1js.ObjectIdentifier({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new _RSAPrivateKey2.default({json:json});this.privateKeyAlgorithm=new _AlgorithmIdentifier2.default({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new asn1js.Null});break;default:throw new Error('Invalid value for "kty" parameter: '+json.kty)}this.privateKey=new asn1js.OctetString({valueHex:this.parsedKey.toSchema().toBER(false)})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 0;case"privateKeyAlgorithm":return new _AlgorithmIdentifier2.default;case"privateKey":return new asn1js.OctetString;case"attributes":return[];case"parsedKey":return{};default:throw new Error("Invalid member name for PrivateKeyInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.version||""}),_AlgorithmIdentifier2.default.schema(names.privateKeyAlgorithm||{}),new asn1js.OctetString({name:names.privateKey||""}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Repeated({name:names.attributes||"",value:_Attribute2.default.schema()})]})]})}}]);return PrivateKeyInfo}();exports.default=PrivateKeyInfo},{"./AlgorithmIdentifier.js":3,"./Attribute.js":5,"./ECPrivateKey.js":28,"./RSAPrivateKey.js":77,asn1js:"asn1js",pvutils:"pvutils"}],74:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PrivateKeyUsagePeriod=function(){function PrivateKeyUsagePeriod(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PrivateKeyUsagePeriod);if("notBefore"in parameters)this.notBefore=(0,_pvutils.getParametersValue)(parameters,"notBefore",PrivateKeyUsagePeriod.defaultValues("notBefore"));if("notAfter"in parameters)this.notAfter=(0,_pvutils.getParametersValue)(parameters,"notAfter",PrivateKeyUsagePeriod.defaultValues("notAfter"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(PrivateKeyUsagePeriod,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PrivateKeyUsagePeriod.schema({names:{notBefore:"notBefore",notAfter:"notAfter"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PrivateKeyUsagePeriod");if("notBefore"in asn1.result){var localNotBefore=new asn1js.GeneralizedTime;localNotBefore.fromBuffer(asn1.result.notBefore.valueBlock.valueHex);this.notBefore=localNotBefore.toDate()}if("notAfter"in asn1.result){var localNotAfter=new asn1js.GeneralizedTime({valueHex:asn1.result.notAfter.valueBlock.valueHex});localNotAfter.fromBuffer(asn1.result.notAfter.valueBlock.valueHex);this.notAfter=localNotAfter.toDate()}}},{key:"toSchema",value:function toSchema(){var outputArray=[];if("notBefore"in this){outputArray.push(new asn1js.Primitive({idBlock:{tagClass:3,tagNumber:0},valueHex:new asn1js.GeneralizedTime({valueDate:this.notBefore}).valueBlock.valueHex}))}if("notAfter"in this){outputArray.push(new asn1js.Primitive({idBlock:{tagClass:3,tagNumber:1},valueHex:new asn1js.GeneralizedTime({valueDate:this.notAfter}).valueBlock.valueHex}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={};if("notBefore"in this)object.notBefore=this.notBefore;if("notAfter"in this)object.notAfter=this.notAfter;return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"notBefore":return new Date;case"notAfter":return new Date;default:throw new Error("Invalid member name for PrivateKeyUsagePeriod class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Primitive({name:names.notBefore||"",optional:true,idBlock:{tagClass:3,tagNumber:0}}),new asn1js.Primitive({name:names.notAfter||"",optional:true,idBlock:{tagClass:3,tagNumber:1}})]})}}]);return PrivateKeyUsagePeriod}();exports.default=PrivateKeyUsagePeriod},{asn1js:"asn1js",pvutils:"pvutils"}],75:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _ECPublicKey=require("./ECPublicKey.js");var _ECPublicKey2=_interopRequireDefault(_ECPublicKey);var _RSAPublicKey=require("./RSAPublicKey.js");var _RSAPublicKey2=_interopRequireDefault(_RSAPublicKey);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PublicKeyInfo=function(){function PublicKeyInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,PublicKeyInfo);this.algorithm=(0,_pvutils.getParametersValue)(parameters,"algorithm",PublicKeyInfo.defaultValues("algorithm"));this.subjectPublicKey=(0,_pvutils.getParametersValue)(parameters,"subjectPublicKey",PublicKeyInfo.defaultValues("subjectPublicKey"));if("parsedKey"in parameters)this.parsedKey=(0,_pvutils.getParametersValue)(parameters,"parsedKey",PublicKeyInfo.defaultValues("parsedKey"));if("schema"in parameters)this.fromSchema(parameters.schema);if("json"in parameters)this.fromJSON(parameters.json)}_createClass(PublicKeyInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,PublicKeyInfo.schema({names:{algorithm:{names:{blockName:"algorithm"}},subjectPublicKey:"subjectPublicKey"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for PUBLIC_KEY_INFO");this.algorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.algorithm});this.subjectPublicKey=asn1.result.subjectPublicKey;switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":if("algorithmParams"in this.algorithm){if(this.algorithm.algorithmParams instanceof asn1js.ObjectIdentifier){try{this.parsedKey=new _ECPublicKey2.default({namedCurve:this.algorithm.algorithmParams.valueBlock.toString(),schema:this.subjectPublicKey.valueBlock.valueHex})}catch(ex){}}}break;case"1.2.840.113549.1.1.1":{var publicKeyASN1=asn1js.fromBER(this.subjectPublicKey.valueBlock.valueHex);if(publicKeyASN1.offset!==-1){try{this.parsedKey=new _RSAPublicKey2.default({schema:publicKeyASN1.result})}catch(ex){}}}break;default:}}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[this.algorithm.toSchema(),this.subjectPublicKey]})}},{key:"toJSON",value:function toJSON(){if("parsedKey"in this===false){return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()}}var jwk={};switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":jwk.kty="EC";break;case"1.2.840.113549.1.1.1":jwk.kty="RSA";break;default:}var publicKeyJWK=this.parsedKey.toJSON();var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=Object.keys(publicKeyJWK)[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var key=_step.value;jwk[key]=publicKeyJWK[key]}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return jwk}},{key:"fromJSON",value:function fromJSON(json){if("kty"in json){switch(json.kty.toUpperCase()){case"EC":this.parsedKey=new _ECPublicKey2.default({json:json});this.algorithm=new _AlgorithmIdentifier2.default({algorithmId:"1.2.840.10045.2.1",algorithmParams:new asn1js.ObjectIdentifier({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new _RSAPublicKey2.default({json:json});this.algorithm=new _AlgorithmIdentifier2.default({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new asn1js.Null});break;default:throw new Error('Invalid value for "kty" parameter: '+json.kty)}this.subjectPublicKey=new asn1js.BitString({valueHex:this.parsedKey.toSchema().toBER(false)})}}},{key:"importKey",value:function importKey(publicKey){var sequence=Promise.resolve();var _this=this;if(typeof publicKey==="undefined")return Promise.reject("Need to provide publicKey input parameter");var crypto=(0,_common.getCrypto)();if(typeof crypto==="undefined")return Promise.reject("Unable to create WebCrypto object");sequence=sequence.then(function(){return crypto.exportKey("spki",publicKey)});sequence=sequence.then(function(exportedKey){var asn1=asn1js.fromBER(exportedKey);try{_this.fromSchema(asn1.result)}catch(exception){return Promise.reject("Error during initializing object from schema")}return undefined},function(error){return Promise.reject("Error during exporting public key: "+error)});return sequence}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"algorithm":return new _AlgorithmIdentifier2.default;case"subjectPublicKey":return new asn1js.BitString;default:throw new Error("Invalid member name for PublicKeyInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_AlgorithmIdentifier2.default.schema(names.algorithm||{}),new asn1js.BitString({name:names.subjectPublicKey||""})]})}}]);return PublicKeyInfo}();exports.default=PublicKeyInfo},{"./AlgorithmIdentifier.js":3,"./ECPublicKey.js":29,"./RSAPublicKey.js":78,"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],76:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RSAESOAEPParams=function(){function RSAESOAEPParams(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,RSAESOAEPParams);this.hashAlgorithm=(0,_pvutils.getParametersValue)(parameters,"hashAlgorithm",RSAESOAEPParams.defaultValues("hashAlgorithm"));this.maskGenAlgorithm=(0,_pvutils.getParametersValue)(parameters,"maskGenAlgorithm",RSAESOAEPParams.defaultValues("maskGenAlgorithm"));this.pSourceAlgorithm=(0,_pvutils.getParametersValue)(parameters,"pSourceAlgorithm",RSAESOAEPParams.defaultValues("pSourceAlgorithm"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(RSAESOAEPParams,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,RSAESOAEPParams.schema({names:{hashAlgorithm:{names:{blockName:"hashAlgorithm"}},maskGenAlgorithm:{names:{blockName:"maskGenAlgorithm"}},pSourceAlgorithm:{names:{blockName:"pSourceAlgorithm"}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for RSAESOAEPParams");if("hashAlgorithm"in asn1.result)this.hashAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.hashAlgorithm});if("maskGenAlgorithm"in asn1.result)this.maskGenAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.maskGenAlgorithm});if("pSourceAlgorithm"in asn1.result)this.pSourceAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.pSourceAlgorithm})}},{key:"toSchema",value:function toSchema(){var outputArray=[];if(!this.hashAlgorithm.isEqual(RSAESOAEPParams.defaultValues("hashAlgorithm"))){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]}))}if(!this.maskGenAlgorithm.isEqual(RSAESOAEPParams.defaultValues("maskGenAlgorithm"))){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]}))}if(!this.pSourceAlgorithm.isEqual(RSAESOAEPParams.defaultValues("pSourceAlgorithm"))){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:2},value:[this.pSourceAlgorithm.toSchema()]}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={};if(!this.hashAlgorithm.isEqual(RSAESOAEPParams.defaultValues("hashAlgorithm")))object.hashAlgorithm=this.hashAlgorithm.toJSON();if(!this.maskGenAlgorithm.isEqual(RSAESOAEPParams.defaultValues("maskGenAlgorithm")))object.maskGenAlgorithm=this.maskGenAlgorithm.toJSON();if(!this.pSourceAlgorithm.isEqual(RSAESOAEPParams.defaultValues("pSourceAlgorithm")))object.pSourceAlgorithm=this.pSourceAlgorithm.toJSON();return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"hashAlgorithm":return new _AlgorithmIdentifier2.default({algorithmId:"1.3.14.3.2.26",algorithmParams:new asn1js.Null});case"maskGenAlgorithm":return new _AlgorithmIdentifier2.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new _AlgorithmIdentifier2.default({algorithmId:"1.3.14.3.2.26",algorithmParams:new asn1js.Null}).toSchema()});case"pSourceAlgorithm":return new _AlgorithmIdentifier2.default({algorithmId:"1.2.840.113549.1.1.9",algorithmParams:new asn1js.OctetString({valueHex:new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer})});default:throw new Error("Invalid member name for RSAESOAEPParams class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},optional:true,value:[_AlgorithmIdentifier2.default.schema(names.hashAlgorithm||{})]}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},optional:true,value:[_AlgorithmIdentifier2.default.schema(names.maskGenAlgorithm||{})]}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:2},optional:true,value:[_AlgorithmIdentifier2.default.schema(names.pSourceAlgorithm||{})]})]})}}]);return RSAESOAEPParams}();exports.default=RSAESOAEPParams},{"./AlgorithmIdentifier.js":3,asn1js:"asn1js",pvutils:"pvutils"}],77:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _OtherPrimeInfo=require("./OtherPrimeInfo.js");var _OtherPrimeInfo2=_interopRequireDefault(_OtherPrimeInfo);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RSAPrivateKey=function(){function RSAPrivateKey(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,RSAPrivateKey);this.version=(0,_pvutils.getParametersValue)(parameters,"version",RSAPrivateKey.defaultValues("version"));this.modulus=(0,_pvutils.getParametersValue)(parameters,"modulus",RSAPrivateKey.defaultValues("modulus"));this.publicExponent=(0,_pvutils.getParametersValue)(parameters,"publicExponent",RSAPrivateKey.defaultValues("publicExponent"));this.privateExponent=(0,_pvutils.getParametersValue)(parameters,"privateExponent",RSAPrivateKey.defaultValues("privateExponent"));this.prime1=(0,_pvutils.getParametersValue)(parameters,"prime1",RSAPrivateKey.defaultValues("prime1"));this.prime2=(0,_pvutils.getParametersValue)(parameters,"prime2",RSAPrivateKey.defaultValues("prime2"));this.exponent1=(0,_pvutils.getParametersValue)(parameters,"exponent1",RSAPrivateKey.defaultValues("exponent1"));this.exponent2=(0,_pvutils.getParametersValue)(parameters,"exponent2",RSAPrivateKey.defaultValues("exponent2"));this.coefficient=(0,_pvutils.getParametersValue)(parameters,"coefficient",RSAPrivateKey.defaultValues("coefficient"));if("otherPrimeInfos"in parameters)this.otherPrimeInfos=(0,_pvutils.getParametersValue)(parameters,"otherPrimeInfos",RSAPrivateKey.defaultValues("otherPrimeInfos"));if("schema"in parameters)this.fromSchema(parameters.schema);if("json"in parameters)this.fromJSON(parameters.json)}_createClass(RSAPrivateKey,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,RSAPrivateKey.schema({names:{version:"version",modulus:"modulus",publicExponent:"publicExponent",privateExponent:"privateExponent",prime1:"prime1",prime2:"prime2",exponent1:"exponent1",exponent2:"exponent2",coefficient:"coefficient",otherPrimeInfo:{names:{blockName:"otherPrimeInfos"}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for RSAPrivateKey");this.version=asn1.result.version.valueBlock.valueDec;this.modulus=asn1.result.modulus.convertFromDER(256);this.publicExponent=asn1.result.publicExponent;this.privateExponent=asn1.result.privateExponent.convertFromDER(256);this.prime1=asn1.result.prime1.convertFromDER(128);this.prime2=asn1.result.prime2.convertFromDER(128);this.exponent1=asn1.result.exponent1.convertFromDER(128);this.exponent2=asn1.result.exponent2.convertFromDER(128);this.coefficient=asn1.result.coefficient.convertFromDER(128);if("otherPrimeInfos"in asn1.result)this.otherPrimeInfos=Array.from(asn1.result.otherPrimeInfos,function(element){return new _OtherPrimeInfo2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(new asn1js.Integer({value:this.version}));outputArray.push(this.modulus.convertToDER());outputArray.push(this.publicExponent);outputArray.push(this.privateExponent.convertToDER());outputArray.push(this.prime1.convertToDER());outputArray.push(this.prime2.convertToDER());outputArray.push(this.exponent1.convertToDER());outputArray.push(this.exponent2.convertToDER());outputArray.push(this.coefficient.convertToDER());if("otherPrimeInfos"in this){outputArray.push(new asn1js.Sequence({value:Array.from(this.otherPrimeInfos,function(element){return element.toSchema()})}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var jwk={n:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.modulus.valueBlock.valueHex),true,true,true),e:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.publicExponent.valueBlock.valueHex),true,true,true),d:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.privateExponent.valueBlock.valueHex),true,true,true),p:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.prime1.valueBlock.valueHex),true,true,true),q:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.prime2.valueBlock.valueHex),true,true,true),dp:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.exponent1.valueBlock.valueHex),true,true,true),dq:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.exponent2.valueBlock.valueHex),true,true,true),qi:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.coefficient.valueBlock.valueHex),true,true,true)};if("otherPrimeInfos"in this)jwk.oth=Array.from(this.otherPrimeInfos,function(element){return element.toJSON()});return jwk}},{key:"fromJSON",value:function fromJSON(json){if("n"in json)this.modulus=new asn1js.Integer({valueHex:(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.n,true,true))});else throw new Error('Absent mandatory parameter "n"');if("e"in json)this.publicExponent=new asn1js.Integer({valueHex:(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.e,true,true))});else throw new Error('Absent mandatory parameter "e"');if("d"in json)this.privateExponent=new asn1js.Integer({valueHex:(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.d,true,true))});else throw new Error('Absent mandatory parameter "d"');if("p"in json)this.prime1=new asn1js.Integer({valueHex:(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.p,true,true))});else throw new Error('Absent mandatory parameter "p"');if("q"in json)this.prime2=new asn1js.Integer({valueHex:(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.q,true,true))});else throw new Error('Absent mandatory parameter "q"');if("dp"in json)this.exponent1=new asn1js.Integer({valueHex:(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.dp,true,true))});else throw new Error('Absent mandatory parameter "dp"');if("dq"in json)this.exponent2=new asn1js.Integer({valueHex:(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.dq,true,true))});else throw new Error('Absent mandatory parameter "dq"');if("qi"in json)this.coefficient=new asn1js.Integer({valueHex:(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.qi,true,true))});else throw new Error('Absent mandatory parameter "qi"');if("oth"in json)this.otherPrimeInfos=Array.from(json.oth,function(element){return new _OtherPrimeInfo2.default({json:element})})}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 0;case"modulus":return new asn1js.Integer;case"publicExponent":return new asn1js.Integer;case"privateExponent":return new asn1js.Integer;case"prime1":return new asn1js.Integer;case"prime2":return new asn1js.Integer;case"exponent1":return new asn1js.Integer;case"exponent2":return new asn1js.Integer;case"coefficient":return new asn1js.Integer;case"otherPrimeInfos":return[];default:throw new Error("Invalid member name for RSAPrivateKey class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.version||""}),new asn1js.Integer({name:names.modulus||""}),new asn1js.Integer({name:names.publicExponent||""}),new asn1js.Integer({name:names.privateExponent||""}),new asn1js.Integer({name:names.prime1||""}),new asn1js.Integer({name:names.prime2||""}),new asn1js.Integer({name:names.exponent1||""}),new asn1js.Integer({name:names.exponent2||""}),new asn1js.Integer({name:names.coefficient||""}),new asn1js.Sequence({optional:true,value:[new asn1js.Repeated({name:names.otherPrimeInfosName||"",value:_OtherPrimeInfo2.default.schema(names.otherPrimeInfo||{})})]})]})}}]);return RSAPrivateKey}();exports.default=RSAPrivateKey},{"./OtherPrimeInfo.js":59,asn1js:"asn1js",pvutils:"pvutils"}],78:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RSAPublicKey=function(){function RSAPublicKey(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,RSAPublicKey);this.modulus=(0,_pvutils.getParametersValue)(parameters,"modulus",RSAPublicKey.defaultValues("modulus"));this.publicExponent=(0,_pvutils.getParametersValue)(parameters,"publicExponent",RSAPublicKey.defaultValues("publicExponent"));if("schema"in parameters)this.fromSchema(parameters.schema);if("json"in parameters)this.fromJSON(parameters.json)}_createClass(RSAPublicKey,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,RSAPublicKey.schema({names:{modulus:"modulus",publicExponent:"publicExponent"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for RSAPublicKey");this.modulus=asn1.result.modulus.convertFromDER(256);this.publicExponent=asn1.result.publicExponent}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[this.modulus.convertToDER(),this.publicExponent]})}},{key:"toJSON",value:function toJSON(){return{n:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.modulus.valueBlock.valueHex),true,true,true),e:(0,_pvutils.toBase64)((0,_pvutils.arrayBufferToString)(this.publicExponent.valueBlock.valueHex),true,true,true)}}},{key:"fromJSON",value:function fromJSON(json){if("n"in json){var array=(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.n,true));this.modulus=new asn1js.Integer({valueHex:array.slice(0,Math.pow(2,(0,_pvutils.nearestPowerOf2)(array.byteLength)))})}else throw new Error('Absent mandatory parameter "n"');if("e"in json)this.publicExponent=new asn1js.Integer({valueHex:(0,_pvutils.stringToArrayBuffer)((0,_pvutils.fromBase64)(json.e,true)).slice(0,3)});else throw new Error('Absent mandatory parameter "e"')}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"modulus":return new asn1js.Integer;case"publicExponent":return new asn1js.Integer;default:throw new Error("Invalid member name for RSAPublicKey class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.modulus||""}),new asn1js.Integer({name:names.publicExponent||""})]})}}]);return RSAPublicKey}();exports.default=RSAPublicKey},{asn1js:"asn1js",pvutils:"pvutils"}],79:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RSASSAPSSParams=function(){function RSASSAPSSParams(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,RSASSAPSSParams);this.hashAlgorithm=(0,_pvutils.getParametersValue)(parameters,"hashAlgorithm",RSASSAPSSParams.defaultValues("hashAlgorithm"));this.maskGenAlgorithm=(0,_pvutils.getParametersValue)(parameters,"maskGenAlgorithm",RSASSAPSSParams.defaultValues("maskGenAlgorithm"));this.saltLength=(0,_pvutils.getParametersValue)(parameters,"saltLength",RSASSAPSSParams.defaultValues("saltLength"));this.trailerField=(0,_pvutils.getParametersValue)(parameters,"trailerField",RSASSAPSSParams.defaultValues("trailerField"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(RSASSAPSSParams,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,RSASSAPSSParams.schema({names:{hashAlgorithm:{names:{blockName:"hashAlgorithm"}},maskGenAlgorithm:{names:{blockName:"maskGenAlgorithm"}},saltLength:"saltLength",trailerField:"trailerField"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for RSASSA_PSS_params");if("hashAlgorithm"in asn1.result)this.hashAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.hashAlgorithm});if("maskGenAlgorithm"in asn1.result)this.maskGenAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.maskGenAlgorithm});if("saltLength"in asn1.result)this.saltLength=asn1.result.saltLength.valueBlock.valueDec;if("trailerField"in asn1.result)this.trailerField=asn1.result.trailerField.valueBlock.valueDec}},{key:"toSchema",value:function toSchema(){var outputArray=[];if(!this.hashAlgorithm.isEqual(RSASSAPSSParams.defaultValues("hashAlgorithm"))){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]}))}if(!this.maskGenAlgorithm.isEqual(RSASSAPSSParams.defaultValues("maskGenAlgorithm"))){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]}))}if(this.saltLength!==RSASSAPSSParams.defaultValues("saltLength")){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:2},value:[new asn1js.Integer({value:this.saltLength})]}))}if(this.trailerField!==RSASSAPSSParams.defaultValues("trailerField")){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:3},value:[new asn1js.Integer({value:this.trailerField})]}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={};if(!this.hashAlgorithm.isEqual(RSASSAPSSParams.defaultValues("hashAlgorithm")))object.hashAlgorithm=this.hashAlgorithm.toJSON();if(!this.maskGenAlgorithm.isEqual(RSASSAPSSParams.defaultValues("maskGenAlgorithm")))object.maskGenAlgorithm=this.maskGenAlgorithm.toJSON();if(this.saltLength!==RSASSAPSSParams.defaultValues("saltLength"))object.saltLength=this.saltLength;if(this.trailerField!==RSASSAPSSParams.defaultValues("trailerField"))object.trailerField=this.trailerField;return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"hashAlgorithm":return new _AlgorithmIdentifier2.default({algorithmId:"1.3.14.3.2.26",algorithmParams:new asn1js.Null});case"maskGenAlgorithm":return new _AlgorithmIdentifier2.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new _AlgorithmIdentifier2.default({algorithmId:"1.3.14.3.2.26",algorithmParams:new asn1js.Null}).toSchema()});case"saltLength":return 20;case"trailerField":return 1;default:throw new Error("Invalid member name for RSASSAPSSParams class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},optional:true,value:[_AlgorithmIdentifier2.default.schema(names.hashAlgorithm||{})]}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},optional:true,value:[_AlgorithmIdentifier2.default.schema(names.maskGenAlgorithm||{})]}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:2},optional:true,value:[new asn1js.Integer({name:names.saltLength||""})]}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:3},optional:true,value:[new asn1js.Integer({name:names.trailerField||""})]})]})}}]);return RSASSAPSSParams}();exports.default=RSASSAPSSParams},{"./AlgorithmIdentifier.js":3,asn1js:"asn1js",pvutils:"pvutils"}],80:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _KeyAgreeRecipientIdentifier=require("./KeyAgreeRecipientIdentifier.js");var _KeyAgreeRecipientIdentifier2=_interopRequireDefault(_KeyAgreeRecipientIdentifier);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RecipientEncryptedKey=function(){function RecipientEncryptedKey(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,RecipientEncryptedKey);this.rid=(0,_pvutils.getParametersValue)(parameters,"rid",RecipientEncryptedKey.defaultValues("rid"));this.encryptedKey=(0,_pvutils.getParametersValue)(parameters,"encryptedKey",RecipientEncryptedKey.defaultValues("encryptedKey"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(RecipientEncryptedKey,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,RecipientEncryptedKey.schema({names:{rid:{names:{blockName:"rid"}},encryptedKey:"encryptedKey"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for RecipientEncryptedKey");this.rid=new _KeyAgreeRecipientIdentifier2.default({schema:asn1.result.rid});this.encryptedKey=asn1.result.encryptedKey}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[this.rid.toSchema(),this.encryptedKey]})}},{key:"toJSON",value:function toJSON(){return{rid:this.rid.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"rid":return new _KeyAgreeRecipientIdentifier2.default;case"encryptedKey":return new asn1js.OctetString;default:throw new Error("Invalid member name for RecipientEncryptedKey class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"rid":return memberValue.variant===-1&&"value"in memberValue===false;case"encryptedKey":return memberValue.isEqual(RecipientEncryptedKey.defaultValues("encryptedKey"));default:throw new Error("Invalid member name for RecipientEncryptedKey class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_KeyAgreeRecipientIdentifier2.default.schema(names.rid||{}),new asn1js.OctetString({name:names.encryptedKey||""})]})}}]);return RecipientEncryptedKey}();exports.default=RecipientEncryptedKey},{"./KeyAgreeRecipientIdentifier.js":45,asn1js:"asn1js",pvutils:"pvutils"}],81:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _RecipientEncryptedKey=require("./RecipientEncryptedKey.js");var _RecipientEncryptedKey2=_interopRequireDefault(_RecipientEncryptedKey);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RecipientEncryptedKeys=function(){function RecipientEncryptedKeys(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,RecipientEncryptedKeys);this.encryptedKeys=(0,_pvutils.getParametersValue)(parameters,"encryptedKeys",RecipientEncryptedKeys.defaultValues("encryptedKeys"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(RecipientEncryptedKeys,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,RecipientEncryptedKeys.schema({names:{RecipientEncryptedKeys:"RecipientEncryptedKeys"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for RecipientEncryptedKeys");this.encryptedKeys=Array.from(asn1.result.RecipientEncryptedKeys,function(element){return new _RecipientEncryptedKey2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:Array.from(this.encryptedKeys,function(element){return element.toSchema()})})}},{key:"toJSON",value:function toJSON(){return{encryptedKeys:Array.from(this.encryptedKeys,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"encryptedKeys":return[];default:throw new Error("Invalid member name for RecipientEncryptedKeys class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"encryptedKeys":return memberValue.length===0;default:throw new Error("Invalid member name for RecipientEncryptedKeys class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Repeated({name:names.RecipientEncryptedKeys||"",value:_RecipientEncryptedKey2.default.schema()})]})}}]);return RecipientEncryptedKeys}();exports.default=RecipientEncryptedKeys},{"./RecipientEncryptedKey.js":80,asn1js:"asn1js",pvutils:"pvutils"}],82:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _IssuerAndSerialNumber=require("./IssuerAndSerialNumber.js");var _IssuerAndSerialNumber2=_interopRequireDefault(_IssuerAndSerialNumber);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RecipientIdentifier=function(){function RecipientIdentifier(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,RecipientIdentifier);this.variant=(0,_pvutils.getParametersValue)(parameters,"variant",RecipientIdentifier.defaultValues("variant"));if("value"in parameters)this.value=(0,_pvutils.getParametersValue)(parameters,"value",RecipientIdentifier.defaultValues("value"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(RecipientIdentifier,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,RecipientIdentifier.schema({names:{blockName:"blockName"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for RecipientIdentifier");if(asn1.result.blockName.idBlock.tagClass===1){this.variant=1;this.value=new _IssuerAndSerialNumber2.default({schema:asn1.result.blockName})}else{this.variant=2;this.value=asn1.result.blockName.valueBlock.value[0]}}},{key:"toSchema",value:function toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.value]});default:return new asn1js.Any}}},{key:"toJSON",value:function toJSON(){var _object={variant:this.variant};if(this.variant===1||this.variant===2)_object.value=this.value.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"variant":return-1;case"value":return{};default:throw new Error("Invalid member name for RecipientIdentifier class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"variant":return memberValue===-1;case"values":return Object.keys(memberValue).length===0;default:throw new Error("Invalid member name for RecipientIdentifier class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Choice({value:[_IssuerAndSerialNumber2.default.schema({names:{blockName:names.blockName||""}}),new asn1js.Constructed({name:names.blockName||"",idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.OctetString]})]})}}]);return RecipientIdentifier}();exports.default=RecipientIdentifier},{"./IssuerAndSerialNumber.js":41,asn1js:"asn1js",pvutils:"pvutils"}],83:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _KeyTransRecipientInfo=require("./KeyTransRecipientInfo.js");var _KeyTransRecipientInfo2=_interopRequireDefault(_KeyTransRecipientInfo);var _KeyAgreeRecipientInfo=require("./KeyAgreeRecipientInfo.js");var _KeyAgreeRecipientInfo2=_interopRequireDefault(_KeyAgreeRecipientInfo);var _KEKRecipientInfo=require("./KEKRecipientInfo.js");var _KEKRecipientInfo2=_interopRequireDefault(_KEKRecipientInfo);var _PasswordRecipientinfo=require("./PasswordRecipientinfo.js");var _PasswordRecipientinfo2=_interopRequireDefault(_PasswordRecipientinfo);var _OtherRecipientInfo=require("./OtherRecipientInfo.js");var _OtherRecipientInfo2=_interopRequireDefault(_OtherRecipientInfo);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RecipientInfo=function(){function RecipientInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,RecipientInfo);this.variant=(0,_pvutils.getParametersValue)(parameters,"variant",RecipientInfo.defaultValues("variant"));if("value"in parameters)this.value=(0,_pvutils.getParametersValue)(parameters,"value",RecipientInfo.defaultValues("value"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(RecipientInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,RecipientInfo.schema({names:{blockName:"blockName"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CMS_RECIPIENT_INFO");if(asn1.result.blockName.idBlock.tagClass===1){this.variant=1;this.value=new _KeyTransRecipientInfo2.default({schema:asn1.result.blockName})}else{var tagNumber=asn1.result.blockName.idBlock.tagNumber;asn1.result.blockName.idBlock.tagClass=1;asn1.result.blockName.idBlock.tagNumber=16;switch(tagNumber){case 1:this.variant=2;this.value=new _KeyAgreeRecipientInfo2.default({schema:asn1.result.blockName});break;case 2:this.variant=3;this.value=new _KEKRecipientInfo2.default({schema:asn1.result.blockName});break;case 3:this.variant=4;this.value=new _PasswordRecipientinfo2.default({schema:asn1.result.blockName});break;case 4:this.variant=5;this.value=new _OtherRecipientInfo2.default({schema:asn1.result.blockName});break;default:throw new Error("Incorrect structure of RecipientInfo block")}}}},{key:"toSchema",value:function toSchema(){var _schema=this.value.toSchema();switch(this.variant){case 1:return _schema;case 2:case 3:case 4:_schema.idBlock.tagClass=3;_schema.idBlock.tagNumber=this.variant-1;return _schema;default:return new asn1js.Any}}},{key:"toJSON",value:function toJSON(){var _object={variant:this.variant};if(this.variant>=1&&this.variant<=4)_object.value=this.value.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"variant":return-1;case"value":return{};default:throw new Error("Invalid member name for RecipientInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"variant":return memberValue===RecipientInfo.defaultValues(memberName);case"value":return Object.keys(memberValue).length===0;default:throw new Error("Invalid member name for RecipientInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Choice({value:[_KeyTransRecipientInfo2.default.schema({names:{blockName:names.blockName||""}}),new asn1js.Constructed({name:names.blockName||"",idBlock:{tagClass:3,tagNumber:1},value:_KeyAgreeRecipientInfo2.default.schema().valueBlock.value}),new asn1js.Constructed({name:names.blockName||"",idBlock:{tagClass:3,tagNumber:2},value:_KEKRecipientInfo2.default.schema().valueBlock.value}),new asn1js.Constructed({name:names.blockName||"",idBlock:{tagClass:3,tagNumber:3},value:_PasswordRecipientinfo2.default.schema().valueBlock.value}),new asn1js.Constructed({name:names.blockName||"",idBlock:{tagClass:3,tagNumber:4},value:_OtherRecipientInfo2.default.schema().valueBlock.value})]})}}]);return RecipientInfo}();exports.default=RecipientInfo},{"./KEKRecipientInfo.js":44,"./KeyAgreeRecipientInfo.js":46,"./KeyTransRecipientInfo.js":48,"./OtherRecipientInfo.js":60,"./PasswordRecipientinfo.js":67,asn1js:"asn1js",pvutils:"pvutils"}],84:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _OtherKeyAttribute=require("./OtherKeyAttribute.js");var _OtherKeyAttribute2=_interopRequireDefault(_OtherKeyAttribute);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RecipientKeyIdentifier=function(){function RecipientKeyIdentifier(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,RecipientKeyIdentifier);this.subjectKeyIdentifier=(0,_pvutils.getParametersValue)(parameters,"subjectKeyIdentifier",RecipientKeyIdentifier.defaultValues("subjectKeyIdentifier"));if("date"in parameters)this.date=(0,_pvutils.getParametersValue)(parameters,"date",RecipientKeyIdentifier.defaultValues("date"));if("other"in parameters)this.other=(0,_pvutils.getParametersValue)(parameters,"other",RecipientKeyIdentifier.defaultValues("other"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(RecipientKeyIdentifier,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,RecipientKeyIdentifier.schema({names:{subjectKeyIdentifier:"subjectKeyIdentifier",date:"date",other:{names:{blockName:"other"}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for RecipientKeyIdentifier");this.subjectKeyIdentifier=asn1.result.subjectKeyIdentifier;if("date"in asn1.result)this.date=asn1.result.date;if("other"in asn1.result)this.other=new _OtherKeyAttribute2.default({schema:asn1.result.other})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(this.subjectKeyIdentifier);if("date"in this)outputArray.push(this.date);if("other"in this)outputArray.push(this.other.toSchema());return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={subjectKeyIdentifier:this.subjectKeyIdentifier.toJSON()};if("date"in this)_object.date=this.date;if("other"in this)_object.other=this.other.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"subjectKeyIdentifier":return new asn1js.OctetString;case"date":return new asn1js.GeneralizedTime;case"other":return new _OtherKeyAttribute2.default;default:throw new Error("Invalid member name for RecipientKeyIdentifier class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"subjectKeyIdentifier":return memberValue.isEqual(RecipientKeyIdentifier.defaultValues("subjectKeyIdentifier"));case"date":return memberValue.year===0&&memberValue.month===0&&memberValue.day===0&&memberValue.hour===0&&memberValue.minute===0&&memberValue.second===0&&memberValue.millisecond===0;case"other":return memberValue.keyAttrId===""&&"keyAttr"in memberValue===false;default:throw new Error("Invalid member name for RecipientKeyIdentifier class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.OctetString({name:names.subjectKeyIdentifier||""}),new asn1js.GeneralizedTime({optional:true,name:names.date||""}),_OtherKeyAttribute2.default.schema(names.other||{})]})}}]);return RecipientKeyIdentifier}();exports.default=RecipientKeyIdentifier},{"./OtherKeyAttribute.js":58,asn1js:"asn1js",pvutils:"pvutils"}],85:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AttributeTypeAndValue=require("./AttributeTypeAndValue.js");var _AttributeTypeAndValue2=_interopRequireDefault(_AttributeTypeAndValue);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RelativeDistinguishedNames=function(){function RelativeDistinguishedNames(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,RelativeDistinguishedNames);this.typesAndValues=(0,_pvutils.getParametersValue)(parameters,"typesAndValues",RelativeDistinguishedNames.defaultValues("typesAndValues"));this.valueBeforeDecode=(0,_pvutils.getParametersValue)(parameters,"valueBeforeDecode",RelativeDistinguishedNames.defaultValues("valueBeforeDecode"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(RelativeDistinguishedNames,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,RelativeDistinguishedNames.schema({names:{blockName:"RDN",repeatedSet:"typesAndValues"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for RDN");if("typesAndValues"in asn1.result)this.typesAndValues=Array.from(asn1.result.typesAndValues,function(element){return new _AttributeTypeAndValue2.default({schema:element})});this.valueBeforeDecode=asn1.result.RDN.valueBeforeDecode}},{key:"toSchema",value:function toSchema(){if(this.valueBeforeDecode.byteLength===0){return new asn1js.Sequence({value:[new asn1js.Set({value:Array.from(this.typesAndValues,function(element){return element.toSchema()})})]})}var asn1=asn1js.fromBER(this.valueBeforeDecode);return asn1.result}},{key:"toJSON",value:function toJSON(){return{typesAndValues:Array.from(this.typesAndValues,function(element){return element.toJSON()})}}},{key:"isEqual",value:function isEqual(compareTo){if(compareTo instanceof RelativeDistinguishedNames){if(this.typesAndValues.length!==compareTo.typesAndValues.length)return false;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.typesAndValues.entries()[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _ref=_step.value;var _ref2=_slicedToArray(_ref,2);var index=_ref2[0];var typeAndValue=_ref2[1];if(typeAndValue.isEqual(compareTo.typesAndValues[index])===false)return false}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return true}if(compareTo instanceof ArrayBuffer)return(0,_pvutils.isEqualBuffer)(this.valueBeforeDecode,compareTo);return false}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"typesAndValues":return[];case"valueBeforeDecode":return new ArrayBuffer(0);default:throw new Error("Invalid member name for RelativeDistinguishedNames class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"typesAndValues":return memberValue.length===0;case"valueBeforeDecode":return memberValue.byteLength===0;default:throw new Error("Invalid member name for RelativeDistinguishedNames class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Repeated({name:names.repeatedSequence||"",value:new asn1js.Set({value:[new asn1js.Repeated({name:names.repeatedSet||"",value:_AttributeTypeAndValue2.default.schema(names.typeAndValue||{})})]})})]})}}]);return RelativeDistinguishedNames}();exports.default=RelativeDistinguishedNames},{"./AttributeTypeAndValue.js":8,asn1js:"asn1js",pvutils:"pvutils"}],86:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _CertID=require("./CertID.js");var _CertID2=_interopRequireDefault(_CertID);var _Extension=require("./Extension.js");var _Extension2=_interopRequireDefault(_Extension);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Request=function(){function Request(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Request);this.reqCert=(0,_pvutils.getParametersValue)(parameters,"reqCert",Request.defaultValues("reqCert"));if("singleRequestExtensions"in parameters)this.singleRequestExtensions=(0,_pvutils.getParametersValue)(parameters,"singleRequestExtensions",Request.defaultValues("singleRequestExtensions"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(Request,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,Request.schema({names:{reqCert:{names:{blockName:"reqCert"}},singleRequestExtensions:{names:{blockName:"singleRequestExtensions"}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for Request");this.reqCert=new _CertID2.default({schema:asn1.result.reqCert});if("singleRequestExtensions"in asn1.result)this.singleRequestExtensions=Array.from(asn1.result.singleRequestExtensions.valueBlock.value,function(element){return new _Extension2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(this.reqCert.toSchema());if("singleRequestExtensions"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Sequence({value:Array.from(this.singleRequestExtensions,function(element){return element.toSchema()})})]}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={reqCert:this.reqCert.toJSON()};if("singleRequestExtensions"in this)_object.singleRequestExtensions=Array.from(this.singleRequestExtensions,function(element){return element.toJSON()});return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"reqCert":return new _CertID2.default;case"singleRequestExtensions":return[];default:throw new Error("Invalid member name for Request class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"reqCert":return memberValue.isEqual(Request.defaultValues(memberName));case"singleRequestExtensions":return memberValue.length===0;default:throw new Error("Invalid member name for Request class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_CertID2.default.schema(names.reqCert||{}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[_Extension2.default.schema(names.extensions||{names:{blockName:names.singleRequestExtensions||""}})]})]})}}]);return Request}();exports.default=Request},{"./CertID.js":16,"./Extension.js":35,asn1js:"asn1js",pvutils:"pvutils"}],87:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ResponseBytes=function(){function ResponseBytes(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,ResponseBytes);this.responseType=(0,_pvutils.getParametersValue)(parameters,"responseType",ResponseBytes.defaultValues("responseType"));this.response=(0,_pvutils.getParametersValue)(parameters,"response",ResponseBytes.defaultValues("response"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(ResponseBytes,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,ResponseBytes.schema({names:{responseType:"responseType",response:"response"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for ResponseBytes");this.responseType=asn1.result.responseType.valueBlock.toString();this.response=asn1.result.response}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.ObjectIdentifier({value:this.responseType}),this.response]})}},{key:"toJSON",value:function toJSON(){return{responseType:this.responseType,response:this.response.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"responseType":return"";case"response":return new asn1js.OctetString;default:throw new Error("Invalid member name for ResponseBytes class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"responseType":return memberValue==="";case"response":return memberValue.isEqual(ResponseBytes.defaultValues(memberName));default:throw new Error("Invalid member name for ResponseBytes class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.responseType||""}),new asn1js.OctetString({name:names.response||""})]})}}]);return ResponseBytes}();exports.default=ResponseBytes},{asn1js:"asn1js",pvutils:"pvutils"}],88:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _RelativeDistinguishedNames=require("./RelativeDistinguishedNames.js");var _RelativeDistinguishedNames2=_interopRequireDefault(_RelativeDistinguishedNames);var _SingleResponse=require("./SingleResponse.js");var _SingleResponse2=_interopRequireDefault(_SingleResponse);var _Extension=require("./Extension.js");var _Extension2=_interopRequireDefault(_Extension);var _Extensions=require("./Extensions.js");var _Extensions2=_interopRequireDefault(_Extensions);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ResponseData=function(){function ResponseData(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,ResponseData);this.tbs=(0,_pvutils.getParametersValue)(parameters,"tbs",ResponseData.defaultValues("tbs"));this.responderID=(0,_pvutils.getParametersValue)(parameters,"responderID",ResponseData.defaultValues("responderID"));this.producedAt=(0,_pvutils.getParametersValue)(parameters,"producedAt",ResponseData.defaultValues("producedAt"));this.responses=(0,_pvutils.getParametersValue)(parameters,"responses",ResponseData.defaultValues("responses"));if("responseExtensions"in parameters)this.responseExtensions=(0,_pvutils.getParametersValue)(parameters,"responseExtensions",ResponseData.defaultValues("responseExtensions"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(ResponseData,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,ResponseData.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for ocsp.ResponseData");this.tbs=asn1.result.ResponseData.valueBeforeDecode;if("ResponseData.version"in asn1.result)this.version=asn1.result["ResponseData.version"].valueBlock.valueDec;if(asn1.result["ResponseData.responderID"].idBlock.tagNumber===1)this.responderID=new _RelativeDistinguishedNames2.default({schema:asn1.result["ResponseData.responderID"].valueBlock.value[0]});else this.responderID=asn1.result["ResponseData.responderID"].valueBlock.value[0];this.producedAt=asn1.result["ResponseData.producedAt"].toDate();this.responses=Array.from(asn1.result["ResponseData.responses"],function(element){return new _SingleResponse2.default({schema:element})});if("ResponseData.responseExtensions"in asn1.result)this.responseExtensions=Array.from(asn1.result["ResponseData.responseExtensions"].valueBlock.value,function(element){return new _Extension2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var encodeFlag=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var tbsSchema=void 0;if(encodeFlag===false){if(this.tbs.length===0)return ResponseData.schema();tbsSchema=asn1js.fromBER(this.tbs).result}else{var outputArray=[];if("version"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Integer({value:this.version})]}))}if(this.responderID instanceof _RelativeDistinguishedNames2.default){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[this.responderID.toSchema()]}))}else{outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:2},value:[this.responderID]}))}outputArray.push(new asn1js.GeneralizedTime({valueDate:this.producedAt}));outputArray.push(new asn1js.Sequence({value:Array.from(this.responses,function(element){return element.toSchema()})}));if("responseExtensions"in this){outputArray.push(new asn1js.Sequence({value:Array.from(this.responseExtensions,function(element){return element.toSchema()})}))}tbsSchema=new asn1js.Sequence({value:outputArray})}return tbsSchema}},{key:"toJSON",value:function toJSON(){var _object={};if("version"in this)_object.version=this.version;if("responderID"in this)_object.responderID=this.responderID;if("producedAt"in this)_object.producedAt=this.producedAt;if("responses"in this)_object.responses=Array.from(this.responses,function(element){return element.toJSON()});if("responseExtensions"in this)_object.responseExtensions=Array.from(this.responseExtensions,function(element){return element.toJSON()});return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"tbs":return new ArrayBuffer(0);case"responderID":return{};case"producedAt":return new Date(0,0,0);case"responses":case"responseExtensions":return[];default:throw new Error("Invalid member name for ResponseData class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"tbs":return memberValue.byteLength===0;case"responderID":return Object.keys(memberValue).length===0;case"producedAt":return memberValue===ResponseData.defaultValues(memberName);case"responses":case"responseExtensions":return memberValue.length===0;default:throw new Error("Invalid member name for ResponseData class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"ResponseData",value:[new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Integer({name:names.version||"ResponseData.version"})]}),new asn1js.Choice({value:[new asn1js.Constructed({name:names.responderID||"ResponseData.responderID",idBlock:{tagClass:3,tagNumber:1},value:[_RelativeDistinguishedNames2.default.schema(names.ResponseDataByName||{names:{blockName:"ResponseData.byName"}})]}),new asn1js.Constructed({name:names.responderID||"ResponseData.responderID",idBlock:{tagClass:3,tagNumber:2},value:[new asn1js.OctetString({name:names.ResponseDataByKey||"ResponseData.byKey"})]})]}),new asn1js.GeneralizedTime({name:names.producedAt||"ResponseData.producedAt"}),new asn1js.Sequence({value:[new asn1js.Repeated({name:"ResponseData.responses",value:_SingleResponse2.default.schema(names.response||{})})]}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[_Extensions2.default.schema(names.extensions||{names:{blockName:"ResponseData.responseExtensions"}})]})]})}}]);return ResponseData}();exports.default=ResponseData},{"./Extension.js":35,"./Extensions.js":36,"./RelativeDistinguishedNames.js":85,"./SingleResponse.js":98,asn1js:"asn1js",pvutils:"pvutils"}],89:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _CertificateRevocationList=require("./CertificateRevocationList.js");var _CertificateRevocationList2=_interopRequireDefault(_CertificateRevocationList);var _OtherRevocationInfoFormat=require("./OtherRevocationInfoFormat.js");var _OtherRevocationInfoFormat2=_interopRequireDefault(_OtherRevocationInfoFormat);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RevocationInfoChoices=function(){function RevocationInfoChoices(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,RevocationInfoChoices);this.crls=(0,_pvutils.getParametersValue)(parameters,"crls",RevocationInfoChoices.defaultValues("crls"));this.otherRevocationInfos=(0,_pvutils.getParametersValue)(parameters,"otherRevocationInfos",RevocationInfoChoices.defaultValues("otherRevocationInfos"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(RevocationInfoChoices,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,RevocationInfoChoices.schema({names:{crls:"crls"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CSM_REVOCATION_INFO_CHOICES");var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=asn1.result.crls[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var element=_step.value;if(element.idBlock.tagClass===1)this.crls.push(new _CertificateRevocationList2.default({schema:element}));else this.otherRevocationInfos.push(new _OtherRevocationInfoFormat2.default({schema:element}))}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push.apply(outputArray,_toConsumableArray(Array.from(this.crls,function(element){return element.toSchema()})));outputArray.push.apply(outputArray,_toConsumableArray(Array.from(this.otherRevocationInfos,function(element){var schema=element.toSchema();schema.idBlock.tagClass=3;schema.idBlock.tagNumber=1;return schema})));return new asn1js.Set({value:outputArray})}},{key:"toJSON",value:function toJSON(){return{crls:Array.from(this.crls,function(element){return element.toJSON()}),otherRevocationInfos:Array.from(this.otherRevocationInfos,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"crls":return[];case"otherRevocationInfos":return[];default:throw new Error("Invalid member name for RevocationInfoChoices class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Set({name:names.blockName||"",value:[new asn1js.Repeated({name:names.crls||"",value:new asn1js.Choice({value:[_CertificateRevocationList2.default.schema(),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.ObjectIdentifier,new asn1js.Any]})]})})]})}}]);return RevocationInfoChoices}();exports.default=RevocationInfoChoices},{"./CertificateRevocationList.js":20,"./OtherRevocationInfoFormat.js":61,asn1js:"asn1js",pvutils:"pvutils"}],90:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _Time=require("./Time.js");var _Time2=_interopRequireDefault(_Time);var _Extensions=require("./Extensions.js");var _Extensions2=_interopRequireDefault(_Extensions);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RevokedCertificate=function(){function RevokedCertificate(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,RevokedCertificate);this.userCertificate=(0,_pvutils.getParametersValue)(parameters,"userCertificate",RevokedCertificate.defaultValues("userCertificate"));this.revocationDate=(0,_pvutils.getParametersValue)(parameters,"revocationDate",RevokedCertificate.defaultValues("revocationDate"));if("crlEntryExtensions"in parameters)this.crlEntryExtensions=(0,_pvutils.getParametersValue)(parameters,"crlEntryExtensions",RevokedCertificate.defaultValues("crlEntryExtensions"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(RevokedCertificate,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,RevokedCertificate.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for REV_CERT");this.userCertificate=asn1.result.userCertificate;this.revocationDate=new _Time2.default({schema:asn1.result.revocationDate});if("crlEntryExtensions"in asn1.result)this.crlEntryExtensions=new _Extensions2.default({schema:asn1.result.crlEntryExtensions})}},{key:"toSchema",value:function toSchema(){var outputArray=[this.userCertificate,this.revocationDate.toSchema()];if("crlEntryExtensions"in this)outputArray.push(this.crlEntryExtensions.toSchema());return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var object={userCertificate:this.userCertificate.toJSON(),revocationDate:this.revocationDate.toJSON};if("crlEntryExtensions"in this)object.crlEntryExtensions=this.crlEntryExtensions.toJSON();return object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"userCertificate":return new asn1js.Integer;case"revocationDate":return new _Time2.default;case"crlEntryExtensions":return new _Extensions2.default;default:throw new Error("Invalid member name for RevokedCertificate class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Integer({name:names.userCertificate||"userCertificate"}),_Time2.default.schema({names:{utcTimeName:names.revocationDate||"revocationDate",generalTimeName:names.revocationDate||"revocationDate"}}),_Extensions2.default.schema({names:{blockName:names.crlEntryExtensions||"crlEntryExtensions"}},true)]})}}]);return RevokedCertificate}();exports.default=RevokedCertificate},{"./Extensions.js":36,"./Time.js":102,asn1js:"asn1js",pvutils:"pvutils"}],91:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _Attribute=require("./Attribute.js");var _Attribute2=_interopRequireDefault(_Attribute);var _PrivateKeyInfo=require("./PrivateKeyInfo.js");var _PrivateKeyInfo2=_interopRequireDefault(_PrivateKeyInfo);var _PKCS8ShroudedKeyBag=require("./PKCS8ShroudedKeyBag.js");var _PKCS8ShroudedKeyBag2=_interopRequireDefault(_PKCS8ShroudedKeyBag);var _CertBag=require("./CertBag.js");var _CertBag2=_interopRequireDefault(_CertBag);var _CRLBag=require("./CRLBag.js");var _CRLBag2=_interopRequireDefault(_CRLBag);var _SecretBag=require("./SecretBag.js");var _SecretBag2=_interopRequireDefault(_SecretBag);var _SafeContents=require("./SafeContents.js");var _SafeContents2=_interopRequireDefault(_SafeContents);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var SafeBag=function(){function SafeBag(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,SafeBag);this.bagId=(0,_pvutils.getParametersValue)(parameters,"bagId",SafeBag.defaultValues("bagId"));this.bagValue=(0,_pvutils.getParametersValue)(parameters,"bagValue",SafeBag.defaultValues("bagValue"));if("bagAttributes"in parameters)this.bagAttributes=(0,_pvutils.getParametersValue)(parameters,"bagAttributes",SafeBag.defaultValues("bagAttributes"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(SafeBag,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,SafeBag.schema({names:{bagId:"bagId",bagValue:"bagValue",bagAttributes:"bagAttributes"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for SafeBag");this.bagId=asn1.result.bagId.valueBlock.toString();switch(this.bagId){case"1.2.840.113549.1.12.10.1.1":this.bagValue=new _PrivateKeyInfo2.default({schema:asn1.result.bagValue});break;case"1.2.840.113549.1.12.10.1.2":this.bagValue=new _PKCS8ShroudedKeyBag2.default({schema:asn1.result.bagValue});break;case"1.2.840.113549.1.12.10.1.3":this.bagValue=new _CertBag2.default({schema:asn1.result.bagValue});break;case"1.2.840.113549.1.12.10.1.4":this.bagValue=new _CRLBag2.default({schema:asn1.result.bagValue});break;case"1.2.840.113549.1.12.10.1.5":this.bagValue=new _SecretBag2.default({schema:asn1.result.bagValue});break;case"1.2.840.113549.1.12.10.1.6":this.bagValue=new _SafeContents2.default({schema:asn1.result.bagValue});break;default:throw new Error('Invalid "bagId" for SafeBag: '+this.bagId)}if("bagAttributes"in asn1.result)this.bagAttributes=Array.from(asn1.result.bagAttributes,function(element){return new _Attribute2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var outputArray=[new asn1js.ObjectIdentifier({value:this.bagId}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.bagValue.toSchema()]})];if("bagAttributes"in this){outputArray.push(new asn1js.Set({value:Array.from(this.bagAttributes,function(element){return element.toSchema()})}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var output={bagId:this.bagId,bagValue:this.bagValue.toJSON()};if("bagAttributes"in this)output.bagAttributes=Array.from(this.bagAttributes,function(element){return element.toJSON()});return output}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"bagId":return"";case"bagValue":return new asn1js.Any;case"bagAttributes":return[];default:throw new Error("Invalid member name for SafeBag class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"bagId":return memberValue==="";case"bagValue":return memberValue instanceof asn1js.Any;case"bagAttributes":return memberValue.length===0;default:throw new Error("Invalid member name for SafeBag class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.bagId||"bagId"}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Any({name:names.bagValue||"bagValue"})]}),new asn1js.Set({optional:true,value:[new asn1js.Repeated({name:names.bagAttributes||"bagAttributes",value:_Attribute2.default.schema()})]})]})}}]);return SafeBag}();exports.default=SafeBag},{"./Attribute.js":5,"./CRLBag.js":13,"./CertBag.js":15,"./PKCS8ShroudedKeyBag.js":65,"./PrivateKeyInfo.js":73,"./SafeContents.js":92,"./SecretBag.js":93,asn1js:"asn1js",pvutils:"pvutils"}],92:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _SafeBag=require("./SafeBag.js");var _SafeBag2=_interopRequireDefault(_SafeBag);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var SafeContents=function(){function SafeContents(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,SafeContents);this.safeBags=(0,_pvutils.getParametersValue)(parameters,"safeBags",SafeContents.defaultValues("safeBags"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(SafeContents,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,SafeContents.schema({names:{safeBags:"safeBags"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for SafeContents");this.safeBags=Array.from(asn1.result.safeBags,function(element){return new _SafeBag2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:Array.from(this.safeBags,function(element){return element.toSchema()})})}},{key:"toJSON",value:function toJSON(){return{safeBags:Array.from(this.safeBags,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"safeBags":return[];default:throw new Error("Invalid member name for SafeContents class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"safeBags":return memberValue.length===0;default:throw new Error("Invalid member name for SafeContents class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Repeated({name:names.safeBags||"",value:_SafeBag2.default.schema()})]})}}]);return SafeContents}();exports.default=SafeContents},{"./SafeBag.js":91,asn1js:"asn1js",pvutils:"pvutils"}],93:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var SecretBag=function(){function SecretBag(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,SecretBag);this.secretTypeId=(0,_pvutils.getParametersValue)(parameters,"secretTypeId",SecretBag.defaultValues("secretTypeId"));this.secretValue=(0,_pvutils.getParametersValue)(parameters,"secretValue",SecretBag.defaultValues("secretValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(SecretBag,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,SecretBag.schema({names:{id:"secretTypeId",value:"secretValue"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for SecretBag");this.secretTypeId=asn1.result.secretTypeId.valueBlock.toString();this.secretValue=asn1.result.secretValue}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:[new asn1js.ObjectIdentifier({value:this.secretTypeId}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.secretValue.toSchema()]})]})}},{key:"toJSON",value:function toJSON(){return{secretTypeId:this.secretTypeId,secretValue:this.secretValue.toJSON()}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"secretTypeId":return"";case"secretValue":return new asn1js.Any;default:throw new Error("Invalid member name for SecretBag class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"secretTypeId":return memberValue==="";case"secretValue":return memberValue instanceof asn1js.Any;default:throw new Error("Invalid member name for SecretBag class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.ObjectIdentifier({name:names.id||"id"}),new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Any({name:names.value||"value"})]})]})}}]);return SecretBag}();exports.default=SecretBag},{asn1js:"asn1js",pvutils:"pvutils"}],94:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _Certificate=require("./Certificate.js");var _Certificate2=_interopRequireDefault(_Certificate);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Signature=function(){function Signature(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Signature);this.signatureAlgorithm=(0,_pvutils.getParametersValue)(parameters,"signatureAlgorithm",Signature.defaultValues("signatureAlgorithm"));this.signature=(0,_pvutils.getParametersValue)(parameters,"signature",Signature.defaultValues("signature"));if("certs"in parameters)this.certs=(0,_pvutils.getParametersValue)(parameters,"certs",Signature.defaultValues("certs"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(Signature,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,Signature.schema({names:{signatureAlgorithm:{names:{blockName:"signatureAlgorithm"}},signature:"signature",certs:"certs"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for ocsp.Signature");this.signatureAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result.signatureAlgorithm});this.signature=asn1.result.signature;if("certs"in asn1.result)this.certs=Array.from(asn1.result.certs,function(element){return new _Certificate2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(this.signatureAlgorithm.toSchema());outputArray.push(this.signature);if("certs"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Sequence({value:Array.from(this.certs,function(element){return element.toSchema()})})]}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};if("certs"in this)_object.certs=Array.from(this.certs,function(element){return element.toJSON()});return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"signatureAlgorithm":return new _AlgorithmIdentifier2.default;case"signature":return new asn1js.BitString;case"certs":return[];default:throw new Error("Invalid member name for Signature class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"signatureAlgorithm":return memberValue.algorithmId===""&&"algorithmParams"in memberValue===false;case"signature":return memberValue.isEqual(Signature.defaultValues(memberName));case"certs":return memberValue.length===0;default:throw new Error("Invalid member name for Signature class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_AlgorithmIdentifier2.default.schema(names.signatureAlgorithm||{}),new asn1js.BitString({name:names.signature||""}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Sequence({value:[new asn1js.Repeated({name:names.certs||"",value:_Certificate2.default.schema(names.certs||{})})]})]})]})}}]);return Signature}();exports.default=Signature},{"./AlgorithmIdentifier.js":3,"./Certificate.js":17,asn1js:"asn1js",pvutils:"pvutils"}],95:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _Attribute=require("./Attribute.js");var _Attribute2=_interopRequireDefault(_Attribute);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var SignedAndUnsignedAttributes=function(){function SignedAndUnsignedAttributes(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,SignedAndUnsignedAttributes);this.type=(0,_pvutils.getParametersValue)(parameters,"type",SignedAndUnsignedAttributes.defaultValues("type"));this.attributes=(0,_pvutils.getParametersValue)(parameters,"attributes",SignedAndUnsignedAttributes.defaultValues("attributes"));this.encodedValue=(0,_pvutils.getParametersValue)(parameters,"encodedValue",SignedAndUnsignedAttributes.defaultValues("encodedValue"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(SignedAndUnsignedAttributes,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,SignedAndUnsignedAttributes.schema({names:{tagNumber:this.type,attributes:"attributes"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for SignedUnsignedAttributes");this.type=asn1.result.idBlock.tagNumber;this.encodedValue=asn1.result.valueBeforeDecode;var encodedView=new Uint8Array(this.encodedValue);encodedView[0]=49;if("attributes"in asn1.result===false){if(this.type===0)throw new Error("Wrong structure of SignedUnsignedAttributes");else return}this.attributes=Array.from(asn1.result.attributes,function(element){return new _Attribute2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){if(SignedAndUnsignedAttributes.compareWithDefault("type",this.type)||SignedAndUnsignedAttributes.compareWithDefault("attributes",this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:this.type},value:Array.from(this.attributes,function(element){return element.toSchema()})})}},{key:"toJSON",value:function toJSON(){if(SignedAndUnsignedAttributes.compareWithDefault("type",this.type)||SignedAndUnsignedAttributes.compareWithDefault("attributes",this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return{type:this.type,attributes:Array.from(this.attributes,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"type":return-1;case"attributes":return[];case"encodedValue":return new ArrayBuffer(0);default:throw new Error("Invalid member name for SignedAndUnsignedAttributes class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"type":return memberValue===SignedAndUnsignedAttributes.defaultValues("type");case"attributes":return memberValue.length===0;case"encodedValue":return memberValue.byteLength===0;default:throw new Error("Invalid member name for SignedAndUnsignedAttributes class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Constructed({name:names.blockName||"",optional:true,idBlock:{tagClass:3,tagNumber:names.tagNumber},value:[new asn1js.Repeated({name:names.attributes||"",value:_Attribute2.default.schema()})]})}}]);return SignedAndUnsignedAttributes}();exports.default=SignedAndUnsignedAttributes},{"./Attribute.js":5,asn1js:"asn1js",pvutils:"pvutils"}],96:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _EncapsulatedContentInfo=require("./EncapsulatedContentInfo.js");var _EncapsulatedContentInfo2=_interopRequireDefault(_EncapsulatedContentInfo);var _Certificate=require("./Certificate.js");var _Certificate2=_interopRequireDefault(_Certificate);var _CertificateRevocationList=require("./CertificateRevocationList.js");var _CertificateRevocationList2=_interopRequireDefault(_CertificateRevocationList);var _OtherRevocationInfoFormat=require("./OtherRevocationInfoFormat.js");var _OtherRevocationInfoFormat2=_interopRequireDefault(_OtherRevocationInfoFormat);var _SignerInfo=require("./SignerInfo.js");var _SignerInfo2=_interopRequireDefault(_SignerInfo);var _CertificateSet=require("./CertificateSet.js");var _CertificateSet2=_interopRequireDefault(_CertificateSet);var _RevocationInfoChoices=require("./RevocationInfoChoices.js");var _RevocationInfoChoices2=_interopRequireDefault(_RevocationInfoChoices);var _IssuerAndSerialNumber=require("./IssuerAndSerialNumber.js");var _IssuerAndSerialNumber2=_interopRequireDefault(_IssuerAndSerialNumber);var _TSTInfo=require("./TSTInfo.js");var _TSTInfo2=_interopRequireDefault(_TSTInfo);var _CertificateChainValidationEngine=require("./CertificateChainValidationEngine.js");var _CertificateChainValidationEngine2=_interopRequireDefault(_CertificateChainValidationEngine);var _BasicOCSPResponse=require("./BasicOCSPResponse.js");var _BasicOCSPResponse2=_interopRequireDefault(_BasicOCSPResponse);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var SignedData=function(){function SignedData(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,SignedData);this.version=(0,_pvutils.getParametersValue)(parameters,"version",SignedData.defaultValues("version"));this.digestAlgorithms=(0,_pvutils.getParametersValue)(parameters,"digestAlgorithms",SignedData.defaultValues("digestAlgorithms"));this.encapContentInfo=(0,_pvutils.getParametersValue)(parameters,"encapContentInfo",SignedData.defaultValues("encapContentInfo"));if("certificates"in parameters)this.certificates=(0,_pvutils.getParametersValue)(parameters,"certificates",SignedData.defaultValues("certificates"));if("crls"in parameters)this.crls=(0,_pvutils.getParametersValue)(parameters,"crls",SignedData.defaultValues("crls"));if("ocsps"in parameters)this.ocsps=(0,_pvutils.getParametersValue)(parameters,"ocsps",SignedData.defaultValues("ocsps"));this.signerInfos=(0,_pvutils.getParametersValue)(parameters,"signerInfos",SignedData.defaultValues("signerInfos"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(SignedData,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,SignedData.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for SignedData");this.version=asn1.result["SignedData.version"].valueBlock.valueDec;if("SignedData.digestAlgorithms"in asn1.result)this.digestAlgorithms=Array.from(asn1.result["SignedData.digestAlgorithms"],function(algorithm){return new _AlgorithmIdentifier2.default({schema:algorithm})});this.encapContentInfo=new _EncapsulatedContentInfo2.default({schema:asn1.result["SignedData.encapContentInfo"]});if("SignedData.certificates"in asn1.result){asn1.result["SignedData.certificates"].idBlock.tagClass=1;asn1.result["SignedData.certificates"].idBlock.tagNumber=17;var certificateSet=new _CertificateSet2.default({schema:asn1.result["SignedData.certificates"]});this.certificates=certificateSet.certificates.slice(0)}if("SignedData.crls"in asn1.result){this.crls=Array.from(asn1.result["SignedData.crls"],function(crl){if(crl.idBlock.tagClass===1)return new _CertificateRevocationList2.default({schema:crl});crl.idBlock.tagClass=1;crl.idBlock.tagNumber=16;return new _OtherRevocationInfoFormat2.default({schema:crl})})}if("SignedData.signerInfos"in asn1.result)this.signerInfos=Array.from(asn1.result["SignedData.signerInfos"],function(signerInfoSchema){return new _SignerInfo2.default({schema:signerInfoSchema})})}},{key:"toSchema",value:function toSchema(){var encodeFlag=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var outputArray=[];outputArray.push(new asn1js.Integer({value:this.version}));outputArray.push(new asn1js.Set({value:Array.from(this.digestAlgorithms,function(algorithm){return algorithm.toSchema(encodeFlag)})}));outputArray.push(this.encapContentInfo.toSchema());if("certificates"in this){var certificateSet=new _CertificateSet2.default({certificates:this.certificates});var certificateSetSchema=certificateSet.toSchema();certificateSetSchema.idBlock.tagClass=3;certificateSetSchema.idBlock.tagNumber=0;outputArray.push(certificateSetSchema)}if("crls"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.crls,function(crl){if(crl instanceof _OtherRevocationInfoFormat2.default){var crlSchema=crl.toSchema(encodeFlag);crlSchema.idBlock.tagClass=3;crlSchema.idBlock.tagNumber=1;return crlSchema}return crl.toSchema(encodeFlag)})}))}outputArray.push(new asn1js.Set({value:Array.from(this.signerInfos,function(signerInfo){return signerInfo.toSchema(encodeFlag)})}));return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={version:this.version,digestAlgorithms:Array.from(this.digestAlgorithms,function(algorithm){return algorithm.toJSON()}),encapContentInfo:this.encapContentInfo.toJSON()};if("certificates"in this)_object.certificates=Array.from(this.certificates,function(certificate){return certificate.toJSON()});if("crls"in this)_object.crls=Array.from(this.crls,function(crl){return crl.toJSON()});_object.signerInfos=Array.from(this.signerInfos,function(signerInfo){return signerInfo.toJSON()});return _object}},{key:"verify",value:function verify(){var _this=this;var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$signer=_ref.signer,signer=_ref$signer===undefined?-1:_ref$signer,_ref$data=_ref.data,data=_ref$data===undefined?new ArrayBuffer(0):_ref$data,_ref$trustedCerts=_ref.trustedCerts,trustedCerts=_ref$trustedCerts===undefined?[]:_ref$trustedCerts,_ref$checkDate=_ref.checkDate,checkDate=_ref$checkDate===undefined?new Date:_ref$checkDate,_ref$checkChain=_ref.checkChain,checkChain=_ref$checkChain===undefined?false:_ref$checkChain,_ref$extendedMode=_ref.extendedMode,extendedMode=_ref$extendedMode===undefined?false:_ref$extendedMode,_ref$findOrigin=_ref.findOrigin,findOrigin=_ref$findOrigin===undefined?null:_ref$findOrigin,_ref$findIssuer=_ref.findIssuer,findIssuer=_ref$findIssuer===undefined?null:_ref$findIssuer;var sequence=Promise.resolve();var messageDigestValue=new ArrayBuffer(0);var shaAlgorithm="";var signerCertificate={};var timestampSerial=null;var certificatePath=[];var engine=(0,_common.getEngine)();var crypto=(0,_common.getCrypto)();if(typeof crypto==="undefined")return Promise.reject("Unable to create WebCrypto object");if(signer===-1){if(extendedMode){return Promise.reject({date:checkDate,code:1,message:"Unable to get signer index from input parameters",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null})}return Promise.reject("Unable to get signer index from input parameters")}if("certificates"in this===false){if(extendedMode){return Promise.reject({date:checkDate,code:2,message:"No certificates attached to this signed data",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null})}return Promise.reject("No certificates attached to this signed data")}if(this.signerInfos[signer].sid instanceof _IssuerAndSerialNumber2.default){sequence=sequence.then(function(){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=_this.certificates[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var certificate=_step.value;if(certificate instanceof _Certificate2.default===false)continue;if(certificate.issuer.isEqual(_this.signerInfos[signer].sid.issuer)&&certificate.serialNumber.isEqual(_this.signerInfos[signer].sid.serialNumber)){signerCertificate=certificate;return Promise.resolve()}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}if(extendedMode){return Promise.reject({date:checkDate,code:3,message:"Unable to find signer certificate",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null})}return Promise.reject("Unable to find signer certificate")})}else{sequence=sequence.then(function(){return Promise.all(Array.from(_this.certificates.filter(function(certificate){return certificate instanceof _Certificate2.default}),function(certificate){return crypto.digest({name:"sha-1"},new Uint8Array(certificate.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex))})).then(function(results){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=_this.certificates.entries()[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var _ref2=_step2.value;var _ref3=_slicedToArray(_ref2,2);var index=_ref3[0];var certificate=_ref3[1];if(certificate instanceof _Certificate2.default===false)continue;if((0,_pvutils.isEqualBuffer)(results[index],_this.signerInfos[signer].sid.valueBlock.valueHex)){signerCertificate=certificate;return Promise.resolve()}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}if(extendedMode){return Promise.reject({date:checkDate,code:3,message:"Unable to find signer certificate",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null})}return Promise.reject("Unable to find signer certificate")},function(){if(extendedMode){return Promise.reject({date:checkDate,code:3,message:"Unable to find signer certificate",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null})}return Promise.reject("Unable to find signer certificate")})})}sequence=sequence.then(function(){if(_this.encapContentInfo.eContentType==="1.2.840.113549.1.9.16.1.4"){if("eContent"in _this.encapContentInfo===false)return false;var asn1=asn1js.fromBER(_this.encapContentInfo.eContent.valueBlock.valueHex);var tstInfo=void 0;try{tstInfo=new _TSTInfo2.default({schema:asn1.result})}catch(ex){return false}checkDate=tstInfo.genTime;timestampSerial=tstInfo.serialNumber.valueBlock.valueHex;if(data.byteLength===0){if(extendedMode){return Promise.reject({date:checkDate,code:4,message:"Missed detached data input array",signatureVerified:null,signerCertificate:signerCertificate,signerCertificateVerified:null})}return Promise.reject("Missed detached data input array")}return tstInfo.verify({data:data})}return true});function checkCA(cert){if(cert.issuer.isEqual(signerCertificate.issuer)===true&&cert.serialNumber.isEqual(signerCertificate.serialNumber)===true)return null;var isCA=false;if("extensions"in cert){var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=cert.extensions[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var extension=_step3.value;if(extension.extnID==="2.5.29.19"){if("cA"in extension.parsedValue){if(extension.parsedValue.cA===true)isCA=true}}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}}if(isCA)return cert;return null}if(checkChain){sequence=sequence.then(function(result){var _certificateChainEngi;if(result===false)return false;var promiseResults=Array.from(_this.certificates.filter(function(certificate){return certificate instanceof _Certificate2.default}),function(certificate){return checkCA(certificate)});var certificateChainValidationEngineParameters={checkDate:checkDate,certs:Array.from(promiseResults.filter(function(_result){return _result!==null})),trustedCerts:trustedCerts};if(findIssuer!==null)certificateChainValidationEngineParameters.findIssuer=findIssuer;if(findOrigin!==null)certificateChainValidationEngineParameters.findOrigin=findOrigin;var certificateChainEngine=new _CertificateChainValidationEngine2.default(certificateChainValidationEngineParameters);certificateChainEngine.certs.push(signerCertificate);if("crls"in _this){var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=_this.crls[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var crl=_step4.value;if(crl instanceof _CertificateRevocationList2.default)certificateChainEngine.crls.push(crl);else{if(crl.otherRevInfoFormat==="1.3.6.1.5.5.7.48.1.1")certificateChainEngine.ocsps.push(new _BasicOCSPResponse2.default({schema:crl.otherRevInfo}))}}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally{try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally{if(_didIteratorError4){throw _iteratorError4}}}}if("ocsps"in _this)(_certificateChainEngi=certificateChainEngine.ocsps).push.apply(_certificateChainEngi,_toConsumableArray(_this.ocsps));return certificateChainEngine.verify().then(function(verificationResult){if("certificatePath"in verificationResult)certificatePath=verificationResult.certificatePath;if(verificationResult.result===true)return Promise.resolve(true);if(extendedMode){return Promise.reject({date:checkDate,code:5,message:"Validation of signer's certificate failed: "+verificationResult.resultMessage,signatureVerified:null,signerCertificate:signerCertificate,signerCertificateVerified:false})}return Promise.reject("Validation of signer's certificate failed")},function(error){if(extendedMode){return Promise.reject({date:checkDate,code:5,message:"Validation of signer's certificate failed with error: "+(error instanceof Object?error.resultMessage:error),signatureVerified:null,signerCertificate:signerCertificate,signerCertificateVerified:false})}return Promise.reject("Validation of signer's certificate failed with error: "+(error instanceof Object?error.resultMessage:error))})})}sequence=sequence.then(function(result){if(result===false)return false;var signerInfoHashAlgorithm=(0,_common.getAlgorithmByOID)(_this.signerInfos[signer].digestAlgorithm.algorithmId);if("name"in signerInfoHashAlgorithm===false){if(extendedMode){return Promise.reject({date:checkDate,code:7,message:"Unsupported signature algorithm: "+_this.signerInfos[signer].digestAlgorithm.algorithmId,signatureVerified:null,signerCertificate:signerCertificate,signerCertificateVerified:true})}return Promise.reject("Unsupported signature algorithm: "+_this.signerInfos[signer].digestAlgorithm.algorithmId)}shaAlgorithm=signerInfoHashAlgorithm.name;return true});sequence=sequence.then(function(result){if(result===false)return false;if("eContent"in _this.encapContentInfo){if(_this.encapContentInfo.eContent.idBlock.tagClass===1&&_this.encapContentInfo.eContent.idBlock.tagNumber===4){if(_this.encapContentInfo.eContent.idBlock.isConstructed===false)data=_this.encapContentInfo.eContent.valueBlock.valueHex;else{var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=_this.encapContentInfo.eContent.valueBlock.value[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var contentValue=_step5.value;data=(0,_pvutils.utilConcatBuf)(data,contentValue.valueBlock.valueHex)}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally{try{if(!_iteratorNormalCompletion5&&_iterator5.return){_iterator5.return()}}finally{if(_didIteratorError5){throw _iteratorError5}}}}}else data=_this.encapContentInfo.eContent.valueBlock.valueBeforeDecode}else{if(data.byteLength===0){if(extendedMode){return Promise.reject({date:checkDate,code:8,message:"Missed detached data input array",signatureVerified:null,signerCertificate:signerCertificate,signerCertificateVerified:true})}return Promise.reject("Missed detached data input array")}}if("signedAttrs"in _this.signerInfos[signer]){var foundContentType=false;var foundMessageDigest=false;var _iteratorNormalCompletion6=true;var _didIteratorError6=false;var _iteratorError6=undefined;try{for(var _iterator6=_this.signerInfos[signer].signedAttrs.attributes[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=true){var attribute=_step6.value;if(attribute.type==="1.2.840.113549.1.9.3")foundContentType=true;if(attribute.type==="1.2.840.113549.1.9.4"){foundMessageDigest=true;messageDigestValue=attribute.values[0].valueBlock.valueHex}if(foundContentType&&foundMessageDigest)break}}catch(err){_didIteratorError6=true;_iteratorError6=err}finally{try{if(!_iteratorNormalCompletion6&&_iterator6.return){_iterator6.return()}}finally{if(_didIteratorError6){throw _iteratorError6}}}if(foundContentType===false){if(extendedMode){return Promise.reject({date:checkDate,code:9,message:'Attribute "content-type" is a mandatory attribute for "signed attributes"',signatureVerified:null,signerCertificate:signerCertificate,signerCertificateVerified:true})}return Promise.reject('Attribute "content-type" is a mandatory attribute for "signed attributes"')}if(foundMessageDigest===false){if(extendedMode){return Promise.reject({date:checkDate,code:10,message:'Attribute "message-digest" is a mandatory attribute for "signed attributes"',signatureVerified:null,signerCertificate:signerCertificate,signerCertificateVerified:true})}return Promise.reject('Attribute "message-digest" is a mandatory attribute for "signed attributes"')}}return true});sequence=sequence.then(function(result){if(result===false)return false;if("signedAttrs"in _this.signerInfos[signer])return crypto.digest(shaAlgorithm,new Uint8Array(data));return true}).then(function(result){if(result===false)return false;if("signedAttrs"in _this.signerInfos[signer]){if((0,_pvutils.isEqualBuffer)(result,messageDigestValue)){data=_this.signerInfos[signer].signedAttrs.encodedValue;return true}return false}return true});sequence=sequence.then(function(result){if(result===false)return false;return engine.subtle.verifyWithPublicKey(data,_this.signerInfos[signer].signature,signerCertificate.subjectPublicKeyInfo,signerCertificate.signatureAlgorithm,shaAlgorithm)});sequence=sequence.then(function(result){if(extendedMode){return{date:checkDate,code:14,message:"",signatureVerified:result,signerCertificate:signerCertificate,timestampSerial:timestampSerial,signerCertificateVerified:true,certificatePath:certificatePath}}return result},function(error){if(extendedMode){if("code"in error)return Promise.reject(error);return Promise.reject({date:checkDate,code:15,message:"Error during verification: "+error.message,signatureVerified:null,signerCertificate:signerCertificate,timestampSerial:timestampSerial,signerCertificateVerified:true})}return Promise.reject(error)});return sequence}},{key:"sign",value:function sign(privateKey,signerIndex){var _this2=this;var hashAlgorithm=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"SHA-1";var data=arguments.length>3&&arguments[3]!==undefined?arguments[3]:new ArrayBuffer(0);if(typeof privateKey==="undefined")return Promise.reject("Need to provide a private key for signing");var sequence=Promise.resolve();var parameters=void 0;var engine=(0,_common.getEngine)();var hashAlgorithmOID=(0,_common.getOIDByAlgorithm)({name:hashAlgorithm});if(hashAlgorithmOID==="")return Promise.reject("Unsupported hash algorithm: "+hashAlgorithm);if(this.digestAlgorithms.filter(function(algorithm){return algorithm.algorithmId===hashAlgorithmOID}).length===0){this.digestAlgorithms.push(new _AlgorithmIdentifier2.default({algorithmId:hashAlgorithmOID,algorithmParams:new asn1js.Null}))}this.signerInfos[signerIndex].digestAlgorithm=new _AlgorithmIdentifier2.default({algorithmId:hashAlgorithmOID,algorithmParams:new asn1js.Null});sequence=sequence.then(function(){return engine.subtle.getSignatureParameters(privateKey,hashAlgorithm)});sequence=sequence.then(function(result){parameters=result.parameters;_this2.signerInfos[signerIndex].signatureAlgorithm=result.signatureAlgorithm});sequence=sequence.then(function(){if("signedAttrs"in _this2.signerInfos[signerIndex]){if(_this2.signerInfos[signerIndex].signedAttrs.encodedValue.byteLength!==0)data=_this2.signerInfos[signerIndex].signedAttrs.encodedValue;else{data=_this2.signerInfos[signerIndex].signedAttrs.toSchema(true).toBER(false);var view=new Uint8Array(data);view[0]=49}}else{if("eContent"in _this2.encapContentInfo){if(_this2.encapContentInfo.eContent.idBlock.tagClass===1&&_this2.encapContentInfo.eContent.idBlock.tagNumber===4){if(_this2.encapContentInfo.eContent.idBlock.isConstructed===false)data=_this2.encapContentInfo.eContent.valueBlock.valueHex;else{var _iteratorNormalCompletion7=true;var _didIteratorError7=false;var _iteratorError7=undefined;try{for(var _iterator7=_this2.encapContentInfo.eContent.valueBlock.value[Symbol.iterator](),_step7;!(_iteratorNormalCompletion7=(_step7=_iterator7.next()).done);_iteratorNormalCompletion7=true){var content=_step7.value;data=(0,_pvutils.utilConcatBuf)(data,content.valueBlock.valueHex)}}catch(err){_didIteratorError7=true;_iteratorError7=err}finally{try{if(!_iteratorNormalCompletion7&&_iterator7.return){_iterator7.return()}}finally{if(_didIteratorError7){throw _iteratorError7}}}}}else data=_this2.encapContentInfo.eContent.valueBlock.valueBeforeDecode}else{if(data.byteLength===0)return Promise.reject("Missed detached data input array")}}return Promise.resolve()});sequence=sequence.then(function(){return engine.subtle.signWithPrivateKey(data,privateKey,parameters)});sequence=sequence.then(function(result){_this2.signerInfos[signerIndex].signature=new asn1js.OctetString({valueHex:result});return result});return sequence}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 0;case"digestAlgorithms":return[];case"encapContentInfo":return new _EncapsulatedContentInfo2.default;case"certificates":return[];case"crls":return[];case"ocsps":return[];case"signerInfos":return[];default:throw new Error("Invalid member name for SignedData class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"version":return memberValue===SignedData.defaultValues("version");case"encapContentInfo":return new _EncapsulatedContentInfo2.default;case"digestAlgorithms":case"certificates":case"crls":case"ocsps":case"signerInfos":return memberValue.length===0;default:throw new Error("Invalid member name for SignedData class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});if("optional"in names===false)names.optional=false;return new asn1js.Sequence({name:names.blockName||"SignedData",optional:names.optional,value:[new asn1js.Integer({name:names.version||"SignedData.version"}),new asn1js.Set({value:[new asn1js.Repeated({name:names.digestAlgorithms||"SignedData.digestAlgorithms",value:_AlgorithmIdentifier2.default.schema()})]}),_EncapsulatedContentInfo2.default.schema(names.encapContentInfo||{names:{blockName:"SignedData.encapContentInfo"}}),new asn1js.Constructed({name:names.certificates||"SignedData.certificates",optional:true,idBlock:{tagClass:3,tagNumber:0},value:_CertificateSet2.default.schema().valueBlock.value}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:_RevocationInfoChoices2.default.schema(names.crls||{names:{crls:"SignedData.crls"}}).valueBlock.value}),new asn1js.Set({value:[new asn1js.Repeated({name:names.signerInfos||"SignedData.signerInfos",value:_SignerInfo2.default.schema()})]})]})}}]);return SignedData}();exports.default=SignedData},{"./AlgorithmIdentifier.js":3,"./BasicOCSPResponse.js":12,"./Certificate.js":17,"./CertificateChainValidationEngine.js":18,"./CertificateRevocationList.js":20,"./CertificateSet.js":21,"./EncapsulatedContentInfo.js":30,"./IssuerAndSerialNumber.js":41,"./OtherRevocationInfoFormat.js":61,"./RevocationInfoChoices.js":89,"./SignerInfo.js":97,"./TSTInfo.js":101,"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],97:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _SignedAndUnsignedAttributes=require("./SignedAndUnsignedAttributes.js");var _SignedAndUnsignedAttributes2=_interopRequireDefault(_SignedAndUnsignedAttributes);var _IssuerAndSerialNumber=require("./IssuerAndSerialNumber.js");var _IssuerAndSerialNumber2=_interopRequireDefault(_IssuerAndSerialNumber);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var SignerInfo=function(){function SignerInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,SignerInfo);this.version=(0,_pvutils.getParametersValue)(parameters,"version",SignerInfo.defaultValues("version"));this.sid=(0,_pvutils.getParametersValue)(parameters,"sid",SignerInfo.defaultValues("sid"));this.digestAlgorithm=(0,_pvutils.getParametersValue)(parameters,"digestAlgorithm",SignerInfo.defaultValues("digestAlgorithm"));if("signedAttrs"in parameters)this.signedAttrs=(0,_pvutils.getParametersValue)(parameters,"signedAttrs",SignerInfo.defaultValues("signedAttrs"));this.signatureAlgorithm=(0,_pvutils.getParametersValue)(parameters,"signatureAlgorithm",SignerInfo.defaultValues("signatureAlgorithm"));this.signature=(0,_pvutils.getParametersValue)(parameters,"signature",SignerInfo.defaultValues("signature"));if("unsignedAttrs"in parameters)this.unsignedAttrs=(0,_pvutils.getParametersValue)(parameters,"unsignedAttrs",SignerInfo.defaultValues("unsignedAttrs"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(SignerInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,SignerInfo.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for CMS_SIGNER_INFO");this.version=asn1.result["SignerInfo.version"].valueBlock.valueDec;var currentSid=asn1.result["SignerInfo.sid"];if(currentSid.idBlock.tagClass===1)this.sid=new _IssuerAndSerialNumber2.default({schema:currentSid});else this.sid=currentSid;this.digestAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result["SignerInfo.digestAlgorithm"]});if("SignerInfo.signedAttrs"in asn1.result)this.signedAttrs=new _SignedAndUnsignedAttributes2.default({type:0,schema:asn1.result["SignerInfo.signedAttrs"]});this.signatureAlgorithm=new _AlgorithmIdentifier2.default({schema:asn1.result["SignerInfo.signatureAlgorithm"]});this.signature=asn1.result["SignerInfo.signature"];if("SignerInfo.unsignedAttrs"in asn1.result)this.unsignedAttrs=new _SignedAndUnsignedAttributes2.default({type:1,schema:asn1.result["SignerInfo.unsignedAttrs"]})}},{key:"toSchema",value:function toSchema(){if(SignerInfo.compareWithDefault("sid",this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');var outputArray=[];outputArray.push(new asn1js.Integer({value:this.version}));if(this.sid instanceof _IssuerAndSerialNumber2.default)outputArray.push(this.sid.toSchema());else outputArray.push(this.sid);outputArray.push(this.digestAlgorithm.toSchema());if("signedAttrs"in this){if(SignerInfo.compareWithDefault("signedAttrs",this.signedAttrs)===false)outputArray.push(this.signedAttrs.toSchema())}outputArray.push(this.signatureAlgorithm.toSchema());outputArray.push(this.signature);if("unsignedAttrs"in this){if(SignerInfo.compareWithDefault("unsignedAttrs",this.unsignedAttrs)===false)outputArray.push(this.unsignedAttrs.toSchema())}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){if(SignerInfo.compareWithDefault("sid",this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');var _object={version:this.version};if(!(this.sid instanceof asn1js.Any))_object.sid=this.sid.toJSON();_object.digestAlgorithm=this.digestAlgorithm.toJSON();if(SignerInfo.compareWithDefault("signedAttrs",this.signedAttrs)===false)_object.signedAttrs=this.signedAttrs.toJSON();_object.signatureAlgorithm=this.signatureAlgorithm.toJSON();_object.signature=this.signature.toJSON();if(SignerInfo.compareWithDefault("unsignedAttrs",this.unsignedAttrs)===false)_object.unsignedAttrs=this.unsignedAttrs.toJSON();return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 0;case"sid":return new asn1js.Any;case"digestAlgorithm":return new _AlgorithmIdentifier2.default;case"signedAttrs":return new _SignedAndUnsignedAttributes2.default({type:0});case"signatureAlgorithm":return new _AlgorithmIdentifier2.default;case"signature":return new asn1js.OctetString;case"unsignedAttrs":return new _SignedAndUnsignedAttributes2.default({type:1});default:throw new Error("Invalid member name for SignerInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"version":return SignerInfo.defaultValues("version")===memberValue;case"sid":return memberValue instanceof asn1js.Any;case"digestAlgorithm":if(memberValue instanceof _AlgorithmIdentifier2.default===false)return false;return memberValue.isEqual(SignerInfo.defaultValues("digestAlgorithm"));case"signedAttrs":return _SignedAndUnsignedAttributes2.default.compareWithDefault("type",memberValue.type)&&_SignedAndUnsignedAttributes2.default.compareWithDefault("attributes",memberValue.attributes)&&_SignedAndUnsignedAttributes2.default.compareWithDefault("encodedValue",memberValue.encodedValue);case"signatureAlgorithm":if(memberValue instanceof _AlgorithmIdentifier2.default===false)return false;return memberValue.isEqual(SignerInfo.defaultValues("signatureAlgorithm"));case"signature":case"unsignedAttrs":return _SignedAndUnsignedAttributes2.default.compareWithDefault("type",memberValue.type)&&_SignedAndUnsignedAttributes2.default.compareWithDefault("attributes",memberValue.attributes)&&_SignedAndUnsignedAttributes2.default.compareWithDefault("encodedValue",memberValue.encodedValue);default:throw new Error("Invalid member name for SignerInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:"SignerInfo",value:[new asn1js.Integer({name:names.version||"SignerInfo.version"}),new asn1js.Choice({value:[_IssuerAndSerialNumber2.default.schema(names.sid||{names:{blockName:"SignerInfo.sid"}}),new asn1js.Constructed({optional:true,name:names.sid||"SignerInfo.sid",idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.OctetString]})]}),_AlgorithmIdentifier2.default.schema(names.digestAlgorithm||{names:{blockName:"SignerInfo.digestAlgorithm"}}),_SignedAndUnsignedAttributes2.default.schema(names.signedAttrs||{names:{blockName:"SignerInfo.signedAttrs",tagNumber:0}}),_AlgorithmIdentifier2.default.schema(names.signatureAlgorithm||{names:{blockName:"SignerInfo.signatureAlgorithm"}}),new asn1js.OctetString({name:names.signature||"SignerInfo.signature"}),_SignedAndUnsignedAttributes2.default.schema(names.unsignedAttrs||{names:{blockName:"SignerInfo.unsignedAttrs",tagNumber:1}})]})}}]);return SignerInfo}();exports.default=SignerInfo},{"./AlgorithmIdentifier.js":3,"./IssuerAndSerialNumber.js":41,"./SignedAndUnsignedAttributes.js":95,asn1js:"asn1js",pvutils:"pvutils"}],98:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _CertID=require("./CertID.js");var _CertID2=_interopRequireDefault(_CertID);var _Extension=require("./Extension.js");var _Extension2=_interopRequireDefault(_Extension);var _Extensions=require("./Extensions.js");var _Extensions2=_interopRequireDefault(_Extensions);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var SingleResponse=function(){function SingleResponse(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,SingleResponse);this.certID=(0,_pvutils.getParametersValue)(parameters,"certID",SingleResponse.defaultValues("certID"));this.certStatus=(0,_pvutils.getParametersValue)(parameters,"certStatus",SingleResponse.defaultValues("certStatus"));this.thisUpdate=(0,_pvutils.getParametersValue)(parameters,"thisUpdate",SingleResponse.defaultValues("thisUpdate"));if("nextUpdate"in parameters)this.nextUpdate=(0,_pvutils.getParametersValue)(parameters,"nextUpdate",SingleResponse.defaultValues("nextUpdate"));if("singleExtensions"in parameters)this.singleExtensions=(0,_pvutils.getParametersValue)(parameters,"singleExtensions",SingleResponse.defaultValues("singleExtensions"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(SingleResponse,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,SingleResponse.schema({names:{certID:{names:{blockName:"certID"}},certStatus:"certStatus",thisUpdate:"thisUpdate",nextUpdate:"nextUpdate",singleExtensions:{names:{blockName:"singleExtensions"}}}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for SingleResponse");this.certID=new _CertID2.default({schema:asn1.result.certID});this.certStatus=asn1.result.certStatus;this.thisUpdate=asn1.result.thisUpdate.toDate();if("nextUpdate"in asn1.result)this.nextUpdate=asn1.result.nextUpdate.toDate();if("singleExtensions"in asn1.result)this.singleExtensions=Array.from(asn1.result.singleExtensions.valueBlock.value,function(element){return new _Extension2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(this.certID.toSchema());outputArray.push(this.certStatus);outputArray.push(new asn1js.GeneralizedTime({valueDate:this.thisUpdate}));if("nextUpdate"in this)outputArray.push(new asn1js.GeneralizedTime({valueDate:this.nextUpdate}));if("singleExtensions"in this){outputArray.push(new asn1js.Sequence({value:Array.from(this.singleExtensions,function(element){return element.toSchema()})}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={certID:this.certID.toJSON(),certStatus:this.certStatus.toJSON(),thisUpdate:this.thisUpdate};if("nextUpdate"in this)_object.nextUpdate=this.nextUpdate;if("singleExtensions"in this)_object.singleExtensions=Array.from(this.singleExtensions,function(element){return element.toJSON()});return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"certID":return new _CertID2.default;case"certStatus":return{};case"thisUpdate":case"nextUpdate":return new Date(0,0,0);case"singleExtensions":return[];default:throw new Error("Invalid member name for SingleResponse class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"certID":return _CertID2.default.compareWithDefault("hashAlgorithm",memberValue.hashAlgorithm)&&_CertID2.default.compareWithDefault("issuerNameHash",memberValue.issuerNameHash)&&_CertID2.default.compareWithDefault("issuerKeyHash",memberValue.issuerKeyHash)&&_CertID2.default.compareWithDefault("serialNumber",memberValue.serialNumber);case"certStatus":return Object.keys(memberValue).length===0;case"thisUpdate":case"nextUpdate":return memberValue===SingleResponse.defaultValues(memberName);default:throw new Error("Invalid member name for SingleResponse class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[_CertID2.default.schema(names.certID||{}),new asn1js.Choice({value:[new asn1js.Primitive({name:names.certStatus||"",idBlock:{tagClass:3,tagNumber:0},lenBlockLength:1}),new asn1js.Constructed({name:names.certStatus||"",idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.GeneralizedTime,new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Enumerated]})]}),new asn1js.Primitive({name:names.certStatus||"",idBlock:{tagClass:3,tagNumber:2},lenBlock:{length:1}})]}),new asn1js.GeneralizedTime({name:names.thisUpdate||""}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.GeneralizedTime({name:names.nextUpdate||""})]}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[_Extensions2.default.schema(names.singleExtensions||{})]})]})}}]);return SingleResponse}();exports.default=SingleResponse},{"./CertID.js":16,"./Extension.js":35,"./Extensions.js":36,asn1js:"asn1js",pvutils:"pvutils"}],99:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _Attribute=require("./Attribute.js");var _Attribute2=_interopRequireDefault(_Attribute);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var SubjectDirectoryAttributes=function(){function SubjectDirectoryAttributes(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,SubjectDirectoryAttributes);this.attributes=(0,_pvutils.getParametersValue)(parameters,"attributes",SubjectDirectoryAttributes.defaultValues("attributes"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(SubjectDirectoryAttributes,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,SubjectDirectoryAttributes.schema({names:{attributes:"attributes"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for SubjectDirectoryAttributes");this.attributes=Array.from(asn1.result.attributes,function(element){return new _Attribute2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){return new asn1js.Sequence({value:Array.from(this.attributes,function(element){return element.toSchema()})})}},{key:"toJSON",value:function toJSON(){return{attributes:Array.from(this.attributes,function(element){return element.toJSON()})}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"attributes":return[];default:throw new Error("Invalid member name for SubjectDirectoryAttributes class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"",value:[new asn1js.Repeated({name:names.attributes||"",value:_Attribute2.default.schema()})]})}}]);return SubjectDirectoryAttributes}();exports.default=SubjectDirectoryAttributes},{"./Attribute.js":5,asn1js:"asn1js",pvutils:"pvutils"}],100:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _GeneralName=require("./GeneralName.js");var _GeneralName2=_interopRequireDefault(_GeneralName);var _Request=require("./Request.js");var _Request2=_interopRequireDefault(_Request);var _Extension=require("./Extension.js");var _Extension2=_interopRequireDefault(_Extension);var _Extensions=require("./Extensions.js");var _Extensions2=_interopRequireDefault(_Extensions);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TBSRequest=function(){function TBSRequest(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,TBSRequest);this.tbs=(0,_pvutils.getParametersValue)(parameters,"tbs",TBSRequest.defaultValues("tbs"));if("version"in parameters)this.version=(0,_pvutils.getParametersValue)(parameters,"version",TBSRequest.defaultValues("version"));if("requestorName"in parameters)this.requestorName=(0,_pvutils.getParametersValue)(parameters,"requestorName",TBSRequest.defaultValues("requestorName"));this.requestList=(0,_pvutils.getParametersValue)(parameters,"requestList",TBSRequest.defaultValues("requestList"));if("requestExtensions"in parameters)this.requestExtensions=(0,_pvutils.getParametersValue)(parameters,"requestExtensions",TBSRequest.defaultValues("requestExtensions"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(TBSRequest,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,TBSRequest.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for TBSRequest");this.tbs=asn1.result.TBSRequest.valueBeforeDecode;if("TBSRequest.version"in asn1.result)this.version=asn1.result["TBSRequest.version"].valueBlock.valueDec;if("TBSRequest.requestorName"in asn1.result)this.requestorName=new _GeneralName2.default({schema:asn1.result["TBSRequest.requestorName"]});this.requestList=Array.from(asn1.result["TBSRequest.requests"],function(element){return new _Request2.default({schema:element})});if("TBSRequest.requestExtensions"in asn1.result)this.requestExtensions=Array.from(asn1.result["TBSRequest.requestExtensions"].valueBlock.value,function(element){return new _Extension2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var encodeFlag=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var tbsSchema=void 0;if(encodeFlag===false){if(this.tbs.byteLength===0)return TBSRequest.schema();tbsSchema=asn1js.fromBER(this.tbs).result}else{var outputArray=[];if("version"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Integer({value:this.version})]}))}if("requestorName"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[this.requestorName.toSchema()]}))}outputArray.push(new asn1js.Sequence({value:Array.from(this.requestList,function(element){return element.toSchema()})}));if("requestExtensions"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:2},value:[new asn1js.Sequence({value:Array.from(this.requestExtensions,function(element){return element.toSchema()})})]}))}tbsSchema=new asn1js.Sequence({value:outputArray})}return tbsSchema}},{key:"toJSON",value:function toJSON(){var _object={};if("version"in this)_object.version=this.version;if("requestorName"in this)_object.requestorName=this.requestorName.toJSON();_object.requestList=Array.from(this.requestList,function(element){return element.toJSON()});if("requestExtensions"in this)_object.requestExtensions=Array.from(this.requestExtensions,function(element){return element.toJSON()});return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"tbs":return new ArrayBuffer(0);case"version":return 0;case"requestorName":return new _GeneralName2.default;case"requestList":case"requestExtensions":return[];default:throw new Error("Invalid member name for TBSRequest class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"tbs":return memberValue.byteLength===0;case"version":return memberValue===TBSRequest.defaultValues(memberName);case"requestorName":return memberValue.type===_GeneralName2.default.defaultValues("type")&&Object.keys(memberValue.value).length===0;case"requestList":case"requestExtensions":return memberValue.length===0;default:throw new Error("Invalid member name for TBSRequest class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"TBSRequest",value:[new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Integer({name:names.TBSRequestVersion||"TBSRequest.version"})]}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[_GeneralName2.default.schema(names.requestorName||{names:{blockName:"TBSRequest.requestorName"}})]}),new asn1js.Sequence({name:names.requestList||"TBSRequest.requestList",value:[new asn1js.Repeated({name:names.requests||"TBSRequest.requests",value:_Request2.default.schema(names.requestNames||{})})]}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:2},value:[_Extensions2.default.schema(names.extensions||{names:{blockName:names.requestExtensions||"TBSRequest.requestExtensions"}})]})]})}}]);return TBSRequest}();exports.default=TBSRequest},{"./Extension.js":35,"./Extensions.js":36,"./GeneralName.js":37,"./Request.js":86,asn1js:"asn1js",pvutils:"pvutils"}],101:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _common=require("./common.js");var _MessageImprint=require("./MessageImprint.js");var _MessageImprint2=_interopRequireDefault(_MessageImprint);var _Accuracy=require("./Accuracy.js");var _Accuracy2=_interopRequireDefault(_Accuracy);var _GeneralName=require("./GeneralName.js");var _GeneralName2=_interopRequireDefault(_GeneralName);var _Extension=require("./Extension.js");var _Extension2=_interopRequireDefault(_Extension);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TSTInfo=function(){function TSTInfo(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,TSTInfo);this.version=(0,_pvutils.getParametersValue)(parameters,"version",TSTInfo.defaultValues("version"));this.policy=(0,_pvutils.getParametersValue)(parameters,"policy",TSTInfo.defaultValues("policy"));this.messageImprint=(0,_pvutils.getParametersValue)(parameters,"messageImprint",TSTInfo.defaultValues("messageImprint"));this.serialNumber=(0,_pvutils.getParametersValue)(parameters,"serialNumber",TSTInfo.defaultValues("serialNumber"));this.genTime=(0,_pvutils.getParametersValue)(parameters,"genTime",TSTInfo.defaultValues("genTime"));if("accuracy"in parameters)this.accuracy=(0,_pvutils.getParametersValue)(parameters,"accuracy",TSTInfo.defaultValues("accuracy"));if("ordering"in parameters)this.ordering=(0,_pvutils.getParametersValue)(parameters,"ordering",TSTInfo.defaultValues("ordering"));if("nonce"in parameters)this.nonce=(0,_pvutils.getParametersValue)(parameters,"nonce",TSTInfo.defaultValues("nonce"));if("tsa"in parameters)this.tsa=(0,_pvutils.getParametersValue)(parameters,"tsa",TSTInfo.defaultValues("tsa"));if("extensions"in parameters)this.extensions=(0,_pvutils.getParametersValue)(parameters,"extensions",TSTInfo.defaultValues("extensions"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(TSTInfo,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,TSTInfo.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for TST_INFO");this.version=asn1.result["TSTInfo.version"].valueBlock.valueDec;this.policy=asn1.result["TSTInfo.policy"].valueBlock.toString();this.messageImprint=new _MessageImprint2.default({schema:asn1.result["TSTInfo.messageImprint"]});this.serialNumber=asn1.result["TSTInfo.serialNumber"];this.genTime=asn1.result["TSTInfo.genTime"].toDate();if("TSTInfo.accuracy"in asn1.result)this.accuracy=new _Accuracy2.default({schema:asn1.result["TSTInfo.accuracy"]});if("TSTInfo.ordering"in asn1.result)this.ordering=asn1.result["TSTInfo.ordering"].valueBlock.value;if("TSTInfo.nonce"in asn1.result)this.nonce=asn1.result["TSTInfo.nonce"];if("TSTInfo.tsa"in asn1.result)this.tsa=new _GeneralName2.default({schema:asn1.result["TSTInfo.tsa"]});if("TSTInfo.extensions"in asn1.result)this.extensions=Array.from(asn1.result["TSTInfo.extensions"],function(element){return new _Extension2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(new asn1js.Integer({value:this.version}));outputArray.push(new asn1js.ObjectIdentifier({value:this.policy}));outputArray.push(this.messageImprint.toSchema());outputArray.push(this.serialNumber);outputArray.push(new asn1js.GeneralizedTime({valueDate:this.genTime}));if("accuracy"in this)outputArray.push(this.accuracy.toSchema());if("ordering"in this)outputArray.push(new asn1js.Boolean({value:this.ordering}));if("nonce"in this)outputArray.push(this.nonce);if("tsa"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[this.tsa.toSchema()]}))}if("extensions"in this){outputArray.push(new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.extensions,function(element){return element.toSchema()})}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={version:this.version,policy:this.policy,messageImprint:this.messageImprint.toJSON(),serialNumber:this.serialNumber.toJSON(),genTime:this.genTime};if("accuracy"in this)_object.accuracy=this.accuracy.toJSON();if("ordering"in this)_object.ordering=this.ordering;if("nonce"in this)_object.nonce=this.nonce.toJSON();if("tsa"in this)_object.tsa=this.tsa.toJSON();if("extensions"in this)_object.extensions=Array.from(this.extensions,function(element){return element.toJSON()});return _object}},{key:"verify",value:function verify(){var _this=this;var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var sequence=Promise.resolve();var data=void 0;var notBefore=null;var notAfter=null;var crypto=(0,_common.getCrypto)();if(typeof crypto==="undefined")return Promise.reject("Unable to create WebCrypto object");if("data"in parameters)data=parameters.data;else return Promise.reject('"data" is a mandatory attribute for TST_INFO verification');if("notBefore"in parameters)notBefore=parameters.notBefore;if("notAfter"in parameters)notAfter=parameters.notAfter;if(notBefore!==null){if(this.genTime<notBefore)return Promise.reject("Generation time for TSTInfo object is less than notBefore value")}if(notAfter!==null){if(this.genTime>notAfter)return Promise.reject("Generation time for TSTInfo object is more than notAfter value")}var shaAlgorithm=(0,_common.getAlgorithmByOID)(this.messageImprint.hashAlgorithm.algorithmId);if("name"in shaAlgorithm===false)return Promise.reject("Unsupported signature algorithm: "+this.messageImprint.hashAlgorithm.algorithmId);sequence=sequence.then(function(){return crypto.digest(shaAlgorithm.name,new Uint8Array(data))}).then(function(result){return(0,_pvutils.isEqualBuffer)(result,_this.messageImprint.hashedMessage.valueBlock.valueHex)});return sequence}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 0;case"policy":return"";case"messageImprint":return new _MessageImprint2.default;case"serialNumber":return new asn1js.Integer;case"genTime":return new Date(0,0,0);case"accuracy":return new _Accuracy2.default;case"ordering":return false;case"nonce":return new asn1js.Integer;case"tsa":return new _GeneralName2.default;case"extensions":return[];default:throw new Error("Invalid member name for TSTInfo class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"version":case"policy":case"genTime":case"ordering":return memberValue===TSTInfo.defaultValues(memberName);case"messageImprint":return _MessageImprint2.default.compareWithDefault("hashAlgorithm",memberValue.hashAlgorithm)&&_MessageImprint2.default.compareWithDefault("hashedMessage",memberValue.hashedMessage);case"serialNumber":case"nonce":return memberValue.isEqual(TSTInfo.defaultValues(memberName));case"accuracy":return _Accuracy2.default.compareWithDefault("seconds",memberValue.seconds)&&_Accuracy2.default.compareWithDefault("millis",memberValue.millis)&&_Accuracy2.default.compareWithDefault("micros",memberValue.micros);case"tsa":return _GeneralName2.default.compareWithDefault("type",memberValue.type)&&_GeneralName2.default.compareWithDefault("value",memberValue.value);case"extensions":return memberValue.length===0;default:throw new Error("Invalid member name for TSTInfo class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"TSTInfo",value:[new asn1js.Integer({name:names.version||"TSTInfo.version"}),new asn1js.ObjectIdentifier({name:names.policy||"TSTInfo.policy"}),_MessageImprint2.default.schema(names.messageImprint||{names:{blockName:"TSTInfo.messageImprint"}}),new asn1js.Integer({name:names.serialNumber||"TSTInfo.serialNumber"}),new asn1js.GeneralizedTime({name:names.genTime||"TSTInfo.genTime"}),_Accuracy2.default.schema(names.accuracy||{names:{blockName:"TSTInfo.accuracy"}}),new asn1js.Boolean({name:names.ordering||"TSTInfo.ordering",optional:true}),new asn1js.Integer({name:names.nonce||"TSTInfo.nonce",optional:true}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[_GeneralName2.default.schema(names.tsa||{names:{blockName:"TSTInfo.tsa"}})]}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:1},value:[new asn1js.Repeated({name:names.extensions||"TSTInfo.extensions",value:_Extension2.default.schema(names.extension||{})})]})]})}}]);return TSTInfo}();exports.default=TSTInfo},{"./Accuracy.js":2,"./Extension.js":35,"./GeneralName.js":37,"./MessageImprint.js":50,"./common.js":105,asn1js:"asn1js",pvutils:"pvutils"}],102:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Time=function(){function Time(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Time);this.type=(0,_pvutils.getParametersValue)(parameters,"type",Time.defaultValues("type"));this.value=(0,_pvutils.getParametersValue)(parameters,"value",Time.defaultValues("value"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(Time,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,Time.schema({names:{utcTimeName:"utcTimeName",generalTimeName:"generalTimeName"}}));if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for TIME");if("utcTimeName"in asn1.result){this.type=0;this.value=asn1.result.utcTimeName.toDate()}if("generalTimeName"in asn1.result){this.type=1;this.value=asn1.result.generalTimeName.toDate()}}},{key:"toSchema",value:function toSchema(){var result={};if(this.type===0)result=new asn1js.UTCTime({valueDate:this.value});if(this.type===1)result=new asn1js.GeneralizedTime({valueDate:this.value});return result}},{key:"toJSON",value:function toJSON(){return{type:this.type,value:this.value}}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"type":return 0;case"value":return new Date(0,0,0);default:throw new Error("Invalid member name for Time class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var optional=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Choice({optional:optional,value:[new asn1js.UTCTime({name:names.utcTimeName||""}),new asn1js.GeneralizedTime({name:names.generalTimeName||""})]})}}]);return Time}();exports.default=Time},{asn1js:"asn1js",pvutils:"pvutils"}],103:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _MessageImprint=require("./MessageImprint.js");var _MessageImprint2=_interopRequireDefault(_MessageImprint);var _Extension=require("./Extension.js");var _Extension2=_interopRequireDefault(_Extension);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TimeStampReq=function(){function TimeStampReq(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,TimeStampReq);this.version=(0,_pvutils.getParametersValue)(parameters,"version",TimeStampReq.defaultValues("version"));this.messageImprint=(0,_pvutils.getParametersValue)(parameters,"messageImprint",TimeStampReq.defaultValues("messageImprint"));if("reqPolicy"in parameters)this.reqPolicy=(0,_pvutils.getParametersValue)(parameters,"reqPolicy",TimeStampReq.defaultValues("reqPolicy"));if("nonce"in parameters)this.nonce=(0,_pvutils.getParametersValue)(parameters,"nonce",TimeStampReq.defaultValues("nonce"));if("certReq"in parameters)this.certReq=(0,_pvutils.getParametersValue)(parameters,"certReq",TimeStampReq.defaultValues("certReq"));if("extensions"in parameters)this.extensions=(0,_pvutils.getParametersValue)(parameters,"extensions",TimeStampReq.defaultValues("extensions"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(TimeStampReq,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,TimeStampReq.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for TSP_REQUEST");this.version=asn1.result["TimeStampReq.version"].valueBlock.valueDec;this.messageImprint=new _MessageImprint2.default({schema:asn1.result["TimeStampReq.messageImprint"]});if("TimeStampReq.reqPolicy"in asn1.result)this.reqPolicy=asn1.result["TimeStampReq.reqPolicy"].valueBlock.toString();if("TimeStampReq.nonce"in asn1.result)this.nonce=asn1.result["TimeStampReq.nonce"];if("TimeStampReq.certReq"in asn1.result)this.certReq=asn1.result["TimeStampReq.certReq"].valueBlock.value;if("TimeStampReq.extensions"in asn1.result)this.extensions=Array.from(asn1.result["TimeStampReq.extensions"],function(element){return new _Extension2.default({schema:element})})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(new asn1js.Integer({value:this.version}));outputArray.push(this.messageImprint.toSchema());if("reqPolicy"in this)outputArray.push(new asn1js.ObjectIdentifier({value:this.reqPolicy}));if("nonce"in this)outputArray.push(this.nonce);if("certReq"in this&&TimeStampReq.compareWithDefault("certReq",this.certReq)===false)outputArray.push(new asn1js.Boolean({value:this.certReq}));if("extensions"in this){outputArray.push(new asn1js.Constructed({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.extensions,function(element){return element.toSchema()})}))}return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={version:this.version,messageImprint:this.messageImprint.toJSON()};if("reqPolicy"in this)_object.reqPolicy=this.reqPolicy;if("nonce"in this)_object.nonce=this.nonce.toJSON();if("certReq"in this&&TimeStampReq.compareWithDefault("certReq",this.certReq)===false)_object.certReq=this.certReq;if("extensions"in this)_object.extensions=Array.from(this.extensions,function(element){return element.toJSON()});return _object}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"version":return 0;case"messageImprint":return new _MessageImprint2.default;case"reqPolicy":return"";case"nonce":return new asn1js.Integer;case"certReq":return false;case"extensions":return[];default:throw new Error("Invalid member name for TimeStampReq class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"version":case"reqPolicy":case"certReq":return memberValue===TimeStampReq.defaultValues(memberName);case"messageImprint":return _MessageImprint2.default.compareWithDefault("hashAlgorithm",memberValue.hashAlgorithm)&&_MessageImprint2.default.compareWithDefault("hashedMessage",memberValue.hashedMessage);case"nonce":return memberValue.isEqual(TimeStampReq.defaultValues(memberName));case"extensions":return memberValue.length===0;default:throw new Error("Invalid member name for TimeStampReq class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"TimeStampReq",value:[new asn1js.Integer({name:names.version||"TimeStampReq.version"}),_MessageImprint2.default.schema(names.messageImprint||{names:{blockName:"TimeStampReq.messageImprint"}}),new asn1js.ObjectIdentifier({name:names.reqPolicy||"TimeStampReq.reqPolicy",optional:true}),new asn1js.Integer({name:names.nonce||"TimeStampReq.nonce",optional:true}),new asn1js.Boolean({name:names.certReq||"TimeStampReq.certReq",optional:true}),new asn1js.Constructed({optional:true,idBlock:{tagClass:3,tagNumber:0},value:[new asn1js.Repeated({name:names.extensions||"TimeStampReq.extensions",value:_Extension2.default.schema()})]})]})}}]);return TimeStampReq}();exports.default=TimeStampReq},{"./Extension.js":35,"./MessageImprint.js":50,asn1js:"asn1js",pvutils:"pvutils"}],104:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _PKIStatusInfo=require("./PKIStatusInfo.js");var _PKIStatusInfo2=_interopRequireDefault(_PKIStatusInfo);var _ContentInfo=require("./ContentInfo.js");var _ContentInfo2=_interopRequireDefault(_ContentInfo);var _SignedData=require("./SignedData.js");var _SignedData2=_interopRequireDefault(_SignedData);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TimeStampResp=function(){function TimeStampResp(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,TimeStampResp);this.status=(0,_pvutils.getParametersValue)(parameters,"status",TimeStampResp.defaultValues("status"));if("timeStampToken"in parameters)this.timeStampToken=(0,_pvutils.getParametersValue)(parameters,"timeStampToken",TimeStampResp.defaultValues("timeStampToken"));if("schema"in parameters)this.fromSchema(parameters.schema)}_createClass(TimeStampResp,[{key:"fromSchema",value:function fromSchema(schema){var asn1=asn1js.compareSchema(schema,schema,TimeStampResp.schema());if(asn1.verified===false)throw new Error("Object's schema was not verified against input data for TSP_RESPONSE");this.status=new _PKIStatusInfo2.default({schema:asn1.result["TimeStampResp.status"]});if("TimeStampResp.timeStampToken"in asn1.result)this.timeStampToken=new _ContentInfo2.default({schema:asn1.result["TimeStampResp.timeStampToken"]})}},{key:"toSchema",value:function toSchema(){var outputArray=[];outputArray.push(this.status.toSchema());if("timeStampToken"in this)outputArray.push(this.timeStampToken.toSchema());return new asn1js.Sequence({value:outputArray})}},{key:"toJSON",value:function toJSON(){var _object={status:this.status};if("timeStampToken"in this)_object.timeStampToken=this.timeStampToken.toJSON();return _object}},{key:"sign",value:function sign(privateKey,hashAlgorithm){if("timeStampToken"in this===false)return Promise.reject("timeStampToken is absent in TSP response");if(this.timeStampToken.contentType!=="1.2.840.113549.1.7.2")return Promise.reject("Wrong format of timeStampToken: "+this.timeStampToken.contentType);var signed=new _ContentInfo2.default({schema:this.timeStampToken.content});return signed.sign(privateKey,0,hashAlgorithm)}},{key:"verify",value:function verify(){var verificationParameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{signer:0,trustedCerts:[],data:new ArrayBuffer(0)};if("timeStampToken"in this===false)return Promise.reject("timeStampToken is absent in TSP response");if(this.timeStampToken.contentType!=="1.2.840.113549.1.7.2")return Promise.reject("Wrong format of timeStampToken: "+this.timeStampToken.contentType);var signed=new _SignedData2.default({schema:this.timeStampToken.content});return signed.verify(verificationParameters)}}],[{key:"defaultValues",value:function defaultValues(memberName){switch(memberName){case"status":return new _PKIStatusInfo2.default;case"timeStampToken":return new _ContentInfo2.default;default:throw new Error("Invalid member name for TimeStampResp class: "+memberName)}}},{key:"compareWithDefault",value:function compareWithDefault(memberName,memberValue){switch(memberName){case"status":return _PKIStatusInfo2.default.compareWithDefault("status",memberValue.status)&&"statusStrings"in memberValue===false&&"failInfo"in memberValue===false;case"timeStampToken":return memberValue.contentType===""&&memberValue.content instanceof asn1js.Any;default:throw new Error("Invalid member name for TimeStampResp class: "+memberName)}}},{key:"schema",value:function schema(){var parameters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var names=(0,_pvutils.getParametersValue)(parameters,"names",{});return new asn1js.Sequence({name:names.blockName||"TimeStampResp",value:[_PKIStatusInfo2.default.schema(names.status||{names:{blockName:"TimeStampResp.status"}}),_ContentInfo2.default.schema(names.timeStampToken||{names:{blockName:"TimeStampResp.timeStampToken",optional:true}})]})}}]);return TimeStampResp}();exports.default=TimeStampResp},{"./ContentInfo.js":23,"./PKIStatusInfo.js":66,"./SignedData.js":96,asn1js:"asn1js",pvutils:"pvutils"}],105:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setEngine=setEngine;exports.getEngine=getEngine;exports.getCrypto=getCrypto;exports.getRandomValues=getRandomValues;exports.getOIDByAlgorithm=getOIDByAlgorithm;exports.getAlgorithmParameters=getAlgorithmParameters;exports.createCMSECDSASignature=createCMSECDSASignature;exports.stringPrep=stringPrep;exports.createECDSASignatureFromCMS=createECDSASignatureFromCMS;exports.getAlgorithmByOID=getAlgorithmByOID;exports.getHashAlgorithm=getHashAlgorithm;exports.kdfWithCounter=kdfWithCounter;exports.kdf=kdf;var _asn1js=require("asn1js");var asn1js=_interopRequireWildcard(_asn1js);var _pvutils=require("pvutils");var _CryptoEngine=require("./CryptoEngine.js");var _CryptoEngine2=_interopRequireDefault(_CryptoEngine);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}var engine={name:"none",crypto:null,subtle:null};function setEngine(name,crypto,subtle){engine={name:name,crypto:crypto,subtle:subtle}}function getEngine(){return engine}(function initCryptoEngine(){if(typeof self!=="undefined"){if("crypto"in self){var engineName="webcrypto";var cryptoObject=self.crypto;var subtleObject=null;if("webkitSubtle"in self.crypto){try{subtleObject=self.crypto.webkitSubtle}catch(ex){subtleObject=self.crypto.subtle}engineName="safari"}if("subtle"in self.crypto)subtleObject=self.crypto.subtle;engine={name:engineName,crypto:cryptoObject,subtle:new _CryptoEngine2.default({name:engineName,crypto:self.crypto,subtle:subtleObject})}}}})();function getCrypto(){if(engine.subtle!==null)return engine.subtle;return undefined}function getRandomValues(view){return engine.subtle.getRandomValues(view)}function getOIDByAlgorithm(algorithm){return engine.subtle.getOIDByAlgorithm(algorithm)}function getAlgorithmParameters(algorithmName,operation){return engine.subtle.getAlgorithmParameters(algorithmName,operation)}function createCMSECDSASignature(signatureBuffer){if(signatureBuffer.byteLength%2!==0)return new ArrayBuffer(0);var length=signatureBuffer.byteLength/2;var rBuffer=new ArrayBuffer(length);var rView=new Uint8Array(rBuffer);rView.set(new Uint8Array(signatureBuffer,0,length));var rInteger=new asn1js.Integer({valueHex:rBuffer});var sBuffer=new ArrayBuffer(length);var sView=new Uint8Array(sBuffer);sView.set(new Uint8Array(signatureBuffer,length,length));var sInteger=new asn1js.Integer({valueHex:sBuffer});return new asn1js.Sequence({value:[rInteger.convertToDER(),sInteger.convertToDER()]}).toBER(false)}function stringPrep(inputString){var isSpace=false;var cuttedResult="";var result=inputString.trim();for(var i=0;i<result.length;i++){if(result.charCodeAt(i)===32){if(isSpace===false)isSpace=true}else{if(isSpace){cuttedResult+=" ";isSpace=false}cuttedResult+=result[i]}}return cuttedResult.toLowerCase()}function createECDSASignatureFromCMS(cmsSignature){if(cmsSignature instanceof asn1js.Sequence===false)return new ArrayBuffer(0);if(cmsSignature.valueBlock.value.length!==2)return new ArrayBuffer(0);if(cmsSignature.valueBlock.value[0]instanceof asn1js.Integer===false)return new ArrayBuffer(0);if(cmsSignature.valueBlock.value[1]instanceof asn1js.Integer===false)return new ArrayBuffer(0);var rValue=cmsSignature.valueBlock.value[0].convertFromDER();var sValue=cmsSignature.valueBlock.value[1].convertFromDER();switch(true){case rValue.valueBlock.valueHex.byteLength<sValue.valueBlock.valueHex.byteLength:{if(sValue.valueBlock.valueHex.byteLength-rValue.valueBlock.valueHex.byteLength!==1)throw new Error("Incorrect DER integer decoding");var correctedLength=sValue.valueBlock.valueHex.byteLength;var rValueView=new Uint8Array(rValue.valueBlock.valueHex);var rValueBufferCorrected=new ArrayBuffer(correctedLength);var rValueViewCorrected=new Uint8Array(rValueBufferCorrected);rValueViewCorrected.set(rValueView,1);rValueViewCorrected[0]=0;return(0,_pvutils.utilConcatBuf)(rValueBufferCorrected,sValue.valueBlock.valueHex)}case rValue.valueBlock.valueHex.byteLength>sValue.valueBlock.valueHex.byteLength:{if(rValue.valueBlock.valueHex.byteLength-sValue.valueBlock.valueHex.byteLength!==1)throw new Error("Incorrect DER integer decoding");var _correctedLength=rValue.valueBlock.valueHex.byteLength;var sValueView=new Uint8Array(sValue.valueBlock.valueHex);var sValueBufferCorrected=new ArrayBuffer(_correctedLength);var sValueViewCorrected=new Uint8Array(sValueBufferCorrected);sValueViewCorrected.set(sValueView,1);sValueViewCorrected[0]=0;return(0,_pvutils.utilConcatBuf)(rValue.valueBlock.valueHex,sValueBufferCorrected)}default:{if(rValue.valueBlock.valueHex.byteLength%2){var _correctedLength2=rValue.valueBlock.valueHex.byteLength+1;var _rValueView=new Uint8Array(rValue.valueBlock.valueHex);var _rValueBufferCorrected=new ArrayBuffer(_correctedLength2);var _rValueViewCorrected=new Uint8Array(_rValueBufferCorrected);_rValueViewCorrected.set(_rValueView,1);_rValueViewCorrected[0]=0;var _sValueView=new Uint8Array(sValue.valueBlock.valueHex);var _sValueBufferCorrected=new ArrayBuffer(_correctedLength2);var _sValueViewCorrected=new Uint8Array(_sValueBufferCorrected);_sValueViewCorrected.set(_sValueView,1);_sValueViewCorrected[0]=0;return(0,_pvutils.utilConcatBuf)(_rValueBufferCorrected,_sValueBufferCorrected)}}}return(0,_pvutils.utilConcatBuf)(rValue.valueBlock.valueHex,sValue.valueBlock.valueHex)}function getAlgorithmByOID(oid){return engine.subtle.getAlgorithmByOID(oid)}function getHashAlgorithm(signatureAlgorithm){return engine.subtle.getHashAlgorithm(signatureAlgorithm)}function kdfWithCounter(hashFunction,Zbuffer,Counter,SharedInfo){switch(hashFunction.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;default:return Promise.reject("Unknown hash function: "+hashFunction)}if(Zbuffer instanceof ArrayBuffer===false)return Promise.reject('Please set "Zbuffer" as "ArrayBuffer"');if(Zbuffer.byteLength===0)return Promise.reject('"Zbuffer" has zero length, error');if(SharedInfo instanceof ArrayBuffer===false)return Promise.reject('Please set "SharedInfo" as "ArrayBuffer"');if(Counter>255)return Promise.reject('Please set "Counter" variable to value less or equal to 255');var counterBuffer=new ArrayBuffer(4);var counterView=new Uint8Array(counterBuffer);counterView[0]=0;counterView[1]=0;counterView[2]=0;counterView[3]=Counter;var combinedBuffer=new ArrayBuffer(0);var crypto=getCrypto();if(typeof crypto==="undefined")return Promise.reject("Unable to create WebCrypto object");combinedBuffer=(0,_pvutils.utilConcatBuf)(combinedBuffer,Zbuffer);combinedBuffer=(0,_pvutils.utilConcatBuf)(combinedBuffer,counterBuffer);combinedBuffer=(0,_pvutils.utilConcatBuf)(combinedBuffer,SharedInfo);return crypto.digest({name:hashFunction},combinedBuffer).then(function(result){return{counter:Counter,result:result}})}function kdf(hashFunction,Zbuffer,keydatalen,SharedInfo){var hashLength=0;var maxCounter=1;var kdfArray=[];switch(hashFunction.toUpperCase()){case"SHA-1":hashLength=160;break;case"SHA-256":hashLength=256;break;case"SHA-384":hashLength=384;break;case"SHA-512":hashLength=512;break;default:return Promise.reject("Unknown hash function: "+hashFunction)}if(Zbuffer instanceof ArrayBuffer===false)return Promise.reject('Please set "Zbuffer" as "ArrayBuffer"');if(Zbuffer.byteLength===0)return Promise.reject('"Zbuffer" has zero length, error');if(SharedInfo instanceof ArrayBuffer===false)return Promise.reject('Please set "SharedInfo" as "ArrayBuffer"');var quotient=keydatalen/hashLength;if(Math.floor(quotient)>0){maxCounter=Math.floor(quotient);if(quotient-maxCounter>0)maxCounter++}for(var i=1;i<=maxCounter;i++){kdfArray.push(kdfWithCounter(hashFunction,Zbuffer,i,SharedInfo))}return Promise.all(kdfArray).then(function(incomingResult){var combinedBuffer=new ArrayBuffer(0);var currentCounter=1;var found=true;while(found){found=false;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=incomingResult[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var result=_step.value;if(result.counter===currentCounter){combinedBuffer=(0,_pvutils.utilConcatBuf)(combinedBuffer,result.result);found=true;break}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}currentCounter++}keydatalen>>=3;if(combinedBuffer.byteLength>keydatalen){var newBuffer=new ArrayBuffer(keydatalen);var newView=new Uint8Array(newBuffer);var combinedView=new Uint8Array(combinedBuffer);for(var _i=0;_i<keydatalen;_i++){newView[_i]=combinedView[_i]}return newBuffer}return combinedBuffer})}},{"./CryptoEngine.js":24,asn1js:"asn1js",pvutils:"pvutils"}],106:[function(require,module,exports){var g=function(){return this}()||Function("return this")();var hadRuntime=g.regeneratorRuntime&&Object.getOwnPropertyNames(g).indexOf("regeneratorRuntime")>=0;var oldRuntime=hadRuntime&&g.regeneratorRuntime;g.regeneratorRuntime=undefined;module.exports=require("./runtime");if(hadRuntime){g.regeneratorRuntime=oldRuntime}else{try{delete g.regeneratorRuntime}catch(e){g.regeneratorRuntime=undefined}}},{"./runtime":107}],107:[function(require,module,exports){!function(global){"use strict";var Op=Object.prototype;var hasOwn=Op.hasOwnProperty;var undefined;var $Symbol=typeof Symbol==="function"?Symbol:{};var iteratorSymbol=$Symbol.iterator||"@@iterator";var asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator";var toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";var inModule=typeof module==="object";var runtime=global.regeneratorRuntime;if(runtime){if(inModule){module.exports=runtime}return}runtime=global.regeneratorRuntime=inModule?module.exports:{};function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator;var generator=Object.create(protoGenerator.prototype);var context=new Context(tryLocsList||[]);generator._invoke=makeInvokeMethod(innerFn,self,context);return generator}runtime.wrap=wrap;function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}var GenStateSuspendedStart="suspendedStart";var GenStateSuspendedYield="suspendedYield";var GenStateExecuting="executing";var GenStateCompleted="completed";var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};IteratorPrototype[iteratorSymbol]=function(){return this};var getProto=Object.getPrototypeOf;var NativeIteratorPrototype=getProto&&getProto(getProto(values([])));if(NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)){IteratorPrototype=NativeIteratorPrototype}var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);GeneratorFunction.prototype=Gp.constructor=GeneratorFunctionPrototype;GeneratorFunctionPrototype.constructor=GeneratorFunction;GeneratorFunctionPrototype[toStringTagSymbol]=GeneratorFunction.displayName="GeneratorFunction";function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){prototype[method]=function(arg){return this._invoke(method,arg)}})}runtime.isGeneratorFunction=function(genFun){var ctor=typeof genFun==="function"&&genFun.constructor;return ctor?ctor===GeneratorFunction||(ctor.displayName||ctor.name)==="GeneratorFunction":false};runtime.mark=function(genFun){if(Object.setPrototypeOf){Object.setPrototypeOf(genFun,GeneratorFunctionPrototype)}else{genFun.__proto__=GeneratorFunctionPrototype;if(!(toStringTagSymbol in genFun)){genFun[toStringTagSymbol]="GeneratorFunction"}}genFun.prototype=Object.create(Gp);return genFun};runtime.awrap=function(arg){return{__await:arg}};function AsyncIterator(generator){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if(record.type==="throw"){reject(record.arg)}else{var result=record.arg;var value=result.value;if(value&&typeof value==="object"&&hasOwn.call(value,"__await")){return Promise.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject)},function(err){invoke("throw",err,resolve,reject)})}return Promise.resolve(value).then(function(unwrapped){result.value=unwrapped;resolve(result)},reject)}}var previousPromise;function enqueue(method,arg){function callInvokeWithMethodAndArg(){return new Promise(function(resolve,reject){invoke(method,arg,resolve,reject)})}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}this._invoke=enqueue}defineIteratorMethods(AsyncIterator.prototype);AsyncIterator.prototype[asyncIteratorSymbol]=function(){return this};runtime.AsyncIterator=AsyncIterator;runtime.async=function(innerFn,outerFn,self,tryLocsList){var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList));return runtime.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next()})};function makeInvokeMethod(innerFn,self,context){var state=GenStateSuspendedStart;return function invoke(method,arg){if(state===GenStateExecuting){throw new Error("Generator is already running")}if(state===GenStateCompleted){if(method==="throw"){throw arg}return doneResult()}context.method=method;context.arg=arg;while(true){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if(context.method==="next"){context.sent=context._sent=context.arg}else if(context.method==="throw"){if(state===GenStateSuspendedStart){state=GenStateCompleted;throw context.arg}context.dispatchException(context.arg)}else if(context.method==="return"){context.abrupt("return",context.arg)}state=GenStateExecuting;var record=tryCatch(innerFn,self,context);if(record.type==="normal"){state=context.done?GenStateCompleted:GenStateSuspendedYield;if(record.arg===ContinueSentinel){continue}return{value:record.arg,done:context.done}}else if(record.type==="throw"){state=GenStateCompleted;context.method="throw";context.arg=record.arg}}}}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(method===undefined){context.delegate=null;if(context.method==="throw"){if(delegate.iterator.return){context.method="return";context.arg=undefined;maybeInvokeDelegate(delegate,context);if(context.method==="throw"){return ContinueSentinel}}context.method="throw";context.arg=new TypeError("The iterator does not provide a 'throw' method")}return ContinueSentinel}var record=tryCatch(method,delegate.iterator,context.arg);if(record.type==="throw"){context.method="throw";context.arg=record.arg;context.delegate=null;return ContinueSentinel}var info=record.arg;if(!info){context.method="throw";context.arg=new TypeError("iterator result is not an object");context.delegate=null;return ContinueSentinel}if(info.done){context[delegate.resultName]=info.value;context.next=delegate.nextLoc;if(context.method!=="return"){context.method="next";context.arg=undefined}}else{return info}context.delegate=null;return ContinueSentinel}defineIteratorMethods(Gp);Gp[toStringTagSymbol]="Generator";Gp[iteratorSymbol]=function(){return this};Gp.toString=function(){return"[object Generator]"};function pushTryEntry(locs){var entry={tryLoc:locs[0]};if(1 in locs){entry.catchLoc=locs[1]}if(2 in locs){entry.finallyLoc=locs[2];entry.afterLoc=locs[3]}this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal";delete record.arg;entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}];tryLocsList.forEach(pushTryEntry,this);this.reset(true)}runtime.keys=function(object){var keys=[];for(var key in object){keys.push(key)}keys.reverse();return function next(){while(keys.length){var key=keys.pop();if(key in object){next.value=key;next.done=false;return next}}next.done=true;return next}};function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod){return iteratorMethod.call(iterable)}if(typeof iterable.next==="function"){return iterable}if(!isNaN(iterable.length)){var i=-1,next=function next(){while(++i<iterable.length){if(hasOwn.call(iterable,i)){next.value=iterable[i];next.done=false;return next}}next.value=undefined;next.done=true;return next};return next.next=next}}return{next:doneResult}}runtime.values=values;function doneResult(){return{value:undefined,done:true}}Context.prototype={constructor:Context,reset:function(skipTempReset){this.prev=0;this.next=0;this.sent=this._sent=undefined;this.done=false;this.delegate=null;this.method="next";this.arg=undefined;this.tryEntries.forEach(resetTryEntry);if(!skipTempReset){for(var name in this){if(name.charAt(0)==="t"&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))){this[name]=undefined}}}},stop:function(){this.done=true;var rootEntry=this.tryEntries[0];var rootRecord=rootEntry.completion;if(rootRecord.type==="throw"){throw rootRecord.arg}return this.rval},dispatchException:function(exception){if(this.done){throw exception}var context=this;function handle(loc,caught){record.type="throw";record.arg=exception;context.next=loc;if(caught){context.method="next";context.arg=undefined}return!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];var record=entry.completion;if(entry.tryLoc==="root"){return handle("end")}if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc");var hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}else if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else if(hasCatch){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}}else if(hasFinally){if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}if(finallyEntry&&(type==="break"||type==="continue")&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc){finallyEntry=null}var record=finallyEntry?finallyEntry.completion:{};record.type=type;record.arg=arg;if(finallyEntry){this.method="next";this.next=finallyEntry.finallyLoc;return ContinueSentinel}return this.complete(record)},complete:function(record,afterLoc){if(record.type==="throw"){throw record.arg}if(record.type==="break"||record.type==="continue"){this.next=record.arg}else if(record.type==="return"){this.rval=this.arg=record.arg;this.method="return";this.next="end"}else if(record.type==="normal"&&afterLoc){this.next=afterLoc}return ContinueSentinel},finish:function(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc){this.complete(entry.completion,entry.afterLoc);resetTryEntry(entry);return ContinueSentinel}}},catch:function(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if(record.type==="throw"){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function(iterable,resultName,nextLoc){this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc};if(this.method==="next"){this.arg=undefined}return ContinueSentinel}}}(function(){return this}()||Function("return this")())},{}],pkijs:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeStampResp=exports.TimeStampReq=exports.Time=exports.TSTInfo=exports.TBSRequest=exports.SubjectDirectoryAttributes=exports.SingleResponse=exports.SignerInfo=exports.SignedData=exports.SignedAndUnsignedAttributes=exports.Signature=exports.SecretBag=exports.SafeContents=exports.SafeBag=exports.RevokedCertificate=undefined;exports.RevocationInfoChoices=exports.ResponseData=exports.ResponseBytes=exports.Request=exports.RelativeDistinguishedNames=exports.RecipientKeyIdentifier=exports.RecipientInfo=exports.RecipientIdentifier=exports.RecipientEncryptedKeys=exports.RecipientEncryptedKey=exports.RSASSAPSSParams=exports.RSAPublicKey=exports.RSAPrivateKey=exports.RSAESOAEPParams=exports.PublicKeyInfo=exports.PrivateKeyUsagePeriod=exports.PrivateKeyInfo=exports.PolicyQualifierInfo=exports.PolicyMappings=exports.PolicyMapping=exports.PolicyInformation=exports.PolicyConstraints=exports.PasswordRecipientinfo=exports.PKIStatusInfo=exports.PKCS8ShroudedKeyBag=exports.PFX=exports.PBKDF2Params=exports.PBES2Params=exports.OtherRevocationInfoFormat=exports.OtherRecipientInfo=exports.OtherPrimeInfo=exports.OtherKeyAttribute=exports.OtherCertificateFormat=exports.OriginatorPublicKey=exports.OriginatorInfo=exports.OriginatorIdentifierOrKey=exports.OCSPResponse=exports.OCSPRequest=exports.NameConstraints=exports.MessageImprint=exports.MacData=exports.KeyTransRecipientInfo=exports.KeyBag=exports.KeyAgreeRecipientInfo=exports.KeyAgreeRecipientIdentifier=exports.KEKRecipientInfo=exports.KEKIdentifier=exports.IssuingDistributionPoint=exports.IssuerAndSerialNumber=exports.InfoAccess=exports.GeneralSubtree=exports.GeneralNames=exports.GeneralName=exports.Extensions=exports.Extension=exports.ExtKeyUsage=exports.EnvelopedData=exports.EncryptedData=exports.EncryptedContentInfo=exports.EncapsulatedContentInfo=exports.ECPublicKey=exports.ECPrivateKey=exports.ECCCMSSharedInfo=exports.DistributionPoint=exports.DigestInfo=exports.CryptoEngine=exports.ContentInfo=exports.CertificationRequest=exports.CertificateSet=exports.CertificateRevocationList=exports.CertificatePolicies=exports.CertificateChainValidationEngine=exports.Certificate=exports.CertID=exports.CertBag=exports.CRLDistributionPoints=exports.CRLBag=exports.BasicOCSPResponse=exports.BasicConstraints=exports.AuthorityKeyIdentifier=exports.AuthenticatedSafe=exports.AttributeTypeAndValue=exports.Attribute=exports.AltName=exports.AlgorithmIdentifier=exports.Accuracy=exports.AccessDescription=exports.kdf=exports.kdfWithCounter=exports.getHashAlgorithm=exports.getAlgorithmByOID=exports.createECDSASignatureFromCMS=exports.stringPrep=exports.createCMSECDSASignature=exports.getAlgorithmParameters=exports.getOIDByAlgorithm=exports.getRandomValues=exports.getCrypto=exports.getEngine=exports.setEngine=undefined;var _common=require("./common.js");var _AccessDescription=require("./AccessDescription.js");var _AccessDescription2=_interopRequireDefault(_AccessDescription);var _Accuracy=require("./Accuracy.js");var _Accuracy2=_interopRequireDefault(_Accuracy);var _AlgorithmIdentifier=require("./AlgorithmIdentifier.js");var _AlgorithmIdentifier2=_interopRequireDefault(_AlgorithmIdentifier);var _AltName=require("./AltName.js");var _AltName2=_interopRequireDefault(_AltName);var _Attribute=require("./Attribute.js");var _Attribute2=_interopRequireDefault(_Attribute);var _AttributeTypeAndValue=require("./AttributeTypeAndValue.js");var _AttributeTypeAndValue2=_interopRequireDefault(_AttributeTypeAndValue);var _AuthenticatedSafe=require("./AuthenticatedSafe.js");var _AuthenticatedSafe2=_interopRequireDefault(_AuthenticatedSafe);var _AuthorityKeyIdentifier=require("./AuthorityKeyIdentifier.js");var _AuthorityKeyIdentifier2=_interopRequireDefault(_AuthorityKeyIdentifier);var _BasicConstraints=require("./BasicConstraints.js");var _BasicConstraints2=_interopRequireDefault(_BasicConstraints);var _BasicOCSPResponse=require("./BasicOCSPResponse.js");var _BasicOCSPResponse2=_interopRequireDefault(_BasicOCSPResponse);var _CRLBag=require("./CRLBag.js");var _CRLBag2=_interopRequireDefault(_CRLBag);var _CRLDistributionPoints=require("./CRLDistributionPoints.js");var _CRLDistributionPoints2=_interopRequireDefault(_CRLDistributionPoints);var _CertBag=require("./CertBag.js");var _CertBag2=_interopRequireDefault(_CertBag);var _CertID=require("./CertID.js");var _CertID2=_interopRequireDefault(_CertID);var _Certificate=require("./Certificate.js");var _Certificate2=_interopRequireDefault(_Certificate);var _CertificateChainValidationEngine=require("./CertificateChainValidationEngine.js");var _CertificateChainValidationEngine2=_interopRequireDefault(_CertificateChainValidationEngine);var _CertificatePolicies=require("./CertificatePolicies.js");var _CertificatePolicies2=_interopRequireDefault(_CertificatePolicies);var _CertificateRevocationList=require("./CertificateRevocationList.js");var _CertificateRevocationList2=_interopRequireDefault(_CertificateRevocationList);var _CertificateSet=require("./CertificateSet.js");var _CertificateSet2=_interopRequireDefault(_CertificateSet);var _CertificationRequest=require("./CertificationRequest.js");var _CertificationRequest2=_interopRequireDefault(_CertificationRequest);var _ContentInfo=require("./ContentInfo.js");var _ContentInfo2=_interopRequireDefault(_ContentInfo);var _CryptoEngine=require("./CryptoEngine.js");var _CryptoEngine2=_interopRequireDefault(_CryptoEngine);var _DigestInfo=require("./DigestInfo.js");var _DigestInfo2=_interopRequireDefault(_DigestInfo);var _DistributionPoint=require("./DistributionPoint.js");var _DistributionPoint2=_interopRequireDefault(_DistributionPoint);var _ECCCMSSharedInfo=require("./ECCCMSSharedInfo.js");var _ECCCMSSharedInfo2=_interopRequireDefault(_ECCCMSSharedInfo);var _ECPrivateKey=require("./ECPrivateKey.js");var _ECPrivateKey2=_interopRequireDefault(_ECPrivateKey);var _ECPublicKey=require("./ECPublicKey.js");var _ECPublicKey2=_interopRequireDefault(_ECPublicKey);var _EncapsulatedContentInfo=require("./EncapsulatedContentInfo.js");var _EncapsulatedContentInfo2=_interopRequireDefault(_EncapsulatedContentInfo);var _EncryptedContentInfo=require("./EncryptedContentInfo.js");var _EncryptedContentInfo2=_interopRequireDefault(_EncryptedContentInfo);var _EncryptedData=require("./EncryptedData.js");var _EncryptedData2=_interopRequireDefault(_EncryptedData);var _EnvelopedData=require("./EnvelopedData.js");var _EnvelopedData2=_interopRequireDefault(_EnvelopedData);var _ExtKeyUsage=require("./ExtKeyUsage.js");var _ExtKeyUsage2=_interopRequireDefault(_ExtKeyUsage);var _Extension=require("./Extension.js");var _Extension2=_interopRequireDefault(_Extension);var _Extensions=require("./Extensions.js");var _Extensions2=_interopRequireDefault(_Extensions);var _GeneralName=require("./GeneralName.js");var _GeneralName2=_interopRequireDefault(_GeneralName);var _GeneralNames=require("./GeneralNames.js");var _GeneralNames2=_interopRequireDefault(_GeneralNames);var _GeneralSubtree=require("./GeneralSubtree.js");var _GeneralSubtree2=_interopRequireDefault(_GeneralSubtree);var _InfoAccess=require("./InfoAccess.js");var _InfoAccess2=_interopRequireDefault(_InfoAccess);var _IssuerAndSerialNumber=require("./IssuerAndSerialNumber.js");var _IssuerAndSerialNumber2=_interopRequireDefault(_IssuerAndSerialNumber);var _IssuingDistributionPoint=require("./IssuingDistributionPoint.js");var _IssuingDistributionPoint2=_interopRequireDefault(_IssuingDistributionPoint);var _KEKIdentifier=require("./KEKIdentifier.js");var _KEKIdentifier2=_interopRequireDefault(_KEKIdentifier);var _KEKRecipientInfo=require("./KEKRecipientInfo.js");var _KEKRecipientInfo2=_interopRequireDefault(_KEKRecipientInfo);var _KeyAgreeRecipientIdentifier=require("./KeyAgreeRecipientIdentifier.js");var _KeyAgreeRecipientIdentifier2=_interopRequireDefault(_KeyAgreeRecipientIdentifier);var _KeyAgreeRecipientInfo=require("./KeyAgreeRecipientInfo.js");var _KeyAgreeRecipientInfo2=_interopRequireDefault(_KeyAgreeRecipientInfo);var _KeyBag=require("./KeyBag.js");var _KeyBag2=_interopRequireDefault(_KeyBag);var _KeyTransRecipientInfo=require("./KeyTransRecipientInfo.js");var _KeyTransRecipientInfo2=_interopRequireDefault(_KeyTransRecipientInfo);var _MacData=require("./MacData.js");var _MacData2=_interopRequireDefault(_MacData);var _MessageImprint=require("./MessageImprint.js");var _MessageImprint2=_interopRequireDefault(_MessageImprint);var _NameConstraints=require("./NameConstraints.js");var _NameConstraints2=_interopRequireDefault(_NameConstraints);var _OCSPRequest=require("./OCSPRequest.js");var _OCSPRequest2=_interopRequireDefault(_OCSPRequest);var _OCSPResponse=require("./OCSPResponse.js");var _OCSPResponse2=_interopRequireDefault(_OCSPResponse);var _OriginatorIdentifierOrKey=require("./OriginatorIdentifierOrKey.js");var _OriginatorIdentifierOrKey2=_interopRequireDefault(_OriginatorIdentifierOrKey);var _OriginatorInfo=require("./OriginatorInfo.js");var _OriginatorInfo2=_interopRequireDefault(_OriginatorInfo);var _OriginatorPublicKey=require("./OriginatorPublicKey.js");var _OriginatorPublicKey2=_interopRequireDefault(_OriginatorPublicKey);var _OtherCertificateFormat=require("./OtherCertificateFormat.js");var _OtherCertificateFormat2=_interopRequireDefault(_OtherCertificateFormat);var _OtherKeyAttribute=require("./OtherKeyAttribute.js");var _OtherKeyAttribute2=_interopRequireDefault(_OtherKeyAttribute);var _OtherPrimeInfo=require("./OtherPrimeInfo.js");var _OtherPrimeInfo2=_interopRequireDefault(_OtherPrimeInfo);var _OtherRecipientInfo=require("./OtherRecipientInfo.js");var _OtherRecipientInfo2=_interopRequireDefault(_OtherRecipientInfo);var _OtherRevocationInfoFormat=require("./OtherRevocationInfoFormat.js");var _OtherRevocationInfoFormat2=_interopRequireDefault(_OtherRevocationInfoFormat);var _PBES2Params=require("./PBES2Params.js");var _PBES2Params2=_interopRequireDefault(_PBES2Params);var _PBKDF2Params=require("./PBKDF2Params.js");var _PBKDF2Params2=_interopRequireDefault(_PBKDF2Params);var _PFX=require("./PFX.js");var _PFX2=_interopRequireDefault(_PFX);var _PKCS8ShroudedKeyBag=require("./PKCS8ShroudedKeyBag.js");var _PKCS8ShroudedKeyBag2=_interopRequireDefault(_PKCS8ShroudedKeyBag);var _PKIStatusInfo=require("./PKIStatusInfo.js");var _PKIStatusInfo2=_interopRequireDefault(_PKIStatusInfo);var _PasswordRecipientinfo=require("./PasswordRecipientinfo.js");var _PasswordRecipientinfo2=_interopRequireDefault(_PasswordRecipientinfo);var _PolicyConstraints=require("./PolicyConstraints.js");var _PolicyConstraints2=_interopRequireDefault(_PolicyConstraints);var _PolicyInformation=require("./PolicyInformation.js");var _PolicyInformation2=_interopRequireDefault(_PolicyInformation);var _PolicyMapping=require("./PolicyMapping.js");var _PolicyMapping2=_interopRequireDefault(_PolicyMapping);var _PolicyMappings=require("./PolicyMappings.js");var _PolicyMappings2=_interopRequireDefault(_PolicyMappings);var _PolicyQualifierInfo=require("./PolicyQualifierInfo.js");var _PolicyQualifierInfo2=_interopRequireDefault(_PolicyQualifierInfo);var _PrivateKeyInfo=require("./PrivateKeyInfo.js");var _PrivateKeyInfo2=_interopRequireDefault(_PrivateKeyInfo);var _PrivateKeyUsagePeriod=require("./PrivateKeyUsagePeriod.js");var _PrivateKeyUsagePeriod2=_interopRequireDefault(_PrivateKeyUsagePeriod);var _PublicKeyInfo=require("./PublicKeyInfo.js");var _PublicKeyInfo2=_interopRequireDefault(_PublicKeyInfo);var _RSAESOAEPParams=require("./RSAESOAEPParams.js");var _RSAESOAEPParams2=_interopRequireDefault(_RSAESOAEPParams);var _RSAPrivateKey=require("./RSAPrivateKey.js");var _RSAPrivateKey2=_interopRequireDefault(_RSAPrivateKey);var _RSAPublicKey=require("./RSAPublicKey.js");var _RSAPublicKey2=_interopRequireDefault(_RSAPublicKey);var _RSASSAPSSParams=require("./RSASSAPSSParams.js");var _RSASSAPSSParams2=_interopRequireDefault(_RSASSAPSSParams);var _RecipientEncryptedKey=require("./RecipientEncryptedKey.js");var _RecipientEncryptedKey2=_interopRequireDefault(_RecipientEncryptedKey);var _RecipientEncryptedKeys=require("./RecipientEncryptedKeys.js");var _RecipientEncryptedKeys2=_interopRequireDefault(_RecipientEncryptedKeys);var _RecipientIdentifier=require("./RecipientIdentifier.js");var _RecipientIdentifier2=_interopRequireDefault(_RecipientIdentifier);var _RecipientInfo=require("./RecipientInfo.js");var _RecipientInfo2=_interopRequireDefault(_RecipientInfo);var _RecipientKeyIdentifier=require("./RecipientKeyIdentifier.js");var _RecipientKeyIdentifier2=_interopRequireDefault(_RecipientKeyIdentifier);var _RelativeDistinguishedNames=require("./RelativeDistinguishedNames.js");var _RelativeDistinguishedNames2=_interopRequireDefault(_RelativeDistinguishedNames);var _Request=require("./Request.js");var _Request2=_interopRequireDefault(_Request);var _ResponseBytes=require("./ResponseBytes.js");var _ResponseBytes2=_interopRequireDefault(_ResponseBytes);var _ResponseData=require("./ResponseData.js");var _ResponseData2=_interopRequireDefault(_ResponseData);var _RevocationInfoChoices=require("./RevocationInfoChoices.js");var _RevocationInfoChoices2=_interopRequireDefault(_RevocationInfoChoices);var _RevokedCertificate=require("./RevokedCertificate.js");var _RevokedCertificate2=_interopRequireDefault(_RevokedCertificate);var _SafeBag=require("./SafeBag.js");var _SafeBag2=_interopRequireDefault(_SafeBag);var _SafeContents=require("./SafeContents.js");var _SafeContents2=_interopRequireDefault(_SafeContents);var _SecretBag=require("./SecretBag.js");var _SecretBag2=_interopRequireDefault(_SecretBag);var _Signature=require("./Signature.js");var _Signature2=_interopRequireDefault(_Signature);var _SignedAndUnsignedAttributes=require("./SignedAndUnsignedAttributes.js");var _SignedAndUnsignedAttributes2=_interopRequireDefault(_SignedAndUnsignedAttributes);var _SignedData=require("./SignedData.js");var _SignedData2=_interopRequireDefault(_SignedData);var _SignerInfo=require("./SignerInfo.js");var _SignerInfo2=_interopRequireDefault(_SignerInfo);var _SingleResponse=require("./SingleResponse.js");var _SingleResponse2=_interopRequireDefault(_SingleResponse);var _SubjectDirectoryAttributes=require("./SubjectDirectoryAttributes.js");var _SubjectDirectoryAttributes2=_interopRequireDefault(_SubjectDirectoryAttributes);var _TBSRequest=require("./TBSRequest.js");var _TBSRequest2=_interopRequireDefault(_TBSRequest);var _TSTInfo=require("./TSTInfo.js");var _TSTInfo2=_interopRequireDefault(_TSTInfo);var _Time=require("./Time.js");var _Time2=_interopRequireDefault(_Time);var _TimeStampReq=require("./TimeStampReq.js");var _TimeStampReq2=_interopRequireDefault(_TimeStampReq);var _TimeStampResp=require("./TimeStampResp.js");var _TimeStampResp2=_interopRequireDefault(_TimeStampResp);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.setEngine=_common.setEngine;exports.getEngine=_common.getEngine;exports.getCrypto=_common.getCrypto;exports.getRandomValues=_common.getRandomValues;exports.getOIDByAlgorithm=_common.getOIDByAlgorithm;exports.getAlgorithmParameters=_common.getAlgorithmParameters;exports.createCMSECDSASignature=_common.createCMSECDSASignature;exports.stringPrep=_common.stringPrep;exports.createECDSASignatureFromCMS=_common.createECDSASignatureFromCMS;exports.getAlgorithmByOID=_common.getAlgorithmByOID;exports.getHashAlgorithm=_common.getHashAlgorithm;exports.kdfWithCounter=_common.kdfWithCounter;exports.kdf=_common.kdf;exports.AccessDescription=_AccessDescription2.default;exports.Accuracy=_Accuracy2.default;exports.AlgorithmIdentifier=_AlgorithmIdentifier2.default;exports.AltName=_AltName2.default;exports.Attribute=_Attribute2.default;exports.AttributeTypeAndValue=_AttributeTypeAndValue2.default;exports.AuthenticatedSafe=_AuthenticatedSafe2.default;exports.AuthorityKeyIdentifier=_AuthorityKeyIdentifier2.default;exports.BasicConstraints=_BasicConstraints2.default;exports.BasicOCSPResponse=_BasicOCSPResponse2.default;exports.CRLBag=_CRLBag2.default;exports.CRLDistributionPoints=_CRLDistributionPoints2.default;exports.CertBag=_CertBag2.default;exports.CertID=_CertID2.default;exports.Certificate=_Certificate2.default;exports.CertificateChainValidationEngine=_CertificateChainValidationEngine2.default;exports.CertificatePolicies=_CertificatePolicies2.default;exports.CertificateRevocationList=_CertificateRevocationList2.default;exports.CertificateSet=_CertificateSet2.default;exports.CertificationRequest=_CertificationRequest2.default;exports.ContentInfo=_ContentInfo2.default;exports.CryptoEngine=_CryptoEngine2.default;exports.DigestInfo=_DigestInfo2.default;exports.DistributionPoint=_DistributionPoint2.default;exports.ECCCMSSharedInfo=_ECCCMSSharedInfo2.default;exports.ECPrivateKey=_ECPrivateKey2.default;exports.ECPublicKey=_ECPublicKey2.default;exports.EncapsulatedContentInfo=_EncapsulatedContentInfo2.default;exports.EncryptedContentInfo=_EncryptedContentInfo2.default;exports.EncryptedData=_EncryptedData2.default;exports.EnvelopedData=_EnvelopedData2.default;exports.ExtKeyUsage=_ExtKeyUsage2.default;exports.Extension=_Extension2.default;exports.Extensions=_Extensions2.default;exports.GeneralName=_GeneralName2.default;exports.GeneralNames=_GeneralNames2.default;exports.GeneralSubtree=_GeneralSubtree2.default;exports.InfoAccess=_InfoAccess2.default;exports.IssuerAndSerialNumber=_IssuerAndSerialNumber2.default;exports.IssuingDistributionPoint=_IssuingDistributionPoint2.default;exports.KEKIdentifier=_KEKIdentifier2.default;exports.KEKRecipientInfo=_KEKRecipientInfo2.default;exports.KeyAgreeRecipientIdentifier=_KeyAgreeRecipientIdentifier2.default;exports.KeyAgreeRecipientInfo=_KeyAgreeRecipientInfo2.default;exports.KeyBag=_KeyBag2.default;exports.KeyTransRecipientInfo=_KeyTransRecipientInfo2.default;exports.MacData=_MacData2.default;exports.MessageImprint=_MessageImprint2.default;exports.NameConstraints=_NameConstraints2.default;exports.OCSPRequest=_OCSPRequest2.default;exports.OCSPResponse=_OCSPResponse2.default;exports.OriginatorIdentifierOrKey=_OriginatorIdentifierOrKey2.default;exports.OriginatorInfo=_OriginatorInfo2.default;exports.OriginatorPublicKey=_OriginatorPublicKey2.default;exports.OtherCertificateFormat=_OtherCertificateFormat2.default;exports.OtherKeyAttribute=_OtherKeyAttribute2.default;exports.OtherPrimeInfo=_OtherPrimeInfo2.default;exports.OtherRecipientInfo=_OtherRecipientInfo2.default;exports.OtherRevocationInfoFormat=_OtherRevocationInfoFormat2.default;exports.PBES2Params=_PBES2Params2.default;exports.PBKDF2Params=_PBKDF2Params2.default;exports.PFX=_PFX2.default;exports.PKCS8ShroudedKeyBag=_PKCS8ShroudedKeyBag2.default;exports.PKIStatusInfo=_PKIStatusInfo2.default;exports.PasswordRecipientinfo=_PasswordRecipientinfo2.default;exports.PolicyConstraints=_PolicyConstraints2.default;exports.PolicyInformation=_PolicyInformation2.default;exports.PolicyMapping=_PolicyMapping2.default;exports.PolicyMappings=_PolicyMappings2.default;exports.PolicyQualifierInfo=_PolicyQualifierInfo2.default;exports.PrivateKeyInfo=_PrivateKeyInfo2.default;exports.PrivateKeyUsagePeriod=_PrivateKeyUsagePeriod2.default;exports.PublicKeyInfo=_PublicKeyInfo2.default;exports.RSAESOAEPParams=_RSAESOAEPParams2.default;exports.RSAPrivateKey=_RSAPrivateKey2.default;exports.RSAPublicKey=_RSAPublicKey2.default;exports.RSASSAPSSParams=_RSASSAPSSParams2.default;exports.RecipientEncryptedKey=_RecipientEncryptedKey2.default;exports.RecipientEncryptedKeys=_RecipientEncryptedKeys2.default;exports.RecipientIdentifier=_RecipientIdentifier2.default;exports.RecipientInfo=_RecipientInfo2.default;exports.RecipientKeyIdentifier=_RecipientKeyIdentifier2.default;exports.RelativeDistinguishedNames=_RelativeDistinguishedNames2.default;exports.Request=_Request2.default;exports.ResponseBytes=_ResponseBytes2.default;exports.ResponseData=_ResponseData2.default;exports.RevocationInfoChoices=_RevocationInfoChoices2.default;exports.RevokedCertificate=_RevokedCertificate2.default;exports.SafeBag=_SafeBag2.default;exports.SafeContents=_SafeContents2.default;exports.SecretBag=_SecretBag2.default;exports.Signature=_Signature2.default;exports.SignedAndUnsignedAttributes=_SignedAndUnsignedAttributes2.default;exports.SignedData=_SignedData2.default;exports.SignerInfo=_SignerInfo2.default;exports.SingleResponse=_SingleResponse2.default;exports.SubjectDirectoryAttributes=_SubjectDirectoryAttributes2.default;exports.TBSRequest=_TBSRequest2.default;exports.TSTInfo=_TSTInfo2.default;exports.Time=_Time2.default;exports.TimeStampReq=_TimeStampReq2.default;exports.TimeStampResp=_TimeStampResp2.default},{"./AccessDescription.js":1,"./Accuracy.js":2,"./AlgorithmIdentifier.js":3,"./AltName.js":4,"./Attribute.js":5,"./AttributeTypeAndValue.js":8,"./AuthenticatedSafe.js":9,"./AuthorityKeyIdentifier.js":10,"./BasicConstraints.js":11,"./BasicOCSPResponse.js":12,"./CRLBag.js":13,"./CRLDistributionPoints.js":14,"./CertBag.js":15,"./CertID.js":16,"./Certificate.js":17,"./CertificateChainValidationEngine.js":18,"./CertificatePolicies.js":19,"./CertificateRevocationList.js":20,"./CertificateSet.js":21,"./CertificationRequest.js":22,"./ContentInfo.js":23,"./CryptoEngine.js":24,"./DigestInfo.js":25,"./DistributionPoint.js":26,"./ECCCMSSharedInfo.js":27,"./ECPrivateKey.js":28,"./ECPublicKey.js":29,"./EncapsulatedContentInfo.js":30,"./EncryptedContentInfo.js":31,"./EncryptedData.js":32,"./EnvelopedData.js":33,"./ExtKeyUsage.js":34,"./Extension.js":35,"./Extensions.js":36,"./GeneralName.js":37,"./GeneralNames.js":38,"./GeneralSubtree.js":39,"./InfoAccess.js":40,"./IssuerAndSerialNumber.js":41,"./IssuingDistributionPoint.js":42,"./KEKIdentifier.js":43,"./KEKRecipientInfo.js":44,"./KeyAgreeRecipientIdentifier.js":45,"./KeyAgreeRecipientInfo.js":46,"./KeyBag.js":47,"./KeyTransRecipientInfo.js":48,"./MacData.js":49,"./MessageImprint.js":50,"./NameConstraints.js":51,"./OCSPRequest.js":52,"./OCSPResponse.js":53,"./OriginatorIdentifierOrKey.js":54,"./OriginatorInfo.js":55,"./OriginatorPublicKey.js":56,"./OtherCertificateFormat.js":57,"./OtherKeyAttribute.js":58,"./OtherPrimeInfo.js":59,"./OtherRecipientInfo.js":60,"./OtherRevocationInfoFormat.js":61,"./PBES2Params.js":62,"./PBKDF2Params.js":63,"./PFX.js":64,"./PKCS8ShroudedKeyBag.js":65,"./PKIStatusInfo.js":66,"./PasswordRecipientinfo.js":67,"./PolicyConstraints.js":68,"./PolicyInformation.js":69,"./PolicyMapping.js":70,"./PolicyMappings.js":71,"./PolicyQualifierInfo.js":72,"./PrivateKeyInfo.js":73,"./PrivateKeyUsagePeriod.js":74,"./PublicKeyInfo.js":75,"./RSAESOAEPParams.js":76,"./RSAPrivateKey.js":77,"./RSAPublicKey.js":78,"./RSASSAPSSParams.js":79,"./RecipientEncryptedKey.js":80,"./RecipientEncryptedKeys.js":81,"./RecipientIdentifier.js":82,"./RecipientInfo.js":83,"./RecipientKeyIdentifier.js":84,"./RelativeDistinguishedNames.js":85,"./Request.js":86,"./ResponseBytes.js":87,"./ResponseData.js":88,"./RevocationInfoChoices.js":89,"./RevokedCertificate.js":90,"./SafeBag.js":91,"./SafeContents.js":92,"./SecretBag.js":93,"./Signature.js":94,"./SignedAndUnsignedAttributes.js":95,"./SignedData.js":96,"./SignerInfo.js":97,"./SingleResponse.js":98,"./SubjectDirectoryAttributes.js":99,"./TBSRequest.js":100,"./TSTInfo.js":101,"./Time.js":102,"./TimeStampReq.js":103,"./TimeStampResp.js":104,"./common.js":105}]},{},[]);
